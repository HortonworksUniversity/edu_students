{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:** In this lab, we will work with the Dataset typed API which provides compile-time type safety.\n**File locations:**\n**Successful outcome:**\n**Before you begin:**\n**Related lessons:** Spark SQL, Dataframes and Datasets\n\n---","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887765_-477340700","id":"20171105-200834_1116095891","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:54:11-0800","dateFinished":"2020-01-17T02:54:11-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:207326"},{"text":"%md\n# Setup\n---","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887767_1964657493","id":"20181114-164229_902436001","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:54:12-0800","dateFinished":"2020-01-17T02:54:12-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207327"},{"title":"Read the data from S3 and store it in HDFS","text":"%sh\nrm -f DEV-343_labs.tgz\nwget -nv https://hwu-training-public-repo.s3-us-west-2.amazonaws.com/TOPS/ILT/NG-1.0/DEV/DEV-343/DEV-343_labs.tgz\ntar -xvf DEV-343_labs.tgz\nhdfs dfs -rm -r -f data\nhdfs dfs -put data/ .","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887768_647268878","id":"20181114-163151_254151007","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:54:12-0800","dateFinished":"2020-01-17T02:54:54-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207328"},{"text":"%md\n# Lab\n---","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887769_2104319904","id":"20181114-164844_1661453681","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:54:55-0800","dateFinished":"2020-01-17T02:54:55-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207329"},{"text":"%md\nWe've provided a small and simple JSON data file (spark-labs/data/music.json) containing data about music items. \nWe'll use it to do our Dataset work in this lab. It has four pieces of data in it:\n* title : Title of the item.\n* artist : Artist who released the item.\n* price : Price of the item\n* category : The music category (e.g. Pop)","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887770_1178506241","id":"20181115-084123_1911813743","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:54:55-0800","dateFinished":"2020-01-17T02:54:55-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207330"},{"title":"1 - Create a DataFrame by reading in the music data in data/music.json","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887772_1478830210","id":"20171105-200623_656362182","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207331"},{"title":"2 - View the schema of this DataFrame","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887773_828896606","id":"20171105-201709_849284875","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207332"},{"title":"3 - Explore the DataFrame","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887774_-1322995118","id":"20171105-201449_1118165660","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207333"},{"title":"4 - Define a MusicItem case class suitable for our music.json data","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887774_871042293","id":"20191127-141624_303297063","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207334"},{"title":"5 - Create a typed Dataset from the musicDF dataframe using this class","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887776_615833787","id":"20191127-142006_48110326","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207335"},{"text":"%md\n## Compare: DataFrame vs. Dataset\nWe'll perform some operations on our DataFrame and Dataset representations, to get a feel of the difference.","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887777_1597641223","id":"20191127-142255_1827160889","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:54:55-0800","dateFinished":"2020-01-17T02:54:55-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207336"},{"title":"6 - Using musicDF get all the items in the \"Pop\" category","text":"\n","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887777_1628043930","id":"20191127-142333_1584572432","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207337"},{"title":"7 - Using musicDS get all the items in the \"Pop\" category","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887778_-745490904","id":"20191127-142332_1048048158","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207338"},{"title":"8 - Using musicDF get the lowest priced item in each category","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887779_720206138","id":"20191127-145533_1200667039","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207339"},{"title":"9 - Using musicDF get the lowest priced item in each category","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887780_-337046904","id":"20191127-145610_78256454","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207340"},{"title":"10 - Using musicDF create a discountedPrice column equal to 0.9 * price","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887781_-1216541424","id":"20191127-150324_1127013446","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207341"},{"title":"11 - Using musicDS create a discountedPrice column equal to 0.9 * price","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887782_-1440346382","id":"20191127-150440_323293806","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207342"},{"text":"%md\nMake a mistake - watch how errors are caught.","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887782_1508489338","id":"20191127-152535_2073012023","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:54:55-0800","dateFinished":"2020-01-17T02:54:55-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207343"},{"title":"12 - Using musicDF try multiplying the price by a literal string","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887783_-585037130","id":"20191127-152639_818152579","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207344"},{"text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887784_1936762972","id":"20191128-124753_856043254","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207345"},{"title":"13 - Using musicDS try multiplying the price by a literal string","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887785_1857400363","id":"20191127-153618_1706535088","dateCreated":"2020-01-17T02:28:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207346"},{"text":"%md\n# Result\n**You have now:** practiced some fairly simple transformations with Datasets. We've also done the same thing with DataFrames to get a feel of the difference.\nDataFrames are a little easier to program to. However, as we saw, Datasets can catch errors earlier than DataFrames. This can be important when debugging and maintaining a large system.\n\n---","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887786_112309006","id":"20181119-142716_792318228","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:54:56-0800","dateFinished":"2020-01-17T02:54:56-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207347"},{"text":"%md\n# Solution\n---","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887787_-1773243653","id":"20171113-155535_1769142099","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:54:56-0800","dateFinished":"2020-01-17T02:54:56-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207348"},{"title":"1 - Create a DataFrame by reading in the music data in data/music.json","text":"val musicDF = spark.read.json(\"data/music.json\")","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887788_-1282424095","id":"20181115-084422_413255504","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:54:56-0800","dateFinished":"2020-01-17T02:55:06-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207349"},{"title":"2 - View the schema of this DataFrame","text":"musicDF.printSchema","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887789_1970408743","id":"20181115-092436_561920580","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:55:06-0800","dateFinished":"2020-01-17T02:55:06-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207350"},{"title":"3 - Explore the DataFrame","text":"z.show(musicDF)","user":"anonymous","dateUpdated":"2020-01-17T02:55:25-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"artist":"string","category":"string","price":"string","title":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887790_-1218764304","id":"20191127-141440_547735419","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:55:06-0800","dateFinished":"2020-01-17T02:55:10-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207351"},{"title":"4 - Define a MusicItem case class suitable for our music.json data","text":"case class MusicItem (artist: String, category: String, price: Double, title: String)","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887791_-830691593","id":"20191127-141652_1799475151","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:55:10-0800","dateFinished":"2020-01-17T02:55:11-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207352"},{"title":"5 - Create a typed Dataset from the musicDF dataframe using this class","text":"val musicDS = musicDF.as[MusicItem] ","user":"anonymous","dateUpdated":"2020-01-17T02:28:07-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887792_-758677772","id":"20191127-142055_121032729","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:55:11-0800","dateFinished":"2020-01-17T02:55:11-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207353"},{"title":"6 - Using musicDF get all the items in the \"Pop\" category","text":"z.show(musicDF.filter('category === \"Pop\"))","user":"anonymous","dateUpdated":"2020-01-17T02:55:36-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"artist":"string","category":"string","price":"string","title":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887793_-1679121615","id":"20191127-142354_1861609054","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:55:11-0800","dateFinished":"2020-01-17T02:55:12-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207354"},{"title":"7 - Using musicDS get all the items in the \"Pop\" category","text":"z.show(musicDS.filter('category === \"Pop\"))","user":"anonymous","dateUpdated":"2020-01-17T02:55:38-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"artist":"string","category":"string","price":"string","title":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887794_-1729698161","id":"20191127-142544_1135186291","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:55:12-0800","dateFinished":"2020-01-17T02:55:12-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207355"},{"title":"8 - Using musicDF get the lowest priced item in each category","text":"z.show(musicDF.groupBy('category).agg(min(\"price\")))","user":"anonymous","dateUpdated":"2020-01-17T02:55:39-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"category":"string","min(price)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887795_-619559837","id":"20191127-145636_158042902","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:55:12-0800","dateFinished":"2020-01-17T02:55:16-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207356"},{"title":"9 - Using musicDS get the lowest priced item in each category","text":"z.show(musicDS.groupBy('category).agg(min(\"price\")))","user":"anonymous","dateUpdated":"2020-01-17T02:55:49-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"category":"string","min(price)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887796_-1145368843","id":"20191127-145647_1173935006","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:55:16-0800","dateFinished":"2020-01-17T02:55:18-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207357"},{"title":"10 - Using musicDF create a discountedPrice column equal to 0.9 * price","text":"val musicWithDiscountDF = musicDF.withColumn(\"discountedPrice\", 'price * lit(0.9))\nz.show(musicWithDiscountDF)","user":"anonymous","dateUpdated":"2020-01-17T02:55:51-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"artist":"string","category":"string","price":"string","title":"string","discountedPrice":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887798_1687630656","id":"20191127-150509_1786332403","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:55:18-0800","dateFinished":"2020-01-17T02:55:19-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207358"},{"title":"11 - Using musicDS create a discountedPrice column equal to 0.9 * price","text":"case class DiscountedMusicItem (artist: String, category: String, price: Double, title: String, discountedPrice: Double)\nval musicWithDiscountDS = musicDF.withColumn(\"discountedPrice\", 'price * lit(0.9)).as[DiscountedMusicItem]\nz.show(musicWithDiscountDS)","user":"anonymous","dateUpdated":"2020-01-17T03:04:13-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887799_-1050151036","id":"20191127-150543_1766860750","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T03:04:13-0800","dateFinished":"2020-01-17T03:04:13-0800","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207359"},{"title":"12 - Using musicDF try multiplying the price by a literal string","text":"val musicWithDiscountDF = musicDF.withColumn(\"discountedPrice\", 'price * lit(\"A\"))\nz.show(musicWithDiscountDF)","user":"anonymous","dateUpdated":"2020-01-17T02:57:50-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"artist":"string","category":"string","price":"string","title":"string","discountedPrice":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887800_-552340150","id":"20191127-152727_1309115787","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:57:39-0800","dateFinished":"2020-01-17T02:57:47-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207360"},{"title":"13 - Using musicDS try multiplying the price by a literal string","text":"val musicWithDiscountDS = musicDF.withColumn(\"discountedPrice\", 'price * lit(\"A\")).as[DiscountedMusicItem]\nz.show(musicWithDiscountDS)","user":"anonymous","dateUpdated":"2020-01-17T02:58:09-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"title":true,"results":{},"enabled":true,"fontSize":9},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887802_1306034995","id":"20191127-153645_1760345126","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:58:09-0800","dateFinished":"2020-01-17T02:58:09-0800","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207361"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"anonymous","dateUpdated":"2020-01-17T02:42:50-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887803_-1785773711","id":"20181116-135131_93712280","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:42:50-0800","dateFinished":"2020-01-17T02:42:50-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207362"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera Educational Services\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"anonymous","dateUpdated":"2020-01-17T02:42:46-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256887804_225075293","id":"20181115-083751_61749794","dateCreated":"2020-01-17T02:28:07-0800","dateStarted":"2020-01-17T02:42:46-0800","dateFinished":"2020-01-17T02:42:46-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207363"},{"text":"%angular\n","user":"anonymous","dateUpdated":"2020-01-17T02:42:46-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579257766558_970014741","id":"20200117-024246_1701049325","dateCreated":"2020-01-17T02:42:46-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207364"}],"name":"Labs/Scala/TheDatasetTypedAPI","id":"2F1P3PJNX","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}