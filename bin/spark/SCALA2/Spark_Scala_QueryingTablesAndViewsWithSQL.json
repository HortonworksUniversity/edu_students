{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:** Use the Spark SQL query to analyze data\n**File locations:**\n**Successful outcome:**\n**Before you begin:**\n**Related lessons:** Querying Tables and Views with SQL\n\n---","user":"anonymous","dateUpdated":"2020-01-13T00:02:58-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111315_689276270","id":"20171105-200834_1116095891","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:13-0800","dateFinished":"2020-01-13T00:04:13-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:37442"},{"text":"%md\n# Setup\n---","user":"anonymous","dateUpdated":"2020-01-13T00:02:58-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111318_1499550260","id":"20181114-164229_902436001","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:13-0800","dateFinished":"2020-01-13T00:04:13-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37443"},{"text":"%sql\n-- This ensures that the notebook runs without an error\nDROP TABLE IF EXISTS devsh.name_dev","user":"anonymous","dateUpdated":"2020-01-13T00:02:58-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111319_1761327866","id":"20200112-232413_2145401888","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:13-0800","dateFinished":"2020-01-13T00:04:13-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37444"},{"text":"%md\n# Lab\n---","user":"anonymous","dateUpdated":"2020-01-13T00:02:58-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111321_-874190435","id":"20181114-164844_1661453681","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:13-0800","dateFinished":"2020-01-13T00:04:13-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37445"},{"text":"%md\n## Show Tables and Columns Using the Catalog API","user":"anonymous","dateUpdated":"2020-01-13T00:02:58-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111322_2011967210","id":"20171105-200519_752831754","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:13-0800","dateFinished":"2020-01-13T00:04:13-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37446"},{"title":"1 - View the list of current Hive tables and temporary views in the devsh database","text":"%spark\n","user":"anonymous","dateUpdated":"2020-01-13T00:02:59-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111324_647204250","id":"20200112-203716_1732237260","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37447"},{"title":"2 - List the schema (column definitions) of the devsh.accounts table","text":"%spark\n\n","user":"anonymous","dateUpdated":"2020-01-13T00:02:59-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111325_-1862843705","id":"20181115-084422_413255504","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37448"},{"text":"%md\n\n### Show Tables and Columns Using the Zeppelin Spark SQL interpreter\n","user":"anonymous","dateUpdated":"2020-01-13T00:02:59-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111327_1958281132","id":"20200112-203221_2008747188","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:13-0800","dateFinished":"2020-01-13T00:04:13-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37449"},{"title":"3 - View the list of current Hive tables and temporary views in the devsh database","text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-13T00:02:59-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111328_-1492153467","id":"20171105-200623_656362182","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37450"},{"title":"4 - List the schema (column definitions) of the devsh.accounts table","text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-13T00:02:59-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111330_858519648","id":"20200112-204423_1360432692","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37451"},{"title":"5 - Create a new DataFrame based on the devsh.accounts table, and confirm that its schema matches that of the column list above","text":"%spark\n","user":"anonymous","dateUpdated":"2020-01-13T00:02:59-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111332_-1161551105","id":"20200112-204718_1061081933","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37452"},{"text":"%md\n### Perform a SQL Query on a Table\n\nCreate a new DataFrame by performing a simple SQL query on the devsh.accounts table.\nConfirm that the schema and data is correct.","user":"anonymous","dateUpdated":"2020-01-13T00:02:59-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111334_1468857134","id":"20200112-205439_947084297","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:13-0800","dateFinished":"2020-01-13T00:04:13-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37453"},{"title":"6 - Create a new DataFrame by performing a simple SQL query on the devsh.accounts table","text":"%sql\n\n","user":"anonymous","dateUpdated":"2020-01-13T00:02:59-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111335_-1165942514","id":"20200112-205435_358095485","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37454"},{"text":"%md\n### Optional: \nPerform the equivalent query using the DataFrame API, and compare the schema and data in the results to those of the query above.","user":"anonymous","dateUpdated":"2020-01-13T00:02:59-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111337_2136087165","id":"20200112-210148_1790844192","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:13-0800","dateFinished":"2020-01-13T00:04:13-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37455"},{"title":"7 - Perform the equivalent query using the Dataframe API","text":"%spark\n","user":"anonymous","dateUpdated":"2020-01-13T00:02:59-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111339_2019724029","id":"20200112-210417_2141354770","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37456"},{"text":"%md\nCreate a DataFrame called accountDeviceDF based on the CSV files in /devsh_loudacre/accountdevice.\n(Be sure to use the headers and inferred schema to determine the column names and types.)","user":"anonymous","dateUpdated":"2020-01-13T00:02:59-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111341_1867592654","id":"20200112-210947_312291539","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:13-0800","dateFinished":"2020-01-13T00:04:13-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37457"},{"title":"8 - Create a DataFrame called accountDeviceDF based on the CSV files in /devsh_loudacre/accountdevice","text":"%spark\n","user":"anonymous","dateUpdated":"2020-01-13T00:03:00-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111343_-1332914265","id":"20200112-211033_340468246","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37458"},{"title":"9 - Create a temporary view on the accountDeviceDF DataFrame called account_dev","text":"%spark\n","user":"anonymous","dateUpdated":"2020-01-13T00:03:00-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111344_-942745885","id":"20200112-211654_1282596860","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37459"},{"text":"%md\nConfirm the view was created correctly by listing the tables and views in the devsh database as you did earlier. \nNotice that the account_dev table type is TEMPORARY.","user":"anonymous","dateUpdated":"2020-01-13T00:03:00-0800","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111346_-760223592","id":"20200112-211956_435929874","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:13-0800","dateFinished":"2020-01-13T00:04:13-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37460"},{"title":"10 - View the list of current Hive tables and temporary views in the devsh database","text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-13T00:03:00-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111348_-185571091","id":"20200112-212311_1378685958","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37461"},{"text":"%md\nUsing a SQL query, create a new DataFrame based on the first five rows of the account_dev view, and display the results.","user":"anonymous","dateUpdated":"2020-01-13T00:03:00-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111350_1551026959","id":"20200112-213152_498665976","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:14-0800","dateFinished":"2020-01-13T00:04:14-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37462"},{"title":"11 - Select the 5 first rows of the account_dev view","text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-13T00:03:00-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111352_1063451430","id":"20200112-213236_1791189546","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37463"},{"text":"%md\n### Use SQL to Join Two Tables","user":"anonymous","dateUpdated":"2020-01-13T00:03:00-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111354_767523623","id":"20200112-213733_818399323","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:14-0800","dateFinished":"2020-01-13T00:04:14-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37464"},{"title":"12 - Join the devsh.accounts table and account_dev view using the account ID, and display the results","text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-13T00:03:00-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111356_-602968786","id":"20200112-213910_204476410","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37465"},{"title":"13 - Save nameDevDF as a Hive table in the devsh called name_dev (with the file path as /devsh_loudacre/name_dev)","text":"%sql","user":"anonymous","dateUpdated":"2020-01-13T00:03:00-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111358_-2026829331","id":"20200112-214559_594008368","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37466"},{"title":"14 - Confirm that the table has been created","text":"%sql","user":"anonymous","dateUpdated":"2020-01-13T00:03:00-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111360_-53403384","id":"20200112-225843_1065373961","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37467"},{"text":"%md\n# Result\n**You have now:** used the Spark SQL API to analyze data\n\n---","user":"anonymous","dateUpdated":"2020-01-13T00:03:00-0800","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111362_726031349","id":"20181119-142716_792318228","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:14-0800","dateFinished":"2020-01-13T00:04:14-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37468"},{"text":"%md\n# Solution\n---","user":"anonymous","dateUpdated":"2020-01-13T00:03:01-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111364_-1423504464","id":"20171113-155535_1769142099","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:14-0800","dateFinished":"2020-01-13T00:04:14-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37469"},{"title":"1 - View the list of current Hive tables and temporary views in the devsh database","text":"%spark\n\nspark.catalog.listTables(\"devsh\").show","user":"anonymous","dateUpdated":"2020-01-13T00:03:01-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111365_656448685","id":"20200112-201236_1601512555","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:14-0800","dateFinished":"2020-01-13T00:04:14-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37470"},{"title":"2 - List the schema (column definitions) of the devsh.accounts table","text":"%spark\n\nspark.catalog.listColumns(\"devsh\",\"accounts\").show","user":"anonymous","dateUpdated":"2020-01-13T00:03:01-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111367_-1854982698","id":"20200112-203039_1578979357","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:14-0800","dateFinished":"2020-01-13T00:04:15-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37471"},{"title":"3 - View the list of current Hive tables and temporary views in the devsh database","text":"%sql\nSHOW TABLES IN devsh\n","user":"anonymous","dateUpdated":"2020-01-13T00:03:02-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"database":"string","tableName":"string","isTemporary":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111369_-1131384082","id":"20200112-203906_584822368","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:15-0800","dateFinished":"2020-01-13T00:04:15-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37472"},{"title":"4 - List the schema (column definitions) of the devsh.accounts table","text":"%sql\n\nDESCRIBE devsh.accounts","user":"anonymous","dateUpdated":"2020-01-13T00:03:02-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111372_967706122","id":"20200112-204510_1251015105","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:15-0800","dateFinished":"2020-01-13T00:04:15-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37473"},{"title":"5 - Create a new DataFrame based on the devsh.accounts table, and confirm that its schema matches that of the column list above","text":"%spark\n\nspark.read.table(\"devsh.accounts\").printSchema","user":"anonymous","dateUpdated":"2020-01-13T00:03:02-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111374_1010109365","id":"20200112-205147_2086671957","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:15-0800","dateFinished":"2020-01-13T00:04:15-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37474"},{"title":"6 - Create a new DataFrame by performing a simple SQL query on the devsh.accounts table","text":"%sql\n\nSELECT first_name,last_name FROM devsh.accounts","user":"anonymous","dateUpdated":"2020-01-13T00:03:02-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"first_name":"string","last_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111376_-71322018","id":"20200112-205801_643314295","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:15-0800","dateFinished":"2020-01-13T00:04:15-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37475"},{"title":"7 - Perform the equivalent query using the Dataframe API","text":"%spark\n\nz.show(spark.read.table(\"devsh.accounts\").select($\"first_name\",$\"last_name\"))","user":"anonymous","dateUpdated":"2020-01-13T00:03:11-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"first_name":"string","last_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111378_-2036911859","id":"20200112-210454_1665482649","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:16-0800","dateFinished":"2020-01-13T00:04:16-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37476"},{"title":"8 - Create a DataFrame called accountDeviceDF based on the CSV files in /devsh_loudacre/accountdevice","text":"%spark\n\nval accountDeviceDF = spark.read.option(\"header\",\"true\").option(\"inferSchema\",\"true\").csv(\"/devsh_loudacre/accountdevice\")\nz.show(accountDeviceDF)\n","user":"anonymous","dateUpdated":"2020-01-13T00:03:11-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","account_id":"string","device_id":"string","activation_date":"string","account_device_id":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111380_725752998","id":"20200112-211257_1439730338","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:16-0800","dateFinished":"2020-01-13T00:04:19-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37477"},{"title":"9 - Create a temporary view on the accountDeviceDF DataFrame called account_dev","text":"%spark\n\naccountDeviceDF.createOrReplaceTempView(\"account_dev\")","user":"anonymous","dateUpdated":"2020-01-13T00:03:15-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111383_751129537","id":"20200112-211800_376074023","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:19-0800","dateFinished":"2020-01-13T00:04:19-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37478"},{"title":"10 - View the list of current Hive tables and temporary views in the devsh database","text":"%sql\n\nSHOW TABLES IN devsh","user":"anonymous","dateUpdated":"2020-01-13T00:03:15-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"database":"string","tableName":"string","isTemporary":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111385_-389537748","id":"20200112-212610_73972141","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:19-0800","dateFinished":"2020-01-13T00:04:19-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37479"},{"title":"11 - Select the 5 first rows of the account_dev view","text":"%sql\n\nSELECT * FROM account_dev LIMIT 5","user":"anonymous","dateUpdated":"2020-01-13T00:03:16-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","account_id":"string","device_id":"string","activation_date":"string","account_device_id":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111387_-1651055626","id":"20200112-213354_2128079920","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:19-0800","dateFinished":"2020-01-13T00:04:20-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37480"},{"title":"12 - Join the devsh.accounts table and account_dev view using the account ID, and display the results","text":"%sql\n\nSELECT acct_num, first_name, last_name, account_device_id FROM devsh.accounts JOIN account_dev ON acct_num = account_id LIMIT 20","user":"anonymous","dateUpdated":"2020-01-13T00:03:16-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"acct_num":"string","first_name":"string","last_name":"string","account_device_id":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111389_505891079","id":"20200112-214002_1164911142","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:20-0800","dateFinished":"2020-01-13T00:04:21-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37481"},{"title":"13 - Save nameDevDF as a Hive table in the devsh called name_dev (with the file path as /devsh_loudacre/name_dev)","text":"%md\nThe query below should work but triggers a thrift error probably due to a configuration issue\n\n\n```sql\nCREATE TABLE IF NOT EXISTS devsh.name_dev LOCATION \"/devsh_loudacre/name_dev\" AS SELECT acct_num, first_name, last_name, account_device_id FROM devsh.accounts JOIN account_dev ON acct_num = account_id\n```\nThe following code will work in the spark shell though:\n\n```spark\nval nameDevDF = spark.sql(\"SELECT acct_num, first_name, last_name, account_device_id FROM devsh.accounts JOIN account_dev ON acct_num = account_id\")\nnameDevDF.write.option(\"path\",\"/devsh_loudacre/name_dev\").saveAsTable(\"devsh.name_dev\")\n```\n","user":"anonymous","dateUpdated":"2020-01-13T00:03:21-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111391_1873219180","id":"20200112-215112_425692993","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:21-0800","dateFinished":"2020-01-13T00:04:21-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37482"},{"title":"14 - Confirm that the table has been created","text":"%sql\n\nSHOW TABLES IN devsh","user":"anonymous","dateUpdated":"2020-01-13T00:03:21-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"database":"string","tableName":"string","isTemporary":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111393_-1042585516","id":"20200112-230116_2083335178","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:21-0800","dateFinished":"2020-01-13T00:04:21-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37483"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"anonymous","dateUpdated":"2020-01-13T00:03:21-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111395_-1298945880","id":"20181116-135131_93712280","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:21-0800","dateFinished":"2020-01-13T00:04:21-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37484"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera University\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"anonymous","dateUpdated":"2020-01-13T00:03:21-0800","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111397_-642833594","id":"20200110-154537_1406191376","dateCreated":"2020-01-12T23:38:31-0800","dateStarted":"2020-01-13T00:04:21-0800","dateFinished":"2020-01-13T00:04:21-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37485"},{"text":"%angular\n","user":"anonymous","dateUpdated":"2020-01-13T00:03:21-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578901111400_2075818864","id":"20200110-162013_302547143","dateCreated":"2020-01-12T23:38:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:37486"}],"name":"Labs/Scala/QueryingTablesAndViewsWithSQL","id":"2F1DRPZ4D","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}