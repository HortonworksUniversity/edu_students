{"paragraphs":[{"text":"%md\n# About\n**Objective:**\nIn this lab we are going to transform a heavily normalized database into one big denormalized table that we will store in a Hive ORC format for further processing.\nThe database is the AdventureWorks database that has been the sample database for Microsoft SQL Server for years.\n**File locations:** hdfs:///user/zeppelin/AdventureWorks/\n**Successful outcome:** A dashboard providing insights into the provided dataset\n**Before you begin:**\n**Related lessons:** Reading data formats, Spark SQL\n\n---","user":"anonymous","dateUpdated":"2020-01-17T03:17:28-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842631_737340328","id":"20171105-200834_1116095891","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:03-0800","dateFinished":"2020-01-17T04:00:03-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:216400"},{"text":"%md\n# Setup\n---","user":"anonymous","dateUpdated":"2020-01-17T03:17:28-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842641_-440485283","id":"20181114-164229_902436001","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:03-0800","dateFinished":"2020-01-17T04:00:03-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216401"},{"title":"Read the data from S3 and store it in HDFS","text":"%sh\nrm -f customers.csv\nrm -f employees.csv\nrm -f orders.csv\nrm -f productcategories.csv\nrm -f products.csv\nrm -f productsubcategories.csv\nrm -f vendorproduct.csv\nrm -f vendors.csv\nwget -nv https://hwu-training-public-repo.s3-us-west-2.amazonaws.com/TOPS/ILT/NG-1.0/DEV/DEV-343/customers.csv\nwget -nv https://hwu-training-public-repo.s3-us-west-2.amazonaws.com/TOPS/ILT/NG-1.0/DEV/DEV-343/employees.csv\nwget -nv https://hwu-training-public-repo.s3-us-west-2.amazonaws.com/TOPS/ILT/NG-1.0/DEV/DEV-343/orders.csv\nwget -nv https://hwu-training-public-repo.s3-us-west-2.amazonaws.com/TOPS/ILT/NG-1.0/DEV/DEV-343/productcategories.csv\nwget -nv https://hwu-training-public-repo.s3-us-west-2.amazonaws.com/TOPS/ILT/NG-1.0/DEV/DEV-343/products.csv\nwget -nv https://hwu-training-public-repo.s3-us-west-2.amazonaws.com/TOPS/ILT/NG-1.0/DEV/DEV-343/productsubcategories.csv\nwget -nv https://hwu-training-public-repo.s3-us-west-2.amazonaws.com/TOPS/ILT/NG-1.0/DEV/DEV-343/vendorproduct.csv\nwget -nv https://hwu-training-public-repo.s3-us-west-2.amazonaws.com/TOPS/ILT/NG-1.0/DEV/DEV-343/vendors.csv\nhdfs dfs -rm -f data/AdventureWorks/*\nhdfs dfs -mkdir -p data/AdventureWorks\nhdfs dfs -put customers.csv data/AdventureWorks/\nhdfs dfs -put employees.csv data/AdventureWorks/\nhdfs dfs -put orders.csv data/AdventureWorks/\nhdfs dfs -put productcategories.csv data/AdventureWorks/\nhdfs dfs -put products.csv data/AdventureWorks/\nhdfs dfs -put productsubcategories.csv data/AdventureWorks/\nhdfs dfs -put vendorproduct.csv data/AdventureWorks/\nhdfs dfs -put vendors.csv data/AdventureWorks/","user":"anonymous","dateUpdated":"2020-01-17T03:17:28-0800","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842642_-1402404872","id":"20181114-164621_138379904","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:04-0800","dateFinished":"2020-01-17T04:00:34-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216402"},{"title":"Set the data home directory","text":"val AdventureWorksHomeDirectory = \"/user/root/data/AdventureWorks/\"","user":"anonymous","dateUpdated":"2020-01-17T03:59:14-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842644_1534745332","id":"20181114-163151_254151007","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:34-0800","dateFinished":"2020-01-17T04:00:34-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216403"},{"text":"%md\n# Lab\n---","user":"anonymous","dateUpdated":"2020-01-17T03:17:59-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842645_-464643161","id":"20181114-164844_1661453681","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:35-0800","dateFinished":"2020-01-17T04:00:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216404"},{"text":"%md\n## Explore the data","user":"anonymous","dateUpdated":"2020-01-17T03:17:59-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842646_1332347747","id":"20171105-200519_752831754","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:35-0800","dateFinished":"2020-01-17T04:00:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216405"},{"text":"%md\nUse a shell paragraph to list the content of the AdventureWorks home directory","user":"anonymous","dateUpdated":"2020-01-17T03:17:59-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842647_1037214927","id":"20181115-084123_1911813743","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:35-0800","dateFinished":"2020-01-17T04:00:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216406"},{"title":"1 - List the content of the AdventureWorks home directory","text":"","user":"anonymous","dateUpdated":"2020-01-17T03:17:59-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842648_-244435412","id":"20171105-200623_656362182","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216407"},{"text":"%md\nThe orders.csv file is the largest. Let's take a look at its content.","user":"anonymous","dateUpdated":"2020-01-17T03:17:59-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842649_1334289078","id":"20171105-201923_413365117","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:35-0800","dateFinished":"2020-01-17T04:00:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216408"},{"title":"2 - Do a tail on orders.csv","text":"","user":"anonymous","dateUpdated":"2020-01-17T03:18:00-0800","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842650_-1023090130","id":"20171105-201709_849284875","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216409"},{"text":"%md\nThe 'orders' table  contains only numbers and dates, it is the facts table of what is referred to as a star schema database.\nThe other tables (employees, customers, products) are called dimensions.","user":"anonymous","dateUpdated":"2020-01-17T03:18:00-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842651_-826927120","id":"20171105-201449_1118165660","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:35-0800","dateFinished":"2020-01-17T04:00:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216410"},{"text":"%md\n## Load the data\n\nSpark has a method that can read a csv file into a dataframe. \nThis method has several options such as guessing the schema of the data and leveraging the header of the file to name columns.\nLet's see how these work by reading the orders.csv file three times: one without options, one with the header option and one with the header and the inferSchema options.","user":"anonymous","dateUpdated":"2020-01-17T03:18:00-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842652_-1140216624","id":"20171103-155034_200772208","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:35-0800","dateFinished":"2020-01-17T04:00:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216411"},{"title":"3 - Test the read options","text":"","user":"anonymous","dateUpdated":"2020-01-17T03:18:00-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842653_-1200948825","id":"20171105-203414_1467253952","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216412"},{"text":"%md\nLet's see if Spark guessed the schema right.","user":"anonymous","dateUpdated":"2020-01-17T03:18:00-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842654_2136293020","id":"20171105-203802_842066576","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:35-0800","dateFinished":"2020-01-17T04:00:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216413"},{"title":"4 - Do a printSchema on the three resulting dataframes","text":"","user":"anonymous","dateUpdated":"2020-01-17T03:18:00-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842655_-797195693","id":"20171105-203856_696546236","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216414"},{"text":"%md\nDates are always tricky. Spark did not get them but did a great job for the rest of the columns.\n","user":"anonymous","dateUpdated":"2020-01-17T03:18:00-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842656_-250931770","id":"20171105-204023_437072951","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:35-0800","dateFinished":"2020-01-17T04:00:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216415"},{"text":"%md\n## Getting the dates right\nA little research shows that you have to use two more options to get the dates right: [https://issues.apache.org/jira/browse/SPARK-19228] (https://issues.apache.org/jira/browse/SPARK-19228)\n","user":"anonymous","dateUpdated":"2020-01-17T03:18:01-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842657_-1735604869","id":"20171113-155847_1156836168","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:35-0800","dateFinished":"2020-01-17T04:00:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216416"},{"title":"5 - Add the options described in the link above and print the resulting schema","text":"\n","user":"anonymous","dateUpdated":"2020-01-17T03:18:01-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842658_-1923484533","id":"20171113-160109_1885523186","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216417"},{"text":"%md\nGetting types correct early on makes your life easier.\nThese options really saves a lot of coding.\nWe'll leverage this to load our data in dataframes and we'll also create the corresponding temporary tables.","user":"anonymous","dateUpdated":"2020-01-17T03:18:01-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842659_308215976","id":"20171113-161527_150688569","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:35-0800","dateFinished":"2020-01-17T04:00:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216418"},{"title":"6 - Load all the csv files in dataframes and create corresponding temporary views","text":"","user":"anonymous","dateUpdated":"2020-01-17T03:18:01-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842660_2059345921","id":"20171103-155601_864167622","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216419"},{"text":"%md\nLet's check if our 'orders' table has been loaded correctly.","user":"anonymous","dateUpdated":"2020-01-17T03:18:01-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842661_842021518","id":"20171105-210722_388935598","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:36-0800","dateFinished":"2020-01-17T04:00:36-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216420"},{"title":"7 - View the content of the 'orders' table","text":"","user":"anonymous","dateUpdated":"2020-01-17T03:18:01-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"SalesOrderID":"string","SalesOrderDetailID":"string","OrderDate":"string","DueDate":"string","ShipDate":"string","EmployeeID":"string","CustomerID":"string","SubTotal":"string","TaxAmt":"string","Freight":"string","TotalDue":"string","ProductID":"string","OrderQty":"string","UnitPrice":"string","UnitPriceDiscount":"string","LineTotal":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842661_39256948","id":"20171103-155429_1990654954","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216421"},{"text":"%md\n## Denormalisation\nWe are going to add the linked columns to each record of the products table.\nWe will keep the foreign keys in the record as they might be needed for machine learning algorithms which use numbers rather than strings.\nWe will store the result in a new permanent table called 'flatOrders' that will hold all the information contained in the star schema.\nWe will use the efficient ORC format for this new table.\nFirst we need to delete this table if it already exists.","user":"anonymous","dateUpdated":"2020-01-17T03:18:01-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842662_948229902","id":"20171103-161227_2135111661","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:36-0800","dateFinished":"2020-01-17T04:00:36-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216422"},{"title":"8 - Drop the flatOrders table if it exists","text":"","user":"anonymous","dateUpdated":"2020-01-17T03:18:02-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842663_-2060798348","id":"20171113-161417_1071287865","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216423"},{"title":"9 - Flatten the orders table into a flatOrders permanent table stored as ORC","text":"","user":"anonymous","dateUpdated":"2020-01-17T03:18:02-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842664_947872948","id":"20181115-165652_489886545","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216424"},{"text":"%md\nLet's check that the table has been created accordingly.\n","user":"anonymous","dateUpdated":"2020-01-17T03:18:02-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842666_1923686765","id":"20171110-204156_565690546","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:36-0800","dateFinished":"2020-01-17T04:00:36-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216425"},{"title":"10 - Use the Show create table command to confirm that the table is stored using the ORC format","text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-17T03:20:41-0800","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"createtab_stmt":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842667_-1119381599","id":"20171110-204138_1867283768","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T03:18:02-0800","dateFinished":"2020-01-17T03:18:02-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216426"},{"text":"%md\n## Leverage the new table to explore the data\n","user":"anonymous","dateUpdated":"2020-01-17T03:20:44-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842668_470109653","id":"20171110-204358_833338832","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:36-0800","dateFinished":"2020-01-17T04:00:36-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216427"},{"title":"11 - What are the 10 most successful products?","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":4,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"ProductName","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Total","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842669_-2127114825","id":"20181116-101008_372239380","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216428"},{"title":"12 - Who are the 10 most successful sales representatives?","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":4,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"EmployeeFullName","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Total","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842670_-737763366","id":"20181116-101130_1774622651","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216429"},{"title":"13 - What are the 10 most successful countries?","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":4,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842671_-274975126","id":"20181116-101328_2089957228","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216430"},{"title":"14 - Use the pivot table function","text":"","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"multiBarChart":{"stacked":false,"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"SubCategoryName","index":39,"aggr":"sum"}],"groups":[{"name":"CategoryName","index":37,"aggr":"sum"}],"values":[{"name":"LineTotal","index":15,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842672_-2018800053","id":"20181116-101501_84318460","dateCreated":"2020-01-17T02:27:22-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216431"},{"text":"%md\n# Result\n**You have now:** created an insightful dashboard with the data from this company using Spark DataFrames\n\n---","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842673_-1973837819","id":"20181119-142716_792318228","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:36-0800","dateFinished":"2020-01-17T04:00:36-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216432"},{"text":"%md\n# Solution\n---","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842674_-1064613494","id":"20171113-155535_1769142099","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:36-0800","dateFinished":"2020-01-17T04:00:36-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216433"},{"title":"1 - List the content of the AdventureWorks home directory","text":"%sh\nhdfs dfs -ls data/AdventureWorks","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842675_749129107","id":"20181115-084422_413255504","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:36-0800","dateFinished":"2020-01-17T04:00:38-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216434"},{"title":"2 - Do a tail on orders.csv","text":"%sh\nhdfs dfs -tail  data/AdventureWorks/orders.csv","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842677_1308945770","id":"20181115-092436_561920580","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:38-0800","dateFinished":"2020-01-17T04:00:41-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216435"},{"title":"3 - Test the read options","text":"val test1 = spark.read.csv(AdventureWorksHomeDirectory + \"orders.csv\")\nval test2 = spark.read.option(\"header\", \"true\").csv(AdventureWorksHomeDirectory + \"orders.csv\")\nval test3 = spark.read.option(\"header\", \"true\").option(\"inferSchema\",\"true\").csv(AdventureWorksHomeDirectory + \"orders.csv\")","user":"anonymous","dateUpdated":"2020-01-17T03:59:27-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842678_-997846967","id":"20181115-093206_1845018599","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:41-0800","dateFinished":"2020-01-17T04:00:51-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216436"},{"title":"4 - Do a printSchema on the three resulting dataframes","text":"test1.printSchema()\ntest2.printSchema()\ntest3.printSchema()","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842679_-1874534777","id":"20181115-102606_2027823741","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:51-0800","dateFinished":"2020-01-17T04:00:52-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216437"},{"title":"5 - Add the options described in the link above and print the resulting schema","text":"val test4 = spark.read.option(\"header\", \"true\")\n                      .option(\"inferSchema\",\"true\")\n                      .option(\"dateFormat\",\"mm/dd/yyyy\")\n                      .option(\"timestampFormat\", \"mm/dd/yyyy\")\n                      .csv(AdventureWorksHomeDirectory + \"orders.csv\")\ntest4.printSchema()\n","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842680_751335209","id":"20181115-125142_1309455330","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:52-0800","dateFinished":"2020-01-17T04:00:53-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216438"},{"title":"6 - Load all the csv files in dataframes and create corresponding temporary views","text":"val customers_DF = spark.read.option(\"header\", \"true\").option(\"inferSchema\",\"true\").csv(AdventureWorksHomeDirectory + \"customers.csv\")\ncustomers_DF.createOrReplaceTempView(\"customers\")\n\nval employees_DF = spark.read.option(\"header\", \"true\").option(\"inferSchema\",\"true\").csv(AdventureWorksHomeDirectory + \"employees.csv\")\nemployees_DF.createOrReplaceTempView(\"employees\")\n\nval products_DF = spark.read.option(\"header\", \"true\").option(\"inferSchema\",\"true\").csv(AdventureWorksHomeDirectory + \"products.csv\")\nproducts_DF.createOrReplaceTempView(\"products\")\n\nval productCategories_DF = spark.read.option(\"header\", \"true\").option(\"inferSchema\",\"true\").csv(AdventureWorksHomeDirectory + \"productcategories.csv\")\nproductCategories_DF.createOrReplaceTempView(\"productCategories\")\n\nval productSubCategories_DF = spark.read.option(\"header\", \"true\").option(\"inferSchema\",\"true\").csv(AdventureWorksHomeDirectory + \"productsubcategories.csv\")\nproductSubCategories_DF.createOrReplaceTempView(\"productSubCategories\")\n\nval vendor_DF = spark.read.option(\"header\", \"true\").option(\"inferSchema\",\"true\").csv(AdventureWorksHomeDirectory + \"vendors.csv\")\nvendor_DF.createOrReplaceTempView(\"vendors\")\n\nval productVendor_DF = spark.read.option(\"header\", \"true\").option(\"inferSchema\",\"true\").csv(AdventureWorksHomeDirectory + \"vendorproduct.csv\")\nproductVendor_DF.createOrReplaceTempView(\"productVendors\")\n\nval orders_DF = spark.read.option(\"header\", \"true\")\n                          .option(\"inferSchema\",\"true\")\n                          .option(\"dateFormat\",\"mm/dd/yyyy\")\n                          .option(\"timestampFormat\", \"mm/dd/yyyy\")\n                          .csv(AdventureWorksHomeDirectory + \"orders.csv\")\norders_DF.createOrReplaceTempView(\"orders\")","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842681_851687447","id":"20181115-163929_1334378173","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:53-0800","dateFinished":"2020-01-17T04:00:56-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216439"},{"title":"7 - View the content of the 'orders' table","text":"%sql\nSELECT * FROM orders","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"SalesOrderID":"string","SalesOrderDetailID":"string","OrderDate":"string","DueDate":"string","ShipDate":"string","EmployeeID":"string","CustomerID":"string","SubTotal":"string","TaxAmt":"string","Freight":"string","TotalDue":"string","ProductID":"string","OrderQty":"string","UnitPrice":"string","UnitPriceDiscount":"string","LineTotal":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842682_-1395311638","id":"20181115-164355_1755205263","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:56-0800","dateFinished":"2020-01-17T04:00:56-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216440"},{"title":"8 - Drop the flatorders table if it exists","text":"%sql\nDROP TABLE IF EXISTS flatorders\n","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842684_-2032425356","id":"20181115-165022_1791632952","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:56-0800","dateFinished":"2020-01-17T04:00:56-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216441"},{"title":"9 - Flatten the orders table into a flatOrders permanent table stored as ORC","text":"%sql\nCREATE TABLE flatOrders STORED AS ORC AS\nSELECT orders.SalesOrderID,\n       orders.SalesOrderDetailID,\n       orders.OrderDate,\n       orders.DueDate,\n       orders.ShipDate,\n       orders.EmployeeID,\n       orders.CustomerID,\n       orders.SubTotal,\n       orders.TaxAmt,\n       orders.Freight,\n       orders.TotalDue,\n       orders.ProductID,\n       orders.OrderQty,\n       orders.UnitPrice,\n       orders.UnitPriceDiscount,\n       orders.LineTotal,\n       employees.ManagerID,\n       employees.FirstName AS EmployeeFirstName,\n       employees.LastName  AS EmployeeLastName,\n       employees.FullName  AS EmployeeFullName,\n       employees.JobTitle,\n       employees.OrganizationLevel,\n       employees.MaritalStatus,\n       employees.Gender,\n       employees.Territory,\n       employees.Country,\n       employees.Group,\n       customers.FirstName AS CustomerFirstName,\n       customers.LastName  AS CustomerLastName,\n       customers.FullName  AS CustomerFullName,\n       products.ProductNumber, \n       products.ProductName, \n       products.ModelName, \n       products.MakeFlag, \n       products.StandardCost,\n       products.ListPrice,\n       productSubCategories.CategoryID,\n       productCategories.CategoryName,       \n       products.SubCategoryID,\n       productSubCategories.SubCategoryName\nFROM orders\nINNER JOIN employees ON orders.EmployeeID=employees.EmployeeID\nINNER JOIN customers ON orders.CustomerID=customers.CustomerID\nINNER JOIN products ON orders.ProductID=products.ProductID\nINNER JOIN productSubCategories ON products.SubCategoryID=productSubCategories.SubCategoryID \nINNER JOIN productCategories ON productSubCategories.CategoryID=productCategories.CategoryID","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842685_1007235626","id":"20181116-100721_978851560","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T04:00:56-0800","dateFinished":"2020-01-17T04:00:57-0800","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216442"},{"title":"10 - Use the Show create table command to confirm that the table is stored using the ORC format","text":"%sql\nSHOW CREATE TABLE flatorders\n","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"createtab_stmt":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842686_929619689","id":"20181116-100525_1110459990","dateCreated":"2020-01-17T02:27:22-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216443"},{"title":"11 - What are the 10 most successful products?","text":"%sql\nSELECT ProductName, sum(LineTotal) AS Total FROM flatorders GROUP BY ProductName ORDER BY Total DESC LIMIT 10","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":4,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"ProductName","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Total","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842688_-1233638068","id":"20171110-204620_955565327","dateCreated":"2020-01-17T02:27:22-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216444"},{"title":"12 - Who are the 10 most successful sales representatives?","text":"%sql\nSELECT EmployeeFullName, sum(LineTotal) AS Total FROM flatorders GROUP BY EmployeeFullName ORDER BY Total DESC LIMIT 10","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":4,"editorMode":"ace/mode/sql","editorHide":false,"fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"EmployeeFullName","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Total","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842689_1394960246","id":"20171110-205247_1262059301","dateCreated":"2020-01-17T02:27:22-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216445"},{"title":"13 - What are the 10 most successful countries?","text":"%sql\nSELECT Country, sum(LineTotal) AS Total FROM flatorders GROUP BY Country ORDER BY Total DESC LIMIT 10","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":4,"editorMode":"ace/mode/sql","editorHide":false,"fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842690_507422457","id":"20171110-205526_71873874","dateCreated":"2020-01-17T02:27:22-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216446"},{"title":"14 - Use the pivot table function","text":"%sql\nSELECT * FROM flatorders","user":"anonymous","dateUpdated":"2020-01-17T02:27:22-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"setting":{"multiBarChart":{"stacked":false,"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"SubCategoryName","index":39,"aggr":"sum"}],"groups":[{"name":"CategoryName","index":37,"aggr":"sum"}],"values":[{"name":"LineTotal","index":15,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842691_-1107204249","id":"20171110-205748_300525706","dateCreated":"2020-01-17T02:27:22-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216447"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"anonymous","dateUpdated":"2020-01-17T02:46:52-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842693_1799949534","id":"20181116-135131_93712280","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T02:46:52-0800","dateFinished":"2020-01-17T02:46:52-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216448"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera Educational Services\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"anonymous","dateUpdated":"2020-01-17T02:46:48-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256842694_1724530182","id":"20181115-083751_61749794","dateCreated":"2020-01-17T02:27:22-0800","dateStarted":"2020-01-17T02:46:48-0800","dateFinished":"2020-01-17T02:46:48-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216449"},{"text":"%angular\n","user":"anonymous","dateUpdated":"2020-01-17T02:46:48-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579258008448_136970780","id":"20200117-024648_2120462190","dateCreated":"2020-01-17T02:46:48-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216450"}],"name":"Labs/Scala/AdventureWorks","id":"2EXSAT4PP","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}