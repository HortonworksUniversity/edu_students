{"paragraphs":[{"text":"%md\n## Apache Spark in 5 Minutes \n\n![sv-image](https://raw.githubusercontent.com/roberthryniewicz/images/master/silicon_valley_corporation.jpg)","user":"anonymous","dateUpdated":"2020-01-17T03:12:09-0800","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898963_-2091525835","id":"20161013-011142_1891215806","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:09-0800","dateFinished":"2020-01-17T03:12:09-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:197023"},{"title":"","text":"%md\n### Silicon Valley Episode Dataset \n\nWelcome to a quick overview of Apache Spark with Sillicon Valley Episodes dataset. If you've never watched the Silicon Valley show you can learn more about it [here](https://en.wikipedia.org/wiki/Silicon_Valley_(TV_series)). \n\nIn this notebook we will download the dataset (in JSON format) from an external github repository, ingest it into a Spark Dataset and perform basic analysis, filtering, and word count.","user":"anonymous","dateUpdated":"2020-01-17T03:12:09-0800","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898965_1768329998","id":"20161013-011155_1645524279","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:09-0800","dateFinished":"2020-01-17T03:12:09-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197024"},{"text":"%md\n### A few tips to run your Zeppelin Notebook:\n","user":"anonymous","dateUpdated":"2020-01-17T03:12:09-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898965_-1595016327","id":"20180730-232125_111968177","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:09-0800","dateFinished":"2020-01-17T03:12:09-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197025"},{"title":"How to run a paragraph?","text":"%md\nTo run a paragraph in a Zeppelin notebook you can either click the `play` button (blue triangle) on the right-hand side or simply press `Shift + Enter`.","user":"anonymous","dateUpdated":"2020-01-17T03:12:09-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898966_1931805358","id":"20161014-144044_1782842084","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:09-0800","dateFinished":"2020-01-17T03:12:09-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197026"},{"title":"Some initial delay to be expected...","text":"%md\n**Note**: The first time you run `spark.version` in the paragraph below, several services will initialize in the background. \nThis may take **1~2 min** so please **be patient**.\n\nAfterwards, each paragraph should run much more quickly since all the services will already be running.","user":"anonymous","dateUpdated":"2020-01-17T03:12:09-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898967_-688709906","id":"20161014-144409_1067974024","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:09-0800","dateFinished":"2020-01-17T03:12:09-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197027"},{"title":"Verify Spark Version (should be 2.x)","text":"%spark\n\nspark.version","user":"anonymous","dateUpdated":"2020-01-17T03:12:09-0800","config":{"editorSetting":{"editOnDblClick":false,"language":"scala","completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898968_-1238150080","id":"20161012-235330_1461856587","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:09-0800","dateFinished":"2020-01-17T03:12:10-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197028"},{"text":"%md \n### Downloading and Moving the Silicon Valley Episodes Dataset to HDFS\n","user":"anonymous","dateUpdated":"2020-01-17T03:12:10-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898969_-1148283391","id":"20180730-233029_703863207","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:10-0800","dateFinished":"2020-01-17T03:12:10-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197029"},{"title":"Download JSON data file","text":"%sh \n\n#  Remove old json file if already exists in local /tmp directory\nif [ -e /tmp/svepisodes.json ]\nthen\n    rm -f /tmp/svepisodes.json\nfi\n\nwget https://raw.githubusercontent.com/hortonworks/data-tutorials/master/tutorials/hdp/hands-on-tour-of-apache-spark-in-5-minutes/assets/svepisodes.json -O /tmp/svepisodes.json -O /tmp/svepisodes.json","user":"anonymous","dateUpdated":"2020-01-17T03:12:10-0800","config":{"editorSetting":{"editOnDblClick":false,"language":"sh","completionSupport":false,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898969_687890662","id":"20161012-193914_1818868460","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:10-0800","dateFinished":"2020-01-17T03:12:10-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197030"},{"title":"Move file from Local Storage to HDFS (if available/supported)","text":"%sh\n\n# Remove existing (if any) copy of data from HDFS\nhdfs dfs -rm -f /tmp/svepisodes.json\n\n# Move downloaded JSON file from local storage to HDFS\nhdfs dfs -put /tmp/svepisodes.json /tmp\n","user":"anonymous","dateUpdated":"2020-01-17T03:12:10-0800","config":{"editorSetting":{"editOnDblClick":false,"language":"sh","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898970_-2045032905","id":"20161012-200245_1679004004","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:10-0800","dateFinished":"2020-01-17T03:12:15-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197031"},{"text":"%md\n### Datasets and DataFrames\n\nTo learn more about Dataset and DataFrames [Hands-On Tour of Apache Spark in 5 Minutes] (https://hortonworks.com/tutorial/hands-on-tour-of-apache-spark-in-5-minutes/#concepts).","user":"anonymous","dateUpdated":"2020-01-17T03:12:15-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898971_683340953","id":"20180731-000019_1989726588","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:15-0800","dateFinished":"2020-01-17T03:12:15-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197032"},{"title":"Load data into a Spark DataFrame","text":"%spark\n\nval path = \"/tmp/svepisodes.json\"\nval svEpisodes = spark.read.json(path)         // Create a DataFrame from JSON data (automatically infer schema and data types)","user":"anonymous","dateUpdated":"2020-01-17T03:12:15-0800","config":{"editorSetting":{"editOnDblClick":false,"language":"scala","completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898972_-149052242","id":"20161012-200853_1560821654","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:15-0800","dateFinished":"2020-01-17T03:12:23-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197033"},{"title":"Print DataFrame Schema","text":"%spark\n\nsvEpisodes.printSchema()","user":"anonymous","dateUpdated":"2020-01-17T03:12:23-0800","config":{"editorSetting":{"editOnDblClick":false,"language":"scala","completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898973_812375662","id":"20161012-202011_596248668","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:23-0800","dateFinished":"2020-01-17T03:12:23-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197034"},{"title":"Data Description","text":"%angular\n\n<!DOCTYPE html>\n<html>\n<head>\n<style>\ntable {\n    font-family: arial, sans-serif;\n    border-collapse: collapse;\n    width: 70%;\n}\n\ntd, th {\n    border: 1px solid #dddddd;\n    text-align: left;\n    padding: 8px;\n}\n\ntr:nth-child(even) {\n    background-color: #dddddd;\n}\n</style>\n</head>\n\n<table>\n<tbody>\n<tr>\n  <th></th>\n  <th>Column Name</th>\n  <th>Description</th>\n</tr><tr>\n  <td>1</td>\n  <td>Airdate</td>\n  <td>Date when an episode was aired</td>\n</tr><tr>\n  <td>2</td>\n  <td>Airstamp</td>\n  <td>Timestamp when an episode was aired</td>\n</tr><tr>\n  <td>3</td>\n  <td>Airtime</td>\n  <td>Length of an actual episode airtime (no commercials)</td>\n</tr><tr>\n  <td>4</td>\n  <td>Id</td>\n  <td>Unique show id</td>\n</tr><tr>\n  <td>5</td>\n  <td>Name</td>\n  <td>Name of an episode </td>\n</tr><tr>\n  <td>6</td>\n  <td>Number</td>\n  <td>Episode number</td>\n</tr><tr>\n  <td>7</td>\n  <td>Runtime</td>\n  <td>Total length of an episode (including commercials)</td>\n</tr><tr>\n  <td>8</td>\n  <td>Season</td>\n  <td>Show season</td>\n</tr><tr>\n  <td>9</td>\n  <td>Summary</td>\n  <td>Brief summary of an episode</td>\n</tr><tr>\n  <td>10</td>\n  <td>Url</td>\n  <td>Url where more information is available online about an episode</td>\n</tr>\n</tbody></table>\n\n</body>\n</html>\n","user":"anonymous","dateUpdated":"2020-01-17T03:12:23-0800","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","editorHide":true,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898973_36670303","id":"20161014-140056_345247395","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:23-0800","dateFinished":"2020-01-17T03:12:23-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197035"},{"title":"Show DataFrame Contents","text":"%spark\n\nsvEpisodes.show()","user":"anonymous","dateUpdated":"2020-01-17T03:12:23-0800","config":{"editorSetting":{"editOnDblClick":false,"language":"scala","completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898974_297117865","id":"20161012-234401_1548074862","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:23-0800","dateFinished":"2020-01-17T03:12:24-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197036"},{"title":"","text":"%md\n\n### Is there a more interactive way to display query results?\n\nShort answer, yes! The data displayed in the paragraph above isn't too interactive. To have a more dynamic experience, let's create a temporary (in-memory) view that we can query against and interact with the resulting data in a table or graph format. The temporary view will allow us to run SQL queries to get back results.\n\n**Note** that the temporary view will reside in memory as long as the Spark session is alive.","user":"anonymous","dateUpdated":"2020-01-17T03:12:24-0800","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898975_-790368804","id":"20161013-005846_439497469","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:24-0800","dateFinished":"2020-01-17T03:12:24-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197037"},{"title":"Create a Temporary View","text":"%spark\n\n// Creates a temporary view\nsvEpisodes.createOrReplaceTempView(\"svepisodes\")","user":"anonymous","dateUpdated":"2020-01-17T03:12:24-0800","config":{"editorSetting":{"editOnDblClick":false,"language":"scala","completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":[],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898976_-1509510618","id":"20161012-202125_3295223","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:24-0800","dateFinished":"2020-01-17T03:12:24-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197038"},{"title":"So now what?","text":"%md\n#### So now what?\nAt this point we can run queries using a familiar SQL syntax against our newly registered `svepisodes` table. \n\n**Note** that although we are using a SQL syntax in the following paragraph it is translated and executed using the Spark engine with all the expected optimizations.","user":"anonymous","dateUpdated":"2020-01-17T03:12:24-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898977_2035866326","id":"20161013-182547_1601163342","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:24-0800","dateFinished":"2020-01-17T03:12:24-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197039"},{"title":"View Data in an Interactive Table Format","text":"%sql\n\nSELECT * FROM svepisodes ORDER BY season, number","user":"anonymous","dateUpdated":"2020-01-17T03:12:24-0800","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql","completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"airdate","index":0,"aggr":"sum"}],"values":[{"name":"airstamp","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"airdate","index":0,"aggr":"sum"},"yAxis":{"name":"airstamp","index":1,"aggr":"sum"}},"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"airdate":"string","airstamp":"string","airtime":"string","id":"string","name":"string","number":"string","runtime":"string","season":"string","summary":"string","url":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898978_1351662898","id":"20161013-005646_1818766386","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:25-0800","dateFinished":"2020-01-17T03:12:25-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197040"},{"title":"","text":"%md\n### Running a more complex SQL query on the uderlying table data\n","user":"anonymous","dateUpdated":"2020-01-17T03:12:25-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898979_-409846499","id":"20161013-182951_885833546","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:25-0800","dateFinished":"2020-01-17T03:12:25-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197041"},{"title":"Total Number of Episodes","text":"%sql\n\nSELECT count(1) AS TotalNumEpisodes FROM svepisodes","user":"anonymous","dateUpdated":"2020-01-17T03:12:25-0800","config":{"editorSetting":{"editOnDblClick":false,"language":"sql","completionKey":"TAB","completionSupport":true},"colWidth":4,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"TotalNumEpisodes","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"TotalNumEpisodes","index":0,"aggr":"sum"}},"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"TotalNumEpisodes":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898980_-279651253","id":"20161017-235756_1441150850","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:25-0800","dateFinished":"2020-01-17T03:12:26-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197042"},{"title":"Number of Episodes per Season","text":"%sql \n\nSELECT season, count(number) as episodes FROM svepisodes GROUP BY season","user":"anonymous","dateUpdated":"2020-01-17T03:12:26-0800","config":{"editorSetting":{"editOnDblClick":false,"language":"sql","completionKey":"TAB","completionSupport":true},"colWidth":8,"editorMode":"ace/mode/sql","editorHide":false,"fontSize":9,"title":true,"results":[{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"season","index":0,"aggr":"sum"}],"values":[{"name":"episodes","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"season","index":0,"aggr":"sum"}},"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"season":"string","episodes":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898981_1426177735","id":"20161012-202204_1707933023","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:26-0800","dateFinished":"2020-01-17T03:12:29-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197043"},{"title":"","text":"%md\n### Word Count on Episode Summaries\n\nNow let's perform a basic word-count on the summary column and find out which words occur most frequently. This should give us some indication on the popularity of certain characters and other relevant keywords in the context of the Sillicon Valley show.","user":"anonymous","dateUpdated":"2020-01-17T03:12:29-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898981_1322395519","id":"20161013-010351_1570854534","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:29-0800","dateFinished":"2020-01-17T03:12:29-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197044"},{"title":"Raw Word Count","text":"%spark\n\nimport org.apache.spark.sql.functions._                        // Import additional helper functions\n\nval svSummaries = svEpisodes.select(\"summary\").as[String]      // Convert to String type (becomes a Dataset)\n\n// Extract individual words\nval words = (svSummaries\n  .flatMap(_.split(\"\\\\s+\"))                             // Split on whitespace\n  .filter(_ != \"\")                                      // Remove empty words\n  .map(_.toLowerCase()) )                                // Lowercase\n\n// Word count\n(words.groupByKey(value => value)                        // Group by word\n     .count()                                           // Count\n     .orderBy($\"count(1)\" desc)                         // Order by most frequent\n     .show())                                           // Display results","user":"anonymous","dateUpdated":"2020-01-17T03:12:29-0800","config":{"editorSetting":{"editOnDblClick":false,"language":"scala","completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898982_44819103","id":"20161013-000142_472015281","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:29-0800","dateFinished":"2020-01-17T03:12:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197045"},{"title":"Can we improve this?","text":"%md\n\nAs you can see there are plenty of stop words and punctuation marks that surface to the top. Let's clean this up a bit by creating a basic stop word list and a punctuation mark list that we'll use as basic filters before we aggregate and order the words again.","user":"anonymous","dateUpdated":"2020-01-17T03:12:35-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898983_-118138315","id":"20161013-010505_1972414834","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:35-0800","dateFinished":"2020-01-17T03:12:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197046"},{"title":"More Sophisticated Filtering","text":"%spark\n\nval stopWords = List(\"a\", \"an\", \"to\", \"and\", \"the\", \"of\", \"in\", \"for\", \"by\", \"at\")      // Basic set of stop words\nval punctuationMarks = List(\"-\", \",\", \";\", \":\", \".\", \"?\", \"!\")                          // Basic set of punctuation marks\n\n// Filter out stop words and punctuation marks\nval wordsFiltered = (words                                                               // Create a new Dataset\n    .filter(!stopWords.contains(_))                                                     // Remove stop words\n    .filter(!punctuationMarks.contains(_)))                                              // Remove punctuation marks","user":"anonymous","dateUpdated":"2020-01-17T03:12:35-0800","config":{"editorSetting":{"editOnDblClick":false,"language":"scala","completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898984_2099302971","id":"20161013-003539_1918843179","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:35-0800","dateFinished":"2020-01-17T03:12:36-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197047"},{"title":"Improved Word Count","text":"%spark\n\n// Word count\n(wordsFiltered\n  .groupBy($\"value\" as \"word\")                          // Group on values (default) column name\n  .agg(count(\"*\") as \"occurences\")                      // Aggregate\n  .orderBy($\"occurences\" desc)                          // Display most common words first\n  .show())                                               // Display results","user":"anonymous","dateUpdated":"2020-01-17T03:12:36-0800","config":{"editorSetting":{"editOnDblClick":false,"language":"scala","completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898985_1310849996","id":"20161013-004841_1248757887","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:36-0800","dateFinished":"2020-01-17T03:12:41-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197048"},{"title":"Note on the Results","text":"%md\n\nLooks like Richard, Pied Piper, Dinesh, Erlich, Gavin and Jared are the key words in the Sillicon Valley show. Looks like a lot revolves around Richard!","user":"anonymous","dateUpdated":"2020-01-17T03:12:41-0800","config":{"editorSetting":{},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":true,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898986_1800137758","id":"20161014-142139_512800114","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:41-0800","dateFinished":"2020-01-17T03:12:41-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197049"},{"title":"","text":"%md\n### Final Comments on Word Count\n\nAs you can see, there's more to do with our word list, e.g. Piper and Piper's should be counted as the same word. There's more, of course, however this is beyond the scope of this quick intro to Apache Spark.","user":"anonymous","dateUpdated":"2020-01-17T03:12:41-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898987_1937711095","id":"20161013-010754_1315051750","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:41-0800","dateFinished":"2020-01-17T03:12:41-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197050"},{"title":"","text":"%md\n### Additional Resource\n\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"anonymous","dateUpdated":"2020-01-17T03:12:41-0800","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"title":false,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898988_-1433187576","id":"20160226-200649_425588199","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:41-0800","dateFinished":"2020-01-17T03:12:41-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197051"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera Educational Services\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"anonymous","dateUpdated":"2020-01-17T03:12:41-0800","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","editorHide":true,"fontSize":9,"results":[{"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}}],"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579256898989_-731058996","id":"20161013-185141_1487979052","dateCreated":"2020-01-17T02:28:18-0800","dateStarted":"2020-01-17T03:12:41-0800","dateFinished":"2020-01-17T03:12:41-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197052"},{"text":"%angular\n","user":"anonymous","dateUpdated":"2020-01-17T03:12:41-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579257930330_-875893691","id":"20200117-024530_47177080","dateCreated":"2020-01-17T02:45:30-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:197053"}],"name":"Labs/Scala/ApacheSparkIn5Minutes","id":"2EXK5MJB1","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}