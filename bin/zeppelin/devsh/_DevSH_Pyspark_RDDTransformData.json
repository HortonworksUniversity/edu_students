{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:** Explore RDDs tranformations. Load a text file into a RDD. Then create a RDD based on website log data. Practice transforming this data. Manipulate \ndevice status data in a RDD.\n**Exercise files:** \n    Exercise directory: /home/training/training_materials/devsh/exercises/transform-rdds\n    Data (local): /home/training/training_materials/devsh/data/weblogs\n                  /home/training/training_materials/devsh/data/devicestatus.txt\n**Successful outcome:**\n**Before you begin:**\n**Related lessons:** Transforming Data with RDDs\n\n---","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>About This Lab</h1>\n<p><strong>Objective:</strong> Explore RDDs tranformations. Load a text file into a RDD. Then create a RDD based on website log data. Practice transforming this data. Manipulate\n<br  />device status data in a RDD.\n<br  /><strong>Exercise files:</strong></p>\n<pre><code>Exercise directory: /home/training/training_materials/devsh/exercises/transform-rdds\nData (local): /home/training/training_materials/devsh/data/weblogs\n              /home/training/training_materials/devsh/data/devicestatus.txt\n</code></pre>\n<p><strong>Successful outcome:</strong>\n<br  /><strong>Before you begin:</strong>\n<br  /><strong>Related lessons:</strong> Transforming Data with RDDs</p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1617197566075_366531661","id":"20171105-200834_1116095891","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:483517"},{"text":"%md\n# Setup\n---\nThe following cells ensure that this notebook can run from top to bottom without errors any number of times.","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Setup</h1>\n<hr />\n<p>The following cells ensure that this notebook can run from top to bottom without errors any number of times.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566076_825930892","id":"20181114-164229_902436001","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483518"},{"title":"Delete HDFS files to prevent file exist errors","text":"%sh\n\nhdfs dfs -rm -r -f -skipTrash /devsh_loudacre/weblogs\nhdfs dfs -rm -r -f -skipTrash /devsh_loudacre/iplist\nhdfs dfs -rm -r -f -skipTrash /devsh_loudacre/userips_csv\nhdfs dfs -rm -r -f -skipTrash /devsh_loudacre/devicestatus.txt\nhdfs dfs -rm -r -f -skipTrash /devsh_loudacre/devicestatus_etl\nhdfs dfs -rm -r -f -skipTrash /devsh_loudacre/activations\nhdfs dfs -rm -r -f -skipTrash /devsh_loudacre/account-models","user":"anonymous","dateUpdated":"2021-03-31T09:53:32-0700","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1617197566077_-1709969837","id":"20200120-002654_545000747","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T09:53:32-0700","dateFinished":"2021-03-31T09:53:45-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483519"},{"title":"Set the environment variable to manage thread count","text":"%sh\n\nPYSPARK_PIN_THREAD=true","user":"anonymous","dateUpdated":"2021-03-31T09:53:52-0700","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1617197566077_-1655487005","id":"20200830-163746_574851316","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T09:53:52-0700","dateFinished":"2021-03-31T09:53:52-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483520"},{"title":"Start the Spark Context for Livy","text":"%pyspark\n\nsc = spark.sparkContext","user":"anonymous","dateUpdated":"2021-03-31T09:54:44-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<font color=\"red\">Previous livy session is expired, new livy session is created. Paragraphs that depend on this paragraph need to be re-executed!</font>"}]},"apps":[],"jobName":"paragraph_1617197566077_-1926775927","id":"20200830-163851_381275363","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T09:54:44-0700","dateFinished":"2021-03-31T09:55:30-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483521"},{"text":"%md\n# Lab\n---","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Lab</h1>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1617197566077_863395249","id":"20181114-164844_1661453681","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483522"},{"text":"%md\n### Explore the Loudacre Web Log Files","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Explore the Loudacre Web Log Files</h3>\n"}]},"apps":[],"jobName":"paragraph_1617197566078_734862442","id":"20210123-132633_1958534497","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483523"},{"title":"1 - View weblogs","text":"%sh\n\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566078_694447839","id":"20210121-193211_824772981","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483524"},{"title":"1 - Copy the weblogs directory from the local filesystem to the /devsh_loudacre HDFS directory","text":"%sh\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566078_745581192","id":"20200120-002607_2067603572","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483525"},{"text":"%md\nIn this section you will be using data in data/weblogs. Review one of the .log files in the directory. \nNote the format of the lines and the positions of the IP address, the user ID and the request:\n```pyspark\n234.206.18.239 - 8495 [15/Mar/2014:23:59:30 +0100] \"GET /KBDOC-00082.html HTTP/1.0\" 200 9054 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser Titanic 2200\"\n```","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In this section you will be using data in data/weblogs. Review one of the .log files in the directory.\n<br  />Note the format of the lines and the positions of the IP address, the user ID and the request:</p>\n<pre><code class=\"pyspark\">234.206.18.239 - 8495 [15/Mar/2014:23:59:30 +0100] \"GET /KBDOC-00082.html HTTP/1.0\" 200 9054 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser Titanic 2200\"\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1617197566078_875971695","id":"20200120-001407_100530890","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483526"},{"title":"2 - Create an RDD from the uploaded web logs data files in the /devsh_loudacre/weblogs/ directory in HDFS","text":"%pyspark","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566079_1138036311","id":"20200427-022631_1239569656","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483527"},{"text":"%md\nCreate an RDD containing only lines that are requests for JPG files. \nUse the filter operation with a transformation function that takes a string RDD element and returns a boolean value.","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Create an RDD containing only lines that are requests for JPG files.\n<br  />Use the filter operation with a transformation function that takes a string RDD element and returns a boolean value.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566079_-556198467","id":"20200120-003443_338001548","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483528"},{"title":"3 - Create an RDD containing only lines that are requests for JPG files","text":"%pyspark\n\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566079_2087095166","id":"20200120-003439_334088836","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483529"},{"text":"%md\nUse take to return the first five lines of the data in jpglogsRDD. The return value is a list of strings (in Python) or array of strings (in Scala).","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Use take to return the first five lines of the data in jpglogsRDD. The return value is a list of strings (in Python) or array of strings (in Scala).</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566079_1547514238","id":"20200120-003633_103234036","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483530"},{"title":"4 - Use take to return the first five lines of the data in jpglogsRDD","text":"%pyspark\n\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566080_-1679413412","id":"20200120-003630_1845260069","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483531"},{"title":"5 - Loop through and display the strings returned by take","text":"%pyspark\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566080_229482378","id":"20200120-003817_1470333727","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483532"},{"text":"%md\nUse the map transformation to define a new RDD. Start with a simple map function that returns the length of each line in the log file. This results in an \nRDD of integers.","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Use the map transformation to define a new RDD. Start with a simple map function that returns the length of each line in the log file. This results in an\n<br  />RDD of integers.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566080_-648277270","id":"20200120-004513_1072563827","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483533"},{"title":"6 - Use the map transformation to define a new RDD","text":"%pyspark\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566080_-1092959109","id":"20200120-003816_106556924","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483534"},{"title":"7 - Loop through and display the first five elements (integers) in the RDD","text":"%pyspark\n\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566081_1518339195","id":"20200120-005134_1951982341","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483535"},{"text":"%md\nCalculating line lengths is not very useful. Instead, try mapping each string in logsRDD by splitting the strings based on spaces. The result will be an RDD \nin which each element is a list of strings (in Python) or an array of strings (in Scala). Each string represents a “field” in the weblog line.","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Calculating line lengths is not very useful. Instead, try mapping each string in logsRDD by splitting the strings based on spaces. The result will be an RDD\n<br  />in which each element is a list of strings (in Python) or an array of strings (in Scala). Each string represents a “field” in the weblog line.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566081_-1223056265","id":"20200120-005426_237657710","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483536"},{"title":"8 - Create an RDD with all the fields in the weblogs","text":"%pyspark\n\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566081_187908978","id":"20200120-005423_362634952","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483537"},{"text":"%md\nReturn the first five elements of lineFieldsRDD. The result will be a list of lists of strings (in Python) or an array of arrays of strings (in Scala).","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Return the first five elements of lineFieldsRDD. The result will be a list of lists of strings (in Python) or an array of arrays of strings (in Scala).</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566081_-1783042194","id":"20200120-011118_1388715961","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483538"},{"title":"9 - Return the first five elements of lineFieldsRDD","text":"%pyspark\n\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566081_1345820197","id":"20200120-011116_592343431","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483539"},{"text":"%md\nDisplay the contents of the return from take. \nUnlike in examples above, which returned collections of simple values (strings and ints), this time you have a set of compound values (arrays or lists \ncontaining strings). Therefore, to display them properly, you will need to loop through the arrays/lists in lineFields, and then loop through each string \nin the array/list. To make it easier to read the output, use ------- to separate each set of field values. If you choose to copy and paste the Pyspark code \nbelow, it may not automatically indent properly; be sure the indentation is correct before executing the command.\n\n```pyspark\nfor fields in lineFields: \n    print \"-------\"\n    for field in fields: print field\n```","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Display the contents of the return from take.\n<br  />Unlike in examples above, which returned collections of simple values (strings and ints), this time you have a set of compound values (arrays or lists\n<br  />containing strings). Therefore, to display them properly, you will need to loop through the arrays/lists in lineFields, and then loop through each string\n<br  />in the array/list. To make it easier to read the output, use &mdash;&mdash;- to separate each set of field values. If you choose to copy and paste the Pyspark code\n<br  />below, it may not automatically indent properly; be sure the indentation is correct before executing the command.</p>\n<pre><code class=\"pyspark\">for fields in lineFields: \n    print \"-------\"\n    for field in fields: print field\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1617197566082_-105445312","id":"20200120-011443_2110736945","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483540"},{"title":"10  - Display the contents of the return from take","text":"%pyspark\n\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566082_-15054937","id":"20200120-011952_1094164574","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483541"},{"text":"%md\nNow that you know how map works, create a new RDD containing just the IP addresses from each line in the log file. (The IP address is the first space-delimited \nfield in each line.)","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now that you know how map works, create a new RDD containing just the IP addresses from each line in the log file. (The IP address is the first space-delimited\n<br  />field in each line.)</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566082_586705542","id":"20200120-012127_564830964","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483542"},{"title":"11 - Create a new RDD containing just the IP addresses from each line in the log file","text":"%pyspark\n\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566083_-1301414367","id":"20200120-012107_1817300829","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483543"},{"title":"12 - Finally, save the list of IP addresses as a text file","text":"%pyspark\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566083_-1091294093","id":"20200120-014121_1097860708","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483544"},{"text":"%md\n**Note:** If you re-run this command, you will not be able to save to the same directory because it already exists. Be sure to delete the directory in HDFS \nbefore saving again.","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><strong>Note:</strong> If you re-run this command, you will not be able to save to the same directory because it already exists. Be sure to delete the directory in HDFS\n<br  />before saving again.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566083_-1072404556","id":"20200120-014229_413886056","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483545"},{"text":"%md\nList the contents of the /devsh_loudacre/iplist HDFS folder. Review the contents of one of the files to confirm that they were created correctly.","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>List the contents of the /devsh_loudacre/iplist HDFS folder. Review the contents of one of the files to confirm that they were created correctly.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566084_-1446684794","id":"20200120-014333_1539770074","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483546"},{"title":"13 - Confirm the files were created correctly","text":"%sh\n\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566084_-620048496","id":"20200120-014756_280265899","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483547"},{"text":"%md\n### Map Weblog Entries to IP Address/User ID Pairs\n\nUse RDD transformations to create a dataset consisting of the IP address and corresponding user ID for each request for an HTML file. (Filter for files with \nthe .html extension; disregard requests for other file types.) The user ID is the third field in each log file line. Save the data into a comma-separated text \nfile in the directory /devsh_loudacre/userips_csv. Make sure the data is saved in the form of comma-separated strings:\n```pyspark\n165.32.101.206,8\n100.219.90.44,102\n182.4.148.56,173 \n246.241.6.175,45395 \n175.223.172.207,4115\n...\n```","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Map Weblog Entries to IP Address/User ID Pairs</h3>\n<p>Use RDD transformations to create a dataset consisting of the IP address and corresponding user ID for each request for an HTML file. (Filter for files with\n<br  />the .html extension; disregard requests for other file types.) The user ID is the third field in each log file line. Save the data into a comma-separated text\n<br  />file in the directory /devsh_loudacre/userips_csv. Make sure the data is saved in the form of comma-separated strings:</p>\n<pre><code class=\"pyspark\">165.32.101.206,8\n100.219.90.44,102\n182.4.148.56,173 \n246.241.6.175,45395 \n175.223.172.207,4115\n...\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1617197566084_-1603715051","id":"20200120-015000_1493350475","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483548"},{"title":"14 - Create a dataset consisting of the IP address and corresponding user ID for each request for an HTML file","text":"%pyspark\n\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566084_438880087","id":"20200120-015332_367658291","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483549"},{"text":"%md\nNow that the data is in CSV format, it can easily be used by Spark SQL. ","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now that the data is in CSV format, it can easily be used by Spark SQL.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566085_226180634","id":"20200120-020340_581649922","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483550"},{"title":"15 - Load the new CSV files in /devsh_loudacre/userips_csv created above into a DataFrame, then view the data and schema","text":"%pyspark\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617197566085_257552181","id":"20200120-020334_593860337","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483551"},{"text":"%md\n# Result\n**You have now:** \n\n* loaded a simple text file into a Resilient Distributed Dataset (RDD),\n* created an RDD based on Loudacre’s website log data and \n* practiced transforming the data.\n\n---","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Result</h1>\n<p><strong>You have now:</strong></p>\n<ul>\n<li>loaded a simple text file into a Resilient Distributed Dataset (RDD),</li>\n<li>created an RDD based on Loudacre’s website log data and</li>\n<li>practiced transforming the data.</li>\n</ul>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1617197566090_1228212714","id":"20181119-142716_792318228","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483552"},{"text":"%md\n# Solution\n---","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Solution</h1>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1617197566090_863031800","id":"20171113-155535_1769142099","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483553"},{"text":"%md\n### Explore the Loudacre Web Log Files","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Explore the Loudacre Web Log Files</h3>\n"}]},"apps":[],"jobName":"paragraph_1617197566091_41638045","id":"20210123-132811_826159894","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483554"},{"title":"1 - Copy the weblogs directory from the local filesystem to the /devsh_loudacre HDFS directory","text":"%sh\n\nhdfs dfs -rm -r -skipTrash /devsh_loudacre/weblogs\nhdfs dfs -put /home/training/training_materials/devsh/data/weblogs /devsh_loudacre\nhdfs dfs -ls -h /devsh_loudacre/weblogs","user":"anonymous","dateUpdated":"2021-03-31T09:56:19-0700","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"rm: `/devsh_loudacre/weblogs': No such file or directory\nFound 182 items\n-rw-r--r--   3 zeppelin supergroup    509.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-15.log\n-rw-r--r--   3 zeppelin supergroup    472.7 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-16.log\n-rw-r--r--   3 zeppelin supergroup    515.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-17.log\n-rw-r--r--   3 zeppelin supergroup    473.7 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-18.log\n-rw-r--r--   3 zeppelin supergroup    496.6 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-19.log\n-rw-r--r--   3 zeppelin supergroup    480.6 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-20.log\n-rw-r--r--   3 zeppelin supergroup    477.7 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-21.log\n-rw-r--r--   3 zeppelin supergroup    523.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-22.log\n-rw-r--r--   3 zeppelin supergroup    490.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-23.log\n-rw-r--r--   3 zeppelin supergroup    477.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-24.log\n-rw-r--r--   3 zeppelin supergroup    476.4 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-25.log\n-rw-r--r--   3 zeppelin supergroup    510.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-26.log\n-rw-r--r--   3 zeppelin supergroup    494.3 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-27.log\n-rw-r--r--   3 zeppelin supergroup    481.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-28.log\n-rw-r--r--   3 zeppelin supergroup    470.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-29.log\n-rw-r--r--   3 zeppelin supergroup    513.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-09-30.log\n-rw-r--r--   3 zeppelin supergroup    473.6 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-01.log\n-rw-r--r--   3 zeppelin supergroup    515.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-02.log\n-rw-r--r--   3 zeppelin supergroup    509.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-03.log\n-rw-r--r--   3 zeppelin supergroup    487.3 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-04.log\n-rw-r--r--   3 zeppelin supergroup    498.5 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-05.log\n-rw-r--r--   3 zeppelin supergroup    478.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-06.log\n-rw-r--r--   3 zeppelin supergroup    478.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-07.log\n-rw-r--r--   3 zeppelin supergroup    511.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-08.log\n-rw-r--r--   3 zeppelin supergroup    517.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-09.log\n-rw-r--r--   3 zeppelin supergroup    509.4 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-10.log\n-rw-r--r--   3 zeppelin supergroup    511.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-11.log\n-rw-r--r--   3 zeppelin supergroup    505.6 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-12.log\n-rw-r--r--   3 zeppelin supergroup    510.6 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-13.log\n-rw-r--r--   3 zeppelin supergroup    485.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-14.log\n-rw-r--r--   3 zeppelin supergroup    483.6 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-15.log\n-rw-r--r--   3 zeppelin supergroup    508.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-16.log\n-rw-r--r--   3 zeppelin supergroup    489.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-17.log\n-rw-r--r--   3 zeppelin supergroup    489.4 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-18.log\n-rw-r--r--   3 zeppelin supergroup    515.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-19.log\n-rw-r--r--   3 zeppelin supergroup    506.4 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-20.log\n-rw-r--r--   3 zeppelin supergroup    500.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-21.log\n-rw-r--r--   3 zeppelin supergroup    505.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-22.log\n-rw-r--r--   3 zeppelin supergroup    480.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-23.log\n-rw-r--r--   3 zeppelin supergroup    480.5 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-24.log\n-rw-r--r--   3 zeppelin supergroup    520.7 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-25.log\n-rw-r--r--   3 zeppelin supergroup    492.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-26.log\n-rw-r--r--   3 zeppelin supergroup    491.6 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-27.log\n-rw-r--r--   3 zeppelin supergroup    511.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-28.log\n-rw-r--r--   3 zeppelin supergroup    498.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-29.log\n-rw-r--r--   3 zeppelin supergroup    510.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-30.log\n-rw-r--r--   3 zeppelin supergroup    512.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-10-31.log\n-rw-r--r--   3 zeppelin supergroup    946.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-01.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-02.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-03.log\n-rw-r--r--   3 zeppelin supergroup    933.7 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-04.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-05.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-06.log\n-rw-r--r--   3 zeppelin supergroup   1013.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-07.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-08.log\n-rw-r--r--   3 zeppelin supergroup    947.3 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-09.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-10.log\n-rw-r--r--   3 zeppelin supergroup    954.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-11.log\n-rw-r--r--   3 zeppelin supergroup    947.4 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-12.log\n-rw-r--r--   3 zeppelin supergroup   1014.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-13.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-14.log\n-rw-r--r--   3 zeppelin supergroup    959.4 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-15.log\n-rw-r--r--   3 zeppelin supergroup    986.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-16.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-17.log\n-rw-r--r--   3 zeppelin supergroup    955.4 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-18.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-19.log\n-rw-r--r--   3 zeppelin supergroup    985.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-20.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-21.log\n-rw-r--r--   3 zeppelin supergroup    952.4 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-22.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-23.log\n-rw-r--r--   3 zeppelin supergroup   1023.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-24.log\n-rw-r--r--   3 zeppelin supergroup    951.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-25.log\n-rw-r--r--   3 zeppelin supergroup    939.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-26.log\n-rw-r--r--   3 zeppelin supergroup    953.4 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-27.log\n-rw-r--r--   3 zeppelin supergroup    953.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-28.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-29.log\n-rw-r--r--   3 zeppelin supergroup    983.3 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-11-30.log\n-rw-r--r--   3 zeppelin supergroup    991.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-01.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-02.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-03.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-04.log\n-rw-r--r--   3 zeppelin supergroup   1004.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-05.log\n-rw-r--r--   3 zeppelin supergroup   1007.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-06.log\n-rw-r--r--   3 zeppelin supergroup    994.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-07.log\n-rw-r--r--   3 zeppelin supergroup   1015.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-08.log\n-rw-r--r--   3 zeppelin supergroup      1.1 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-09.log\n-rw-r--r--   3 zeppelin supergroup    985.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-10.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-11.log\n-rw-r--r--   3 zeppelin supergroup   1006.5 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-12.log\n-rw-r--r--   3 zeppelin supergroup   1004.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-13.log\n-rw-r--r--   3 zeppelin supergroup    962.7 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-14.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-15.log\n-rw-r--r--   3 zeppelin supergroup    981.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-16.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-17.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-18.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-19.log\n-rw-r--r--   3 zeppelin supergroup      1.1 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-20.log\n-rw-r--r--   3 zeppelin supergroup    963.6 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-21.log\n-rw-r--r--   3 zeppelin supergroup   1021.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-22.log\n-rw-r--r--   3 zeppelin supergroup    967.3 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-23.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-24.log\n-rw-r--r--   3 zeppelin supergroup    957.5 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-25.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-26.log\n-rw-r--r--   3 zeppelin supergroup    993.3 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-27.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-28.log\n-rw-r--r--   3 zeppelin supergroup    998.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-29.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-30.log\n-rw-r--r--   3 zeppelin supergroup    969.3 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2013-12-31.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-01.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-02.log\n-rw-r--r--   3 zeppelin supergroup    959.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-03.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-04.log\n-rw-r--r--   3 zeppelin supergroup    988.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-05.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-06.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-07.log\n-rw-r--r--   3 zeppelin supergroup   1013.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-08.log\n-rw-r--r--   3 zeppelin supergroup   1008.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-09.log\n-rw-r--r--   3 zeppelin supergroup    954.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-10.log\n-rw-r--r--   3 zeppelin supergroup    970.4 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-11.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-12.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-13.log\n-rw-r--r--   3 zeppelin supergroup    977.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-14.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-15.log\n-rw-r--r--   3 zeppelin supergroup    973.5 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-16.log\n-rw-r--r--   3 zeppelin supergroup   1020.3 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-17.log\n-rw-r--r--   3 zeppelin supergroup    950.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-18.log\n-rw-r--r--   3 zeppelin supergroup    952.3 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-19.log\n-rw-r--r--   3 zeppelin supergroup    997.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-20.log\n-rw-r--r--   3 zeppelin supergroup    987.7 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-21.log\n-rw-r--r--   3 zeppelin supergroup      1.1 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-22.log\n-rw-r--r--   3 zeppelin supergroup    953.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-23.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-24.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-25.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-26.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-27.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-28.log\n-rw-r--r--   3 zeppelin supergroup    989.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-29.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-30.log\n-rw-r--r--   3 zeppelin supergroup      1.1 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-01-31.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-01.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-02.log\n-rw-r--r--   3 zeppelin supergroup    979.5 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-03.log\n-rw-r--r--   3 zeppelin supergroup    993.4 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-04.log\n-rw-r--r--   3 zeppelin supergroup    982.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-05.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-06.log\n-rw-r--r--   3 zeppelin supergroup    972.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-07.log\n-rw-r--r--   3 zeppelin supergroup   1011.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-08.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-09.log\n-rw-r--r--   3 zeppelin supergroup   1019.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-10.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-11.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-12.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-13.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-14.log\n-rw-r--r--   3 zeppelin supergroup    986.9 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-15.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-16.log\n-rw-r--r--   3 zeppelin supergroup    971.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-17.log\n-rw-r--r--   3 zeppelin supergroup    996.0 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-18.log\n-rw-r--r--   3 zeppelin supergroup    969.5 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-19.log\n-rw-r--r--   3 zeppelin supergroup    969.5 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-20.log\n-rw-r--r--   3 zeppelin supergroup   1000.6 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-21.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-22.log\n-rw-r--r--   3 zeppelin supergroup    994.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-23.log\n-rw-r--r--   3 zeppelin supergroup      1.1 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-24.log\n-rw-r--r--   3 zeppelin supergroup    994.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-25.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-26.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-27.log\n-rw-r--r--   3 zeppelin supergroup    952.5 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-02-28.log\n-rw-r--r--   3 zeppelin supergroup    981.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-01.log\n-rw-r--r--   3 zeppelin supergroup    982.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-02.log\n-rw-r--r--   3 zeppelin supergroup    958.3 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-03.log\n-rw-r--r--   3 zeppelin supergroup    945.3 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-04.log\n-rw-r--r--   3 zeppelin supergroup    983.4 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-05.log\n-rw-r--r--   3 zeppelin supergroup    991.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-06.log\n-rw-r--r--   3 zeppelin supergroup      1.1 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-07.log\n-rw-r--r--   3 zeppelin supergroup    978.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-08.log\n-rw-r--r--   3 zeppelin supergroup    972.2 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-09.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-10.log\n-rw-r--r--   3 zeppelin supergroup   1014.3 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-11.log\n-rw-r--r--   3 zeppelin supergroup   1022.6 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-12.log\n-rw-r--r--   3 zeppelin supergroup    974.1 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-13.log\n-rw-r--r--   3 zeppelin supergroup    970.8 K 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-14.log\n-rw-r--r--   3 zeppelin supergroup      1.0 M 2021-03-31 09:56 /devsh_loudacre/weblogs/2014-03-15.log\n"}]},"apps":[],"jobName":"paragraph_1617197566091_-64672775","id":"20200120-002914_1069892138","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T09:56:19-0700","dateFinished":"2021-03-31T09:56:29-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483555"},{"title":"","text":"%sh\n\nhdfs dfs -head /devsh_loudacre/weblogs/2013-09-15.log","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"3.94.78.5 - 69827 [15/Sep/2013:23:58:36 +0100] \"GET /KBDOC-00033.html HTTP/1.0\" 200 14417 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser iFruit 1\"\n3.94.78.5 - 69827 [15/Sep/2013:23:58:36 +0100] \"GET /theme.css HTTP/1.0\" 200 3576 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser iFruit 1\"\n19.38.140.62 - 21475 [15/Sep/2013:23:58:34 +0100] \"GET /KBDOC-00277.html HTTP/1.0\" 200 15517 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser Ronin S1\"\n19.38.140.62 - 21475 [15/Sep/2013:23:58:34 +0100] \"GET /theme.css HTTP/1.0\" 200 13353 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser Ronin S1\"\n129.133.56.105 - 2489 [15/Sep/2013:23:58:34 +0100] \"GET /KBDOC-00033.html HTTP/1.0\" 200 10590 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser Sorrento F00L\"\n129.133.56.105 - 2489 [15/Sep/2013:23:58:34 +0100] \"GET /theme.css HTTP/1.0\" 200 12295 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser Sorrento F00L\"\n217.150.149.167 - 4712 [15/Sep/2013:23:56:06 +0100] \"GET /ronin_s4_sales.html HTTP/1.0\" 200 845 \"http://www.lo"}]},"apps":[],"jobName":"paragraph_1617197566091_375007756","id":"20210121-193418_1702996012","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483556"},{"text":"%md\nIn this section you will be using data in data/weblogs. Review one of the .log files in the directory. Note the format of the lines and the positions of \nthe IP address, the user ID and the request:\n```pyspark\n234.206.18.239 - 8495 [15/Mar/2014:23:59:30 +0100] \"GET /KBDOC-00082.html HTTP/1.0\" 200 9054 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser Titanic 2200\"\n```\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In this section you will be using data in data/weblogs. Review one of the .log files in the directory. Note the format of the lines and the positions of\n<br  />the IP address, the user ID and the request:</p>\n<pre><code class=\"pyspark\">234.206.18.239 - 8495 [15/Mar/2014:23:59:30 +0100] \"GET /KBDOC-00082.html HTTP/1.0\" 200 9054 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser Titanic 2200\"\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1617197566092_117901628","id":"20210121-193342_534743466","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483557"},{"title":"2 - Create an RDD from the uploaded web logs data files in the /devsh_loudacre/weblogs/ directory in HDFS","text":"%pyspark\n\nlogsRDD = sc.textFile(\"/devsh_loudacre/weblogs/\")","user":"anonymous","dateUpdated":"2021-03-31T10:01:12-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1617197566092_-1491177018","id":"20200120-003233_234329874","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:01:12-0700","dateFinished":"2021-03-31T10:01:13-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483558"},{"text":"%md\n#### Loading a RDD\nAn RDD is a collection of row objects. The .textFile function pulls in the data row by row. Each row ends with the delimiter of a new line, \\n.\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Loading a RDD</h4>\n<p>An RDD is a collection of row objects. The .textFile function pulls in the data row by row. Each row ends with the delimiter of a new line, \\n.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566092_2130164954","id":"20210129-191710_664023642","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483559"},{"title":"3 - Create an RDD containing only lines that are requests for JPG files","text":"%pyspark\n\njpglogsRDD = logsRDD.filter(lambda line: \".jpg\" in line)","user":"anonymous","dateUpdated":"2021-03-31T10:06:36-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1617197566092_708285037","id":"20200120-003530_1847608903","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:06:36-0700","dateFinished":"2021-03-31T10:06:37-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483560"},{"text":"%md\nCreate an RDD containing only lines that are requests for JPG files. Use the filter operation with a transformation function that takes a string RDD element \nand returns a boolean value.\n\nThe `filter` function matches records to the input.","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Create an RDD containing only lines that are requests for JPG files. Use the filter operation with a transformation function that takes a string RDD element\n<br  />and returns a boolean value.</p>\n<p>The <code>filter</code> function matches records to the input.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566093_194558491","id":"20210121-193603_2086199572","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483561"},{"text":"%md\n#### Lambda functions\nThis requires the use of a Python Lambda function. A Lambda function is a small anonymous function. It can take any number of arguments, but can only have \none expression.\n\nsyntax \n`lambda arguments: expression`\nexample\n`x = lambda a: a + 10`\n`print(x(5))`\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Lambda functions</h4>\n<p>This requires the use of a Python Lambda function. A Lambda function is a small anonymous function. It can take any number of arguments, but can only have\n<br  />one expression.</p>\n<p>syntax\n<br  /><code>lambda arguments: expression</code>\n<br  />example\n<br  /><code>x = lambda a: a + 10</code>\n<br  /><code>print(x(5))</code></p>\n"}]},"apps":[],"jobName":"paragraph_1617197566093_-2097654265","id":"20210129-191915_423502015","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483562"},{"title":"4 - Use take to return the first five lines of the data in jpglogsRDD","text":"%pyspark\n\nsc.setJobGroup(\"Transforming data with RDDs\",\"Use take to return the first five lines of the data in jpglogsRDD\")\njpgLines = jpglogsRDD.take(5)","user":"anonymous","dateUpdated":"2021-03-31T10:06:58-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1617197566093_-475116519","id":"20200120-003721_957960497","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:06:58-0700","dateFinished":"2021-03-31T10:07:01-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483563"},{"text":"%md\n#### Return data types from .take\nUse the `take` function to return the first five lines of the data in jpglogsRDD. The return data type is a list of strings (in Python) or array of strings \n(in Scala).\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Return data types from .take</h4>\n<p>Use the <code>take</code> function to return the first five lines of the data in jpglogsRDD. The return data type is a list of strings (in Python) or array of strings\n<br  />(in Scala).</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566093_371305817","id":"20210121-194214_1623249747","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483564"},{"title":"5 - Loop through and display the strings returned by take","text":"%pyspark\n\nfor line in jpgLines: print(line)","user":"anonymous","dateUpdated":"2021-03-31T10:07:13-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"217.150.149.167 - 4712 [15/Sep/2013:23:56:06 +0100] \"GET /ronin_s4.jpg HTTP/1.0\" 200 5552 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser MeeToo 1.0\"\n104.184.210.93 - 28402 [15/Sep/2013:23:42:53 +0100] \"GET /titanic_2200.jpg HTTP/1.0\" 200 19466 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser MeeToo 2.0\"\n37.91.137.134 - 36171 [15/Sep/2013:23:39:33 +0100] \"GET /ronin_novelty_note_3.jpg HTTP/1.0\" 200 7432 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser iFruit 3\"\n177.43.223.203 - 90653 [15/Sep/2013:23:31:17 +0100] \"GET /ifruit_3.jpg HTTP/1.0\" 200 19578 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser Sorrento F31L\"\n19.250.65.76 - 44388 [15/Sep/2013:23:31:10 +0100] \"GET /sorrento_f24l.jpg HTTP/1.0\" 200 5730 \"http://www.loudacre.com\"  \"Loudacre Mobile Browser iFruit 3A\""}]},"apps":[],"jobName":"paragraph_1617197566094_1960861123","id":"20200120-003836_1034138881","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:07:13-0700","dateFinished":"2021-03-31T10:07:14-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483565"},{"text":"%md\nUse the Python foreach loop to loop through the records.\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Use the Python foreach loop to loop through the records.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566094_992092912","id":"20210121-201933_823043164","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483566"},{"title":"6 - Use the map transformation to define a new RDD","text":"%pyspark\n\nlineLengthsRDD = logsRDD.map(lambda line: len(line))","user":"anonymous","dateUpdated":"2021-03-31T10:11:21-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1617197566098_-1718954815","id":"20200120-004722_1690655549","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:11:22-0700","dateFinished":"2021-03-31T10:11:23-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483567"},{"text":"%md\n#### The .map function for anonymous functions\nPython Spark `map` function allows developers to reach each element of the RDD and perform some processing on each record. Using the `map` function \ntransformation defines a new RDD. Start with a simple map function that returns the length of each line in the log file. This results in an RDD of integers.\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>The .map function for anonymous functions</h4>\n<p>Python Spark <code>map</code> function allows developers to reach each element of the RDD and perform some processing on each record. Using the <code>map</code> function\n<br  />transformation defines a new RDD. Start with a simple map function that returns the length of each line in the log file. This results in an RDD of integers.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566098_-729106347","id":"20210121-194339_1817126930","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483568"},{"title":"7 - Loop through and display the first five elements (integers) in the RDD","text":"%pyspark\n\nsc.setJobGroup(\"Transforming data with RDDs\",\"Loop through and display the first five elements (integers) in the RDD\")\nfor line in lineLengthsRDD.take(5): print(line)","user":"anonymous","dateUpdated":"2021-03-31T10:12:16-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"151\n143\n154\n147\n160"}]},"apps":[],"jobName":"paragraph_1617197566098_1674700446","id":"20200120-005150_2113187186","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:12:16-0700","dateFinished":"2021-03-31T10:12:17-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483569"},{"title":"8 - Create an RDD with all the fields in the weblogs","text":"%pyspark\n\nlineFieldsRDD = logsRDD.map(lambda line: line.split(' '))","user":"anonymous","dateUpdated":"2021-03-31T10:16:57-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1617197566098_884966303","id":"20200120-005912_750669124","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:16:57-0700","dateFinished":"2021-03-31T10:16:58-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483570"},{"text":"%md\n#### Setting field delimiters\nCalculating line lengths is not very useful. Instead, try mapping each string in logsRDD by splitting the strings based on spaces.\n\nUse the `map` function and a Lambda to pass each line to the `split` function. Split on a space ' '.\n\nThe result will be an RDD in which each element is a list of strings (in Python) or an array of strings (in Scala). Each string represents a “field” in the \nweblog line. This is an important step in transforming unstructured data into structured data.\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Setting field delimiters</h4>\n<p>Calculating line lengths is not very useful. Instead, try mapping each string in logsRDD by splitting the strings based on spaces.</p>\n<p>Use the <code>map</code> function and a Lambda to pass each line to the <code>split</code> function. Split on a space ' '.</p>\n<p>The result will be an RDD in which each element is a list of strings (in Python) or an array of strings (in Scala). Each string represents a “field” in the\n<br  />weblog line. This is an important step in transforming unstructured data into structured data.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566099_50587698","id":"20210121-194610_1138495347","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483571"},{"title":"9 - Return the first five elements of lineFieldsRDD","text":"%pyspark\n\nsc.setJobGroup(\"Transforming data with RDDs\",\"Return the first five elements of lineFieldsRDD\")\nlineFields = lineFieldsRDD.take(5)","user":"anonymous","dateUpdated":"2021-03-31T10:17:00-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1617197566099_1778175871","id":"20200120-011220_1085103604","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:17:00-0700","dateFinished":"2021-03-31T10:17:01-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483572"},{"text":"%pyspark\nlineFields = lineFieldsRDD.take(3)\n#lineFields = lineFieldsRDD.collect()\n\nfor field in lineFields: print(field)","user":"anonymous","dateUpdated":"2021-03-31T10:17:26-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[u'3.94.78.5', u'-', u'69827', u'[15/Sep/2013:23:58:36', u'+0100]', u'\"GET', u'/KBDOC-00033.html', u'HTTP/1.0\"', u'200', u'14417', u'\"http://www.loudacre.com\"', u'', u'\"Loudacre', u'Mobile', u'Browser', u'iFruit', u'1\"']\n[u'3.94.78.5', u'-', u'69827', u'[15/Sep/2013:23:58:36', u'+0100]', u'\"GET', u'/theme.css', u'HTTP/1.0\"', u'200', u'3576', u'\"http://www.loudacre.com\"', u'', u'\"Loudacre', u'Mobile', u'Browser', u'iFruit', u'1\"']\n[u'19.38.140.62', u'-', u'21475', u'[15/Sep/2013:23:58:34', u'+0100]', u'\"GET', u'/KBDOC-00277.html', u'HTTP/1.0\"', u'200', u'15517', u'\"http://www.loudacre.com\"', u'', u'\"Loudacre', u'Mobile', u'Browser', u'Ronin', u'S1\"']"}]},"apps":[],"jobName":"paragraph_1617197566099_-1544477145","id":"20210203-100700_1919759889","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:17:27-0700","dateFinished":"2021-03-31T10:17:28-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483573"},{"text":"%md\nUse the `take` function to return the first five elements of lineFieldsRDD. The result will be a list of lists of strings (in Python) or an array of arrays \nof strings (in Scala).\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Use the <code>take</code> function to return the first five elements of lineFieldsRDD. The result will be a list of lists of strings (in Python) or an array of arrays\n<br  />of strings (in Scala).</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566099_-1058437655","id":"20210121-194829_889794186","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483574"},{"title":"10  - Display the contents of the return from take","text":"%pyspark\n\nfor fields in lineFields: \n    print(\"-------\")\n    for field in fields: print(field)","user":"anonymous","dateUpdated":"2021-03-31T10:21:47-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-------\n3.94.78.5\n-\n69827\n[15/Sep/2013:23:58:36\n+0100]\n\"GET\n/KBDOC-00033.html\nHTTP/1.0\"\n200\n14417\n\"http://www.loudacre.com\"\n\n\"Loudacre\nMobile\nBrowser\niFruit\n1\"\n-------\n3.94.78.5\n-\n69827\n[15/Sep/2013:23:58:36\n+0100]\n\"GET\n/theme.css\nHTTP/1.0\"\n200\n3576\n\"http://www.loudacre.com\"\n\n\"Loudacre\nMobile\nBrowser\niFruit\n1\"\n-------\n19.38.140.62\n-\n21475\n[15/Sep/2013:23:58:34\n+0100]\n\"GET\n/KBDOC-00277.html\nHTTP/1.0\"\n200\n15517\n\"http://www.loudacre.com\"\n\n\"Loudacre\nMobile\nBrowser\nRonin\nS1\""}]},"apps":[],"jobName":"paragraph_1617197566100_2079639527","id":"20200120-011438_1958987337","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:21:47-0700","dateFinished":"2021-03-31T10:21:48-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483575"},{"text":"%md\n#### Displaying RDD as collections\nDisplay the contents of the return from `take`. \nUnlike earlier examples, which returned collections of simple values (strings and ints), this time you have a set of compound values (arrays for Scala or \nlists for Python containing strings). Therefore, to display them properly, you will need to loop through the arrays/lists in `lineFields`, and then loop through each string in the array/list.\nTo make it easier to read the output, use ------- to separate each set of field values.\nIf you choose to copy and paste the Pyspark code below, it may not automatically indent properly; be sure the indentation is correct before executing the command.\n\n```pyspark\nfor fields in lineFields: \n    print \"-------\"\n    for field in fields: print field\n```\n","user":"anonymous","dateUpdated":"2021-03-31T06:42:00-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Displaying RDD as collections</h4>\n<p>Display the contents of the return from <code>take</code>.\n<br  />Unlike earlier examples, which returned collections of simple values (strings and ints), this time you have a set of compound values (arrays for Scala or lists for Python containing strings).\n<br  />Therefore, to display them properly, you will need to loop through the arrays/lists in <code>lineFields</code>, and then loop through each string in the array/list.\n<br  />To make it easier to read the output, use &mdash;&mdash;- to separate each set of field values.\n<br  />If you choose to copy and paste the Pyspark code below, it may not automatically indent properly; be sure the indentation is correct before executing the command.</p>\n<pre><code class=\"pyspark\">for fields in lineFields: \n    print \"-------\"\n    for field in fields: print field\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1617197566100_-1131673455","id":"20210121-194936_1714975894","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483576"},{"title":"11 - Create a new RDD containing just the IP addresses from each line in the log file","text":"%pyspark\n\nipsRDD = logsRDD.map(lambda line: line.split(' ')[0])\nsc.setJobGroup(\"Transforming data with RDDs\",\"Create a new RDD containing just the IP addresses from each line in the log file\")\nfor ip in ipsRDD.take(5): print(ip)","user":"anonymous","dateUpdated":"2021-03-31T10:26:12-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"3.94.78.5\n3.94.78.5\n19.38.140.62\n19.38.140.62\n129.133.56.105"}]},"apps":[],"jobName":"paragraph_1617197566100_2097658003","id":"20200120-013923_1000697022","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:26:12-0700","dateFinished":"2021-03-31T10:26:13-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483577"},{"text":"%md\nNow that you know how map works, create a new RDD containing just the IP addresses from each line in the log file. The IP address is the first space-delimited \nfield in each line. This will require `split` and an index position of 0 [0]. `line.split(' ')[0]`\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now that you know how map works, create a new RDD containing just the IP addresses from each line in the log file. The IP address is the first space-delimited\n<br  />field in each line. This will require <code>split</code> and an index position of 0 [0]. <code>line.split(' ')[0]</code></p>\n"}]},"apps":[],"jobName":"paragraph_1617197566100_897759856","id":"20210121-195122_1281428554","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483578"},{"title":"12 - Finally, save the list of IP addresses as a text file","text":"%pyspark\n\nsc.setJobGroup(\"Transforming data with RDDs\",\"Save the list of IP addresses as a text file\")\nipsRDD.saveAsTextFile(\"/devsh_loudacre/iplist\")","user":"anonymous","dateUpdated":"2021-03-31T10:27:44-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1617197566101_-103825393","id":"20200120-014137_1413343527","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:27:45-0700","dateFinished":"2021-03-31T10:28:02-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483579"},{"text":"%md\n***Note***\n* If you re-run this command, you will not be able to save to the same directory because it already exists. \n* Remember you can not overwrite HDFS data.\n* Be sure to delete the directory in HDFS before saving again.\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p><strong><em>Note</em></strong></p>\n<ul>\n<li>If you re-run this command, you will not be able to save to the same directory because it already exists.</li>\n<li>Remember you can not overwrite HDFS data.</li>\n<li>Be sure to delete the directory in HDFS before saving again.</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1617197566101_-1400222014","id":"20210121-195346_120574668","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483580"},{"title":"13 - Confirm the files were created correctly","text":"%sh\n\nhdfs dfs -ls /devsh_loudacre/iplist","user":"anonymous","dateUpdated":"2021-03-31T10:30:31-0700","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 183 items\n-rw-r--r--   3 livy supergroup          0 2021-03-31 10:28 /devsh_loudacre/iplist/_SUCCESS\n-rw-r--r--   3 livy supergroup      49265 2021-03-31 10:27 /devsh_loudacre/iplist/part-00000\n-rw-r--r--   3 livy supergroup      45854 2021-03-31 10:27 /devsh_loudacre/iplist/part-00001\n-rw-r--r--   3 livy supergroup      50031 2021-03-31 10:27 /devsh_loudacre/iplist/part-00002\n-rw-r--r--   3 livy supergroup      45898 2021-03-31 10:27 /devsh_loudacre/iplist/part-00003\n-rw-r--r--   3 livy supergroup      48070 2021-03-31 10:27 /devsh_loudacre/iplist/part-00004\n-rw-r--r--   3 livy supergroup      46430 2021-03-31 10:27 /devsh_loudacre/iplist/part-00005\n-rw-r--r--   3 livy supergroup      46177 2021-03-31 10:27 /devsh_loudacre/iplist/part-00006\n-rw-r--r--   3 livy supergroup      50720 2021-03-31 10:27 /devsh_loudacre/iplist/part-00007\n-rw-r--r--   3 livy supergroup      47314 2021-03-31 10:27 /devsh_loudacre/iplist/part-00008\n-rw-r--r--   3 livy supergroup      46282 2021-03-31 10:27 /devsh_loudacre/iplist/part-00009\n-rw-r--r--   3 livy supergroup      45998 2021-03-31 10:27 /devsh_loudacre/iplist/part-00010\n-rw-r--r--   3 livy supergroup      49261 2021-03-31 10:27 /devsh_loudacre/iplist/part-00011\n-rw-r--r--   3 livy supergroup      47918 2021-03-31 10:27 /devsh_loudacre/iplist/part-00012\n-rw-r--r--   3 livy supergroup      46580 2021-03-31 10:27 /devsh_loudacre/iplist/part-00013\n-rw-r--r--   3 livy supergroup      45576 2021-03-31 10:27 /devsh_loudacre/iplist/part-00014\n-rw-r--r--   3 livy supergroup      49698 2021-03-31 10:27 /devsh_loudacre/iplist/part-00015\n-rw-r--r--   3 livy supergroup      45627 2021-03-31 10:27 /devsh_loudacre/iplist/part-00016\n-rw-r--r--   3 livy supergroup      49712 2021-03-31 10:27 /devsh_loudacre/iplist/part-00017\n-rw-r--r--   3 livy supergroup      49193 2021-03-31 10:27 /devsh_loudacre/iplist/part-00018\n-rw-r--r--   3 livy supergroup      47206 2021-03-31 10:27 /devsh_loudacre/iplist/part-00019\n-rw-r--r--   3 livy supergroup      48088 2021-03-31 10:27 /devsh_loudacre/iplist/part-00020\n-rw-r--r--   3 livy supergroup      46346 2021-03-31 10:27 /devsh_loudacre/iplist/part-00021\n-rw-r--r--   3 livy supergroup      46079 2021-03-31 10:27 /devsh_loudacre/iplist/part-00022\n-rw-r--r--   3 livy supergroup      49463 2021-03-31 10:27 /devsh_loudacre/iplist/part-00023\n-rw-r--r--   3 livy supergroup      50071 2021-03-31 10:27 /devsh_loudacre/iplist/part-00024\n-rw-r--r--   3 livy supergroup      49298 2021-03-31 10:27 /devsh_loudacre/iplist/part-00025\n-rw-r--r--   3 livy supergroup      49523 2021-03-31 10:27 /devsh_loudacre/iplist/part-00026\n-rw-r--r--   3 livy supergroup      48979 2021-03-31 10:27 /devsh_loudacre/iplist/part-00027\n-rw-r--r--   3 livy supergroup      49241 2021-03-31 10:27 /devsh_loudacre/iplist/part-00028\n-rw-r--r--   3 livy supergroup      46977 2021-03-31 10:27 /devsh_loudacre/iplist/part-00029\n-rw-r--r--   3 livy supergroup      47085 2021-03-31 10:27 /devsh_loudacre/iplist/part-00030\n-rw-r--r--   3 livy supergroup      49301 2021-03-31 10:27 /devsh_loudacre/iplist/part-00031\n-rw-r--r--   3 livy supergroup      47146 2021-03-31 10:27 /devsh_loudacre/iplist/part-00032\n-rw-r--r--   3 livy supergroup      47439 2021-03-31 10:27 /devsh_loudacre/iplist/part-00033\n-rw-r--r--   3 livy supergroup      49843 2021-03-31 10:27 /devsh_loudacre/iplist/part-00034\n-rw-r--r--   3 livy supergroup      48852 2021-03-31 10:27 /devsh_loudacre/iplist/part-00035\n-rw-r--r--   3 livy supergroup      48425 2021-03-31 10:27 /devsh_loudacre/iplist/part-00036\n-rw-r--r--   3 livy supergroup      48696 2021-03-31 10:27 /devsh_loudacre/iplist/part-00037\n-rw-r--r--   3 livy supergroup      46612 2021-03-31 10:27 /devsh_loudacre/iplist/part-00038\n-rw-r--r--   3 livy supergroup      46337 2021-03-31 10:27 /devsh_loudacre/iplist/part-00039\n-rw-r--r--   3 livy supergroup      50269 2021-03-31 10:27 /devsh_loudacre/iplist/part-00040\n-rw-r--r--   3 livy supergroup      47601 2021-03-31 10:27 /devsh_loudacre/iplist/part-00041\n-rw-r--r--   3 livy supergroup      47440 2021-03-31 10:27 /devsh_loudacre/iplist/part-00042\n-rw-r--r--   3 livy supergroup      49665 2021-03-31 10:27 /devsh_loudacre/iplist/part-00043\n-rw-r--r--   3 livy supergroup      48386 2021-03-31 10:27 /devsh_loudacre/iplist/part-00044\n-rw-r--r--   3 livy supergroup      49493 2021-03-31 10:27 /devsh_loudacre/iplist/part-00045\n-rw-r--r--   3 livy supergroup      49556 2021-03-31 10:27 /devsh_loudacre/iplist/part-00046\n-rw-r--r--   3 livy supergroup      91745 2021-03-31 10:27 /devsh_loudacre/iplist/part-00047\n-rw-r--r--   3 livy supergroup     100562 2021-03-31 10:27 /devsh_loudacre/iplist/part-00048\n-rw-r--r--   3 livy supergroup     103214 2021-03-31 10:27 /devsh_loudacre/iplist/part-00049\n-rw-r--r--   3 livy supergroup      90439 2021-03-31 10:27 /devsh_loudacre/iplist/part-00050\n-rw-r--r--   3 livy supergroup     102547 2021-03-31 10:27 /devsh_loudacre/iplist/part-00051\n-rw-r--r--   3 livy supergroup     101134 2021-03-31 10:27 /devsh_loudacre/iplist/part-00052\n-rw-r--r--   3 livy supergroup      98024 2021-03-31 10:27 /devsh_loudacre/iplist/part-00053\n-rw-r--r--   3 livy supergroup     101902 2021-03-31 10:27 /devsh_loudacre/iplist/part-00054\n-rw-r--r--   3 livy supergroup      91723 2021-03-31 10:27 /devsh_loudacre/iplist/part-00055\n-rw-r--r--   3 livy supergroup     103461 2021-03-31 10:27 /devsh_loudacre/iplist/part-00056\n-rw-r--r--   3 livy supergroup      92419 2021-03-31 10:27 /devsh_loudacre/iplist/part-00057\n-rw-r--r--   3 livy supergroup      91577 2021-03-31 10:27 /devsh_loudacre/iplist/part-00058\n-rw-r--r--   3 livy supergroup      98231 2021-03-31 10:27 /devsh_loudacre/iplist/part-00059\n-rw-r--r--   3 livy supergroup     102310 2021-03-31 10:27 /devsh_loudacre/iplist/part-00060\n-rw-r--r--   3 livy supergroup      92409 2021-03-31 10:27 /devsh_loudacre/iplist/part-00061\n-rw-r--r--   3 livy supergroup      95437 2021-03-31 10:27 /devsh_loudacre/iplist/part-00062\n-rw-r--r--   3 livy supergroup     102634 2021-03-31 10:27 /devsh_loudacre/iplist/part-00063\n-rw-r--r--   3 livy supergroup      92643 2021-03-31 10:27 /devsh_loudacre/iplist/part-00064\n-rw-r--r--   3 livy supergroup     102446 2021-03-31 10:27 /devsh_loudacre/iplist/part-00065\n-rw-r--r--   3 livy supergroup      95294 2021-03-31 10:27 /devsh_loudacre/iplist/part-00066\n-rw-r--r--   3 livy supergroup     100129 2021-03-31 10:27 /devsh_loudacre/iplist/part-00067\n-rw-r--r--   3 livy supergroup      92308 2021-03-31 10:27 /devsh_loudacre/iplist/part-00068\n-rw-r--r--   3 livy supergroup     100248 2021-03-31 10:27 /devsh_loudacre/iplist/part-00069\n-rw-r--r--   3 livy supergroup      99069 2021-03-31 10:27 /devsh_loudacre/iplist/part-00070\n-rw-r--r--   3 livy supergroup      92053 2021-03-31 10:27 /devsh_loudacre/iplist/part-00071\n-rw-r--r--   3 livy supergroup      91013 2021-03-31 10:27 /devsh_loudacre/iplist/part-00072\n-rw-r--r--   3 livy supergroup      92198 2021-03-31 10:27 /devsh_loudacre/iplist/part-00073\n-rw-r--r--   3 livy supergroup      92462 2021-03-31 10:27 /devsh_loudacre/iplist/part-00074\n-rw-r--r--   3 livy supergroup     102237 2021-03-31 10:27 /devsh_loudacre/iplist/part-00075\n-rw-r--r--   3 livy supergroup      95082 2021-03-31 10:27 /devsh_loudacre/iplist/part-00076\n-rw-r--r--   3 livy supergroup      95717 2021-03-31 10:27 /devsh_loudacre/iplist/part-00077\n-rw-r--r--   3 livy supergroup     103245 2021-03-31 10:27 /devsh_loudacre/iplist/part-00078\n-rw-r--r--   3 livy supergroup     100830 2021-03-31 10:27 /devsh_loudacre/iplist/part-00079\n-rw-r--r--   3 livy supergroup     101057 2021-03-31 10:27 /devsh_loudacre/iplist/part-00080\n-rw-r--r--   3 livy supergroup      97285 2021-03-31 10:27 /devsh_loudacre/iplist/part-00081\n-rw-r--r--   3 livy supergroup      97191 2021-03-31 10:27 /devsh_loudacre/iplist/part-00082\n-rw-r--r--   3 livy supergroup      96072 2021-03-31 10:27 /devsh_loudacre/iplist/part-00083\n-rw-r--r--   3 livy supergroup      97886 2021-03-31 10:27 /devsh_loudacre/iplist/part-00084\n-rw-r--r--   3 livy supergroup     103754 2021-03-31 10:27 /devsh_loudacre/iplist/part-00085\n-rw-r--r--   3 livy supergroup      95227 2021-03-31 10:27 /devsh_loudacre/iplist/part-00086\n-rw-r--r--   3 livy supergroup     100376 2021-03-31 10:27 /devsh_loudacre/iplist/part-00087\n-rw-r--r--   3 livy supergroup      97188 2021-03-31 10:27 /devsh_loudacre/iplist/part-00088\n-rw-r--r--   3 livy supergroup      96733 2021-03-31 10:27 /devsh_loudacre/iplist/part-00089\n-rw-r--r--   3 livy supergroup      92797 2021-03-31 10:27 /devsh_loudacre/iplist/part-00090\n-rw-r--r--   3 livy supergroup     101908 2021-03-31 10:27 /devsh_loudacre/iplist/part-00091\n-rw-r--r--   3 livy supergroup      94873 2021-03-31 10:27 /devsh_loudacre/iplist/part-00092\n-rw-r--r--   3 livy supergroup     101805 2021-03-31 10:27 /devsh_loudacre/iplist/part-00093\n-rw-r--r--   3 livy supergroup     100864 2021-03-31 10:27 /devsh_loudacre/iplist/part-00094\n-rw-r--r--   3 livy supergroup      98878 2021-03-31 10:27 /devsh_loudacre/iplist/part-00095\n-rw-r--r--   3 livy supergroup     104473 2021-03-31 10:27 /devsh_loudacre/iplist/part-00096\n-rw-r--r--   3 livy supergroup      92999 2021-03-31 10:27 /devsh_loudacre/iplist/part-00097\n-rw-r--r--   3 livy supergroup      98649 2021-03-31 10:27 /devsh_loudacre/iplist/part-00098\n-rw-r--r--   3 livy supergroup      93301 2021-03-31 10:27 /devsh_loudacre/iplist/part-00099\n-rw-r--r--   3 livy supergroup      99921 2021-03-31 10:27 /devsh_loudacre/iplist/part-00100\n-rw-r--r--   3 livy supergroup      92481 2021-03-31 10:27 /devsh_loudacre/iplist/part-00101\n-rw-r--r--   3 livy supergroup      99558 2021-03-31 10:27 /devsh_loudacre/iplist/part-00102\n-rw-r--r--   3 livy supergroup      95850 2021-03-31 10:27 /devsh_loudacre/iplist/part-00103\n-rw-r--r--   3 livy supergroup     100134 2021-03-31 10:27 /devsh_loudacre/iplist/part-00104\n-rw-r--r--   3 livy supergroup      96173 2021-03-31 10:27 /devsh_loudacre/iplist/part-00105\n-rw-r--r--   3 livy supergroup     101061 2021-03-31 10:27 /devsh_loudacre/iplist/part-00106\n-rw-r--r--   3 livy supergroup      93851 2021-03-31 10:27 /devsh_loudacre/iplist/part-00107\n-rw-r--r--   3 livy supergroup      99674 2021-03-31 10:27 /devsh_loudacre/iplist/part-00108\n-rw-r--r--   3 livy supergroup      99583 2021-03-31 10:27 /devsh_loudacre/iplist/part-00109\n-rw-r--r--   3 livy supergroup      92949 2021-03-31 10:27 /devsh_loudacre/iplist/part-00110\n-rw-r--r--   3 livy supergroup     104021 2021-03-31 10:27 /devsh_loudacre/iplist/part-00111\n-rw-r--r--   3 livy supergroup      95607 2021-03-31 10:27 /devsh_loudacre/iplist/part-00112\n-rw-r--r--   3 livy supergroup     103379 2021-03-31 10:27 /devsh_loudacre/iplist/part-00113\n-rw-r--r--   3 livy supergroup     103024 2021-03-31 10:27 /devsh_loudacre/iplist/part-00114\n-rw-r--r--   3 livy supergroup      97907 2021-03-31 10:27 /devsh_loudacre/iplist/part-00115\n-rw-r--r--   3 livy supergroup      97361 2021-03-31 10:27 /devsh_loudacre/iplist/part-00116\n-rw-r--r--   3 livy supergroup      92279 2021-03-31 10:27 /devsh_loudacre/iplist/part-00117\n-rw-r--r--   3 livy supergroup      93950 2021-03-31 10:27 /devsh_loudacre/iplist/part-00118\n-rw-r--r--   3 livy supergroup     101163 2021-03-31 10:27 /devsh_loudacre/iplist/part-00119\n-rw-r--r--   3 livy supergroup      99148 2021-03-31 10:27 /devsh_loudacre/iplist/part-00120\n-rw-r--r--   3 livy supergroup      94291 2021-03-31 10:27 /devsh_loudacre/iplist/part-00121\n-rw-r--r--   3 livy supergroup      98946 2021-03-31 10:27 /devsh_loudacre/iplist/part-00122\n-rw-r--r--   3 livy supergroup      94118 2021-03-31 10:27 /devsh_loudacre/iplist/part-00123\n-rw-r--r--   3 livy supergroup      98767 2021-03-31 10:27 /devsh_loudacre/iplist/part-00124\n-rw-r--r--   3 livy supergroup      91600 2021-03-31 10:27 /devsh_loudacre/iplist/part-00125\n-rw-r--r--   3 livy supergroup      91759 2021-03-31 10:27 /devsh_loudacre/iplist/part-00126\n-rw-r--r--   3 livy supergroup      96115 2021-03-31 10:27 /devsh_loudacre/iplist/part-00127\n-rw-r--r--   3 livy supergroup      95529 2021-03-31 10:27 /devsh_loudacre/iplist/part-00128\n-rw-r--r--   3 livy supergroup     104761 2021-03-31 10:27 /devsh_loudacre/iplist/part-00129\n-rw-r--r--   3 livy supergroup      92029 2021-03-31 10:27 /devsh_loudacre/iplist/part-00130\n-rw-r--r--   3 livy supergroup     100009 2021-03-31 10:27 /devsh_loudacre/iplist/part-00131\n-rw-r--r--   3 livy supergroup     101173 2021-03-31 10:27 /devsh_loudacre/iplist/part-00132\n-rw-r--r--   3 livy supergroup     100757 2021-03-31 10:27 /devsh_loudacre/iplist/part-00133\n-rw-r--r--   3 livy supergroup     103584 2021-03-31 10:27 /devsh_loudacre/iplist/part-00134\n-rw-r--r--   3 livy supergroup     102016 2021-03-31 10:27 /devsh_loudacre/iplist/part-00135\n-rw-r--r--   3 livy supergroup      95823 2021-03-31 10:27 /devsh_loudacre/iplist/part-00136\n-rw-r--r--   3 livy supergroup     101843 2021-03-31 10:27 /devsh_loudacre/iplist/part-00137\n-rw-r--r--   3 livy supergroup     103870 2021-03-31 10:27 /devsh_loudacre/iplist/part-00138\n-rw-r--r--   3 livy supergroup      99117 2021-03-31 10:27 /devsh_loudacre/iplist/part-00139\n-rw-r--r--   3 livy supergroup     100483 2021-03-31 10:27 /devsh_loudacre/iplist/part-00140\n-rw-r--r--   3 livy supergroup      94534 2021-03-31 10:27 /devsh_loudacre/iplist/part-00141\n-rw-r--r--   3 livy supergroup      95677 2021-03-31 10:27 /devsh_loudacre/iplist/part-00142\n-rw-r--r--   3 livy supergroup      94979 2021-03-31 10:27 /devsh_loudacre/iplist/part-00143\n-rw-r--r--   3 livy supergroup     100460 2021-03-31 10:27 /devsh_loudacre/iplist/part-00144\n-rw-r--r--   3 livy supergroup      93876 2021-03-31 10:27 /devsh_loudacre/iplist/part-00145\n-rw-r--r--   3 livy supergroup      97586 2021-03-31 10:27 /devsh_loudacre/iplist/part-00146\n-rw-r--r--   3 livy supergroup     100628 2021-03-31 10:27 /devsh_loudacre/iplist/part-00147\n-rw-r--r--   3 livy supergroup      98568 2021-03-31 10:27 /devsh_loudacre/iplist/part-00148\n-rw-r--r--   3 livy supergroup      99519 2021-03-31 10:27 /devsh_loudacre/iplist/part-00149\n-rw-r--r--   3 livy supergroup     103016 2021-03-31 10:27 /devsh_loudacre/iplist/part-00150\n-rw-r--r--   3 livy supergroup     103437 2021-03-31 10:27 /devsh_loudacre/iplist/part-00151\n-rw-r--r--   3 livy supergroup     101090 2021-03-31 10:27 /devsh_loudacre/iplist/part-00152\n-rw-r--r--   3 livy supergroup      95280 2021-03-31 10:27 /devsh_loudacre/iplist/part-00153\n-rw-r--r--   3 livy supergroup      99609 2021-03-31 10:27 /devsh_loudacre/iplist/part-00154\n-rw-r--r--   3 livy supergroup      93732 2021-03-31 10:27 /devsh_loudacre/iplist/part-00155\n-rw-r--r--   3 livy supergroup      96405 2021-03-31 10:27 /devsh_loudacre/iplist/part-00156\n-rw-r--r--   3 livy supergroup      93427 2021-03-31 10:27 /devsh_loudacre/iplist/part-00157\n-rw-r--r--   3 livy supergroup      93610 2021-03-31 10:27 /devsh_loudacre/iplist/part-00158\n-rw-r--r--   3 livy supergroup      96596 2021-03-31 10:27 /devsh_loudacre/iplist/part-00159\n-rw-r--r--   3 livy supergroup      99904 2021-03-31 10:27 /devsh_loudacre/iplist/part-00160\n-rw-r--r--   3 livy supergroup      95665 2021-03-31 10:27 /devsh_loudacre/iplist/part-00161\n-rw-r--r--   3 livy supergroup     103957 2021-03-31 10:27 /devsh_loudacre/iplist/part-00162\n-rw-r--r--   3 livy supergroup      96046 2021-03-31 10:27 /devsh_loudacre/iplist/part-00163\n-rw-r--r--   3 livy supergroup     101422 2021-03-31 10:28 /devsh_loudacre/iplist/part-00164\n-rw-r--r--   3 livy supergroup     102844 2021-03-31 10:28 /devsh_loudacre/iplist/part-00165\n-rw-r--r--   3 livy supergroup      92003 2021-03-31 10:28 /devsh_loudacre/iplist/part-00166\n-rw-r--r--   3 livy supergroup      94551 2021-03-31 10:28 /devsh_loudacre/iplist/part-00167\n-rw-r--r--   3 livy supergroup      94874 2021-03-31 10:28 /devsh_loudacre/iplist/part-00168\n-rw-r--r--   3 livy supergroup      92896 2021-03-31 10:28 /devsh_loudacre/iplist/part-00169\n-rw-r--r--   3 livy supergroup      91539 2021-03-31 10:28 /devsh_loudacre/iplist/part-00170\n-rw-r--r--   3 livy supergroup      94904 2021-03-31 10:28 /devsh_loudacre/iplist/part-00171\n-rw-r--r--   3 livy supergroup      95772 2021-03-31 10:28 /devsh_loudacre/iplist/part-00172\n-rw-r--r--   3 livy supergroup     103791 2021-03-31 10:28 /devsh_loudacre/iplist/part-00173\n-rw-r--r--   3 livy supergroup      94535 2021-03-31 10:28 /devsh_loudacre/iplist/part-00174\n-rw-r--r--   3 livy supergroup      93885 2021-03-31 10:28 /devsh_loudacre/iplist/part-00175\n-rw-r--r--   3 livy supergroup     103140 2021-03-31 10:28 /devsh_loudacre/iplist/part-00176\n-rw-r--r--   3 livy supergroup      98011 2021-03-31 10:28 /devsh_loudacre/iplist/part-00177\n-rw-r--r--   3 livy supergroup      98670 2021-03-31 10:28 /devsh_loudacre/iplist/part-00178\n-rw-r--r--   3 livy supergroup      93761 2021-03-31 10:28 /devsh_loudacre/iplist/part-00179\n-rw-r--r--   3 livy supergroup      93654 2021-03-31 10:28 /devsh_loudacre/iplist/part-00180\n-rw-r--r--   3 livy supergroup     101291 2021-03-31 10:28 /devsh_loudacre/iplist/part-00181\n"}]},"apps":[],"jobName":"paragraph_1617197566101_1684165335","id":"20200120-014354_284456265","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:30:32-0700","dateFinished":"2021-03-31T10:30:34-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483581"},{"text":"%sh\n\nhdfs dfs -head /devsh_loudacre/iplist/part-00012","user":"anonymous","dateUpdated":"2021-03-31T10:30:44-0700","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"97.254.110.195\n97.254.110.195\n201.204.204.79\n201.204.204.79\n91.99.254.221\n91.99.254.221\n238.168.34.198\n238.168.34.198\n123.66.104.149\n123.66.104.149\n63.22.89.135\n63.22.89.135\n180.216.152.74\n180.216.152.74\n46.39.115.163\n46.39.115.163\n4.129.30.26\n4.129.30.26\n232.71.123.158\n232.71.123.158\n156.26.31.83\n156.26.31.83\n253.66.231.9\n253.66.231.9\n123.249.92.27\n123.249.92.27\n99.117.159.230\n99.117.159.230\n249.52.15.234\n249.52.15.234\n12.35.138.196\n12.35.138.196\n45.16.168.55\n45.16.168.55\n45.16.168.55\n45.16.168.55\n235.115.250.188\n235.115.250.188\n235.115.250.188\n235.115.250.188\n103.243.164.186\n103.243.164.186\n103.243.164.186\n103.243.164.186\n112.187.132.254\n112.187.132.254\n20.42.54.16\n20.42.54.16\n113.214.212.76\n113.214.212.76\n19.161.121.221\n19.161.121.221\n19.161.121.221\n19.161.121.221\n219.144.238.18\n219.144.238.18\n212.153.97.58\n212.153.97.58\n241.169.58.184\n241.169.58.184\n241.169.58.184\n241.169.58.184\n209.218.135.8\n209.218.135.8\n209.218.135.8\n209.218.135.8\n247.246.233.70\n247.246.233.70\n11.189.43.52\n11.189.43.52\n248.169.187.143\n"}]},"apps":[],"jobName":"paragraph_1617197566101_-40565460","id":"20210123-134412_1522777655","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:30:44-0700","dateFinished":"2021-03-31T10:30:46-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483582"},{"text":"%md\nList the contents of the /devsh_loudacre/iplist HDFS folder. Review the contents of one of the files to confirm that they were created correctly.","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>List the contents of the /devsh_loudacre/iplist HDFS folder. Review the contents of one of the files to confirm that they were created correctly.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566102_1785080240","id":"20210121-195643_1574921285","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483583"},{"title":"14 - Create a dataset consisting of the IP address and corresponding user ID for each request for an HTML file","text":"%pyspark\n\n# Map web logs to \"ip-address,user-id\" and save\nsc.setJobGroup(\"Transforming data with RDDs\",\"Create a dataset consisting of the IP address and corresponding user ID for each request for an HTML file\")\nuserIPRDD=logsRDD.filter(lambda line: \".html\" in line).map(lambda line: line.split(' ')[0]+\",\"+line.split(' ')[2])\nuserIPRDD.saveAsTextFile(\"/devsh_loudacre/userips_csv\")","user":"anonymous","dateUpdated":"2021-03-31T10:36:47-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1617197566102_-226178289","id":"20200120-015958_582450735","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:36:47-0700","dateFinished":"2021-03-31T10:37:03-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483584"},{"text":"%md\n#### Create a .csv file\nA common step in transforming unstructured data is to split on a field delimiter and to separate the fields with a comma, creating a .csv file. \n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Create a .csv file</h4>\n<p>A common step in transforming unstructured data is to split on a field delimiter and to separate the fields with a comma, creating a .csv file.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566102_449601785","id":"20210123-134954_1790971944","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483585"},{"text":"%md\n#### Caution\nWhile functional programming will allow very complex single lines of code, as in this example, a developer should always write code first and formost for \nreadability. \n\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Caution</h4>\n<p>While functional programming will allow very complex single lines of code, as in this example, a developer should always write code first and formost for\n<br  />readability.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566102_1243752330","id":"20210123-134530_1841896348","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483586"},{"text":"%md\n### Map Weblog Entries to IP Address/User ID Pairs\n\nUse RDD transformations to create a dataset consisting of the IP address and corresponding user ID for each request for an HTML file. (Filter for files with \nthe .html extension; disregard requests for other file types.) The user ID is the third field in each log file line. \n\nSave the data into a comma-separated text file in the directory `/devsh_loudacre/userips_csv`. Make sure the data is saved in the form of comma-separated \nstrings:\n\n```pyspark\n165.32.101.206,8\n100.219.90.44,102\n182.4.148.56,173 \n246.241.6.175,45395 \n175.223.172.207,4115\n...\n```\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Map Weblog Entries to IP Address/User ID Pairs</h3>\n<p>Use RDD transformations to create a dataset consisting of the IP address and corresponding user ID for each request for an HTML file. (Filter for files with\n<br  />the .html extension; disregard requests for other file types.) The user ID is the third field in each log file line.</p>\n<p>Save the data into a comma-separated text file in the directory <code>/devsh_loudacre/userips_csv</code>. Make sure the data is saved in the form of comma-separated\n<br  />strings:</p>\n<pre><code class=\"pyspark\">165.32.101.206,8\n100.219.90.44,102\n182.4.148.56,173 \n246.241.6.175,45395 \n175.223.172.207,4115\n...\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1617197566103_572698473","id":"20210121-195844_517528545","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483587"},{"title":"15 - Load the new CSV files in /devsh_loudacre/userips_csv created above into a DataFrame, then view the data and schema","text":"%pyspark\n\nsc.setJobGroup(\"Transforming data with RDDs\",\"Read the userips_csv files\")\nuseripsDF = spark.read.option(\"inferSchema\",\"true\").csv(\"/devsh_loudacre/userips_csv\")\nuseripsDF.printSchema()\n","user":"anonymous","dateUpdated":"2021-03-31T10:39:51-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"_c0":"string","_c1":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- _c0: string (nullable = true)\n |-- _c1: integer (nullable = true)"}]},"apps":[],"jobName":"paragraph_1617197566103_-1471963654","id":"20200120-020455_1308475709","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:39:51-0700","dateFinished":"2021-03-31T10:40:00-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483588"},{"text":"%pyspark\nsc.setJobGroup(\"Transforming data with RDDs\",\"Show the userips_csv DataFrame\")\nuseripsDF.show(5)","user":"anonymous","dateUpdated":"2021-03-31T10:40:26-0700","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+------+\n|          _c0|   _c1|\n+-------------+------+\n|15.254.228.58|100277|\n|86.18.208.153| 32439|\n|208.145.20.46|     6|\n| 211.37.67.40|    67|\n|  46.55.5.181|    72|\n+-------------+------+\nonly showing top 5 rows"}]},"apps":[],"jobName":"paragraph_1617197566103_312186062","id":"20210123-134745_320585590","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T10:40:26-0700","dateFinished":"2021-03-31T10:40:27-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483589"},{"text":"%md\nNow that the data is in CSV format, it can easily be converted to a DataFrame and it can be used by Spark SQL Read in the .csv file into `useripsDF`. Print \nthe Schema. Show the first 10 records.\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Now that the data is in CSV format, it can easily be converted to a DataFrame and it can be used by Spark SQL Read in the .csv file into <code>useripsDF</code>. Print\n<br  />the Schema. Show the first 10 records.</p>\n"}]},"apps":[],"jobName":"paragraph_1617197566103_-1065152202","id":"20210121-200014_872512754","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483590"},{"text":"%md\n# Tear Down\n---","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Tear Down</h1>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1617197566110_-610556026","id":"20200830-194854_838260781","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483591"},{"title":"Delete Livy session","text":"%sh\n\nsessionId=$(curl -s localhost:8998/sessions | jq '.sessions[0].id')\ncurl -s localhost:8998/sessions/$sessionId -X DELETE","user":"anonymous","dateUpdated":"2021-03-31T12:45:08-0700","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{\"msg\":\"deleted\"}"}]},"apps":[],"jobName":"paragraph_1617197566111_-160430803","id":"20200830-195039_518625763","dateCreated":"2021-03-31T06:32:46-0700","dateStarted":"2021-03-31T12:45:08-0700","dateFinished":"2021-03-31T12:45:09-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:483592"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.\n","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We hope you've enjoyed this lab. Below are additional resources that you should find useful:</p>\n<ol>\n<li><a href=\"http://cloudera.com/tutorials.html\">Cloudera Tutorials</a> are your natural next step where you can explore Spark in more depth.</li>\n<li><a href=\"https://community.cloudera.com\">Cloudera Community</a> is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.</li>\n<li><a href=\"https://spark.apache.org/documentation.html\">Apache Spark Documentation</a> - official Spark documentation.</li>\n<li><a href=\"https://zeppelin.apache.org\">Apache Zeppelin Project Home Page</a> - official Zeppelin web site.</li>\n</ol>\n"}]},"apps":[],"jobName":"paragraph_1617197566111_-497687039","id":"20181116-135131_93712280","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483593"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera Educational Services\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"anonymous","dateUpdated":"2021-03-31T06:32:46-0700","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"ANGULAR","data":"</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera Educational Services\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>"}]},"apps":[],"jobName":"paragraph_1617197566111_679757443","id":"20200110-154537_1406191376","dateCreated":"2021-03-31T06:32:46-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:483594"}],"name":"/DevSH/Pyspark/RDDTransformData","id":"2G299VZJ1","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}