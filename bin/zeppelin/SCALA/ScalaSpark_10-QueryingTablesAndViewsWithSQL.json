{"paragraphs":[{"text":"%md\n# About\n**Lab:** Querying Tables and Views with SQL\n**Objective:**\n**File locations:**\n    Local: /home/devuser/data/telco/accountdevice\n    Hive Tables: telco.accounts\n\n**Successful outcome:** Use the Catalog API to explore Hive tables, create DataFrames by executing SQL queries, and work with temporary views.\n**Before you begin:** \n**Related lessons:** \n\n---","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>About</h1>\n<p><strong>Lab:</strong> Querying Tables and Views with SQL\n<br  /><strong>Objective:</strong> <em>Bold description</em>\n<br  /><strong>File locations:</strong></p>\n<pre><code>Local: $DEVDATA/accountdevice\nHive Tables: devsh.accounts\n</code></pre>\n<p><strong>Successful outcome:</strong> Use the Catalog API to explore Hive tables, create DataFrames by executing SQL queries, and work with temporary views.\n<br  /><strong>Before you begin:</strong>\n<br  /><strong>Related lessons:</strong></p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1591296637782_-1845549795","id":"20181126-092644_1457476546","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:274926"},{"text":"%md\n# Setup","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Setup</h1>\n<p><strong>Important:</strong> This exercise depends on <strong><em> ***Insert previous exercise title here (with link?)*** </em></strong>. If you did not complete that exercise, run the course catch-up script and advance to the current exercise:</p>\n<pre><code>$ $DEVSH/scripts/catchup.sh\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1591296637783_-1969280709","id":"20181201-044336_178705192","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274927"},{"text":"%md\n# Lab\n","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Lab</h1>\n"}]},"apps":[],"jobName":"paragraph_1591296637784_-2050067025","id":"20181126-093358_358613711","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274928"},{"text":"%md\n### Show Tables and Columns Using the Catalog API","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Show Tables and Columns Using the Catalog API</h3>\n"}]},"apps":[],"jobName":"paragraph_1591296637785_-1007260730","id":"20200425-211825_1230755707","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274929"},{"title":"1 - View the current Hive tables and temporary views","text":"%md\nView the list of current Hive tables and temporary views in the `telco` database.\n\nThe list should include the `accounts` table.","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>View the list of current Hive tables and temporary views in the <code>devsh</code> database.</p>\n<p>The list should include the <code>accounts</code> table.</p>\n"}]},"apps":[],"jobName":"paragraph_1591296637785_701394249","id":"20200425-204217_180178720","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274930"},{"text":"%spark2\nspark.catalog.listTables(\"telco\").show","user":"sysadmin","dateUpdated":"2020-06-04T18:51:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637786_-952149454","id":"20200425-205151_147795731","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274931"},{"title":"2 - List the schema of the accounts table","text":"%md\nList the schema (column definitions) of the `telco.accounts` table.","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h5>2)</h5>\n<p>List the schema (column definitions) of the <code>devsh.accounts</code> table.</p>\n"}]},"apps":[],"jobName":"paragraph_1591296637787_-1836251128","id":"20200425-204217_1495631798","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274932"},{"text":"%spark2\nspark.catalog.listColumns(\"accounts\",\"telco\").show","user":"sysadmin","dateUpdated":"2020-06-04T18:51:21+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637787_2112813746","id":"20200425-205839_923045469","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274933"},{"title":"3 - Create a DataFrame based on the accounts table","text":"%md\nCreate a new DataFrame based on the `telco.accounts` table, and confirm that its schema matches that of the column above.","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>3</h4>\n<p>Create a new DataFrame based on the <code>devsh.accounts</code> table, and confirm that its schema matches that of the column above.</p>\n"}]},"apps":[],"jobName":"paragraph_1591296637788_1502654726","id":"20200425-204216_47253481","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274934"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-04T18:51:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637788_-2071281530","id":"20200425-205934_1028171688","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274935"},{"text":"%md\n### Perform a SQL Query on a Table","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Perform a SQL Query on a Table</h3>\n"}]},"apps":[],"jobName":"paragraph_1591296637789_2040169104","id":"20200425-212714_1159161390","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274936"},{"title":"4 - Perform a SQL query on the accounts table","text":"%md\nCreate a new DataFrame by performing a simple SQL query on the `telco.accounts` table. Confirm that the schema and data are correct.","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>4)</h4>\n<p>Create a new DataFrame by performing a simple SQL query on the<code>devsh.accounts</code> table. Confirm that the schema and data are correct.</p>\n"}]},"apps":[],"jobName":"paragraph_1591296637790_113363743","id":"20200425-204214_2011765789","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274937"},{"text":"%spark2\nval firstLastDF = spark.sql(\"SELECT first_name,last_name FROM telco.accounts\")","user":"sysadmin","dateUpdated":"2020-06-04T18:57:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637790_-1690243944","id":"20200425-210133_1271266054","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274938"},{"title":"5 - Compare the results of the SQL query from above to the equivalent query using the DataFrame API","text":"%md\n*Optional:* Perform the equivalent query using the DataFrame API, and compare the schema and data in the results to those of the query above.","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>5)</h4>\n<p><em>Optional:</em> Perform the equivalent query using the DataFrame API, and compare the\n<br  />schema and data in the results to those of the query above.</p>\n"}]},"apps":[],"jobName":"paragraph_1591296637791_1740185484","id":"20200425-204209_844636626","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274939"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-04T18:58:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637791_1951107410","id":"20200425-210250_2016844228","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274940"},{"text":"%md\n### Create and Query a View","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Create and Query a View</h3>\n"}]},"apps":[],"jobName":"paragraph_1591296637792_-1985847012","id":"20200425-212910_1802330108","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274941"},{"title":"6 - Create a DataFrame based on the account device data","text":"%md\nCreate a DataFrame called `accountDeviceDF` based on the CSV files in `/user/zeppelin/accountdevice`. (Be sure to use the headers and inferred schema to determine the column names and types.)","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Create a DataFrame called <code>accountDeviceDF</code> based on the CSV files in <code>/devsh_loudacre/accountdevice</code>. (Be sure to use the headers and inferred schema to determine the column names and types.)</p>\n"}]},"apps":[],"jobName":"paragraph_1591296637793_1746686258","id":"20200425-212936_798549669","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274942"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-04T18:58:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637793_1614641598","id":"20200425-210420_595158875","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274943"},{"title":"7 - Create a temporary view","text":"%md\nCreate a temporary view on the `accountDeviceDF` DataFrame called `account_dev`.","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>7)</h4>\n<p>Create a temporary view on the <code>accountDeviceDF</code> DataFrame called\n<br  /><code>account_dev</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1591296637794_-1251575118","id":"20200425-210413_1790340597","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274944"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-04T18:58:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637794_-910778837","id":"20200425-210533_34707541","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274945"},{"title":"8 - List the tables and views in the devsh database","text":"%md\nConfirm the view was created correctly by listing the tables and views in the `devsh` database as you did earlier. Notice that the `account_dev` table type is `TEMPORARY`.","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>8)</h4>\n<p>Confirm the view was created correctly by listing the tables and views in the\n<br  />devsh database as you did earlier. Notice that the <code>account_dev</code> table type is\n<br  /><code>TEMPORARY</code>.</p>\n"}]},"apps":[],"jobName":"paragraph_1591296637795_1257378697","id":"20200425-210412_35375447","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274946"},{"text":"%pyspark\n","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637795_764116343","id":"20200425-210629_2011533386","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274947"},{"title":"9 - Use a SQL query to create a new DataFrame","text":"%md\nUsing a SQL query, create a new DataFrame based on the first five rows of the account_dev view, and display the results.","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<pre><code>    &gt; spark.sql(\"SELECT * FROM account_dev LIMIT 5\").show()\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1591296637796_1487653608","id":"20200425-204208_966046944","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274948"},{"text":"%spark2\nspark.sql(\"SELECT * FROM account_dev LIMIT 5\").show()","user":"sysadmin","dateUpdated":"2020-06-04T18:58:27+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637797_1763235081","id":"20200425-210735_2037261450","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274949"},{"text":"%md\n### Use SQL to Join Two Tables","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Use SQL to Join Two Tables</h3>\n"}]},"apps":[],"jobName":"paragraph_1591296637797_-1170551241","id":"20200425-204207_2008963040","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274950"},{"title":"10 - Join the accounts table and the account_dev view","text":"%md\nJoin the `telco.accounts` table and `account_dev` view using the account ID, and display the results.\n(Note that the SQL string in the command below must be entered on a single line in the Spark shell.)","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>(Note that the SQL string in the command below must be entered on a single line in the Spark shell.)</p>\n"}]},"apps":[],"jobName":"paragraph_1591296637798_-875248045","id":"20200425-213619_1400283766","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274951"},{"text":"%spark2\nval nameDevDF = spark.sql(\"SELECT acct_num,\nfirst_name, last_name, account_device_id FROM\ndevsh.accounts JOIN account_dev ON acct_num =\naccount_id\")\n\nnameDevDF.show","user":"sysadmin","dateUpdated":"2020-06-04T18:58:49+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637798_994819729","id":"20200425-213832_715963491","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274952"},{"title":"11 - Save the new DataFrame as a Hive table","text":"%md\nSave `nameDevDF` as a Hive table in the devsh called `name_dev` (with the file path as `/user/zeppelin/hive/name_dev`).","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637799_106242688","id":"20200425-213617_1311161101","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274953"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-04T18:59:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637799_-925079232","id":"20200425-214311_1714837796","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274954"},{"title":"12 - Use the Catalog API to confirm the table was created correctly","text":"%md\nUse the Catalog API to confirm that the table was created correctly with the right schema.","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637800_-1114249219","id":"20200425-213616_41530436","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274955"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-04T18:59:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637801_-264972047","id":"20200425-214333_82825593","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274956"},{"title":"13 - Verify that the name_dev table exists in the Hive metastore","text":"%md\n*Optional:* If you are familiar with using Hive, verify that the `telco.name_dev` table now exists in the Hive metastore.","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637801_563766091","id":"20200425-213615_1430154858","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274957"},{"text":"%jdbc(hive)\n","user":"sysadmin","dateUpdated":"2020-06-04T18:59:40+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637802_-574896336","id":"20200425-214359_2065545271","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274958"},{"title":"14 - Confirm that the account_dev view is temporary","text":"%md\n*Optional:* Exit and restart the shell and confirm that the `account_dev` temporary view is no longer available.","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637802_815766062","id":"20200425-213613_1242953185","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274959"},{"text":"%spark2\n","user":"sysadmin","dateUpdated":"2020-06-04T18:59:46+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637803_2065808473","id":"20200425-214347_1897482092","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274960"},{"text":"%md\n# Result\n**You have now:** \n\n---","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Result</h1>\n<p><strong>You have now:</strong></p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1591296637803_-932708984","id":"20181126-133507_1472573213","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274961"},{"text":"%md\n# Solution\n---\n\nIf not uploaded previously: \n\n    $ hdfs dfs -put /user/devuser/data/telco/accountdevice /user/zeppelin/","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Solution</h1>\n<hr />\n<p>If not uploaded previously:</p>\n<pre><code>$ hdfs dfs -put $DEVDATA/accountdevice /devsh_loudacre/\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1591296637804_562668240","id":"20181018-125200_1133281582","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274962"},{"text":"%sh\nhdfs dfs -ls /user/zeppelin/accountdevice/","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 2 items\n-rw-r--r--   3 zeppelin hdfs        212 2020-05-26 04:08 /user/zeppelin/accountdevice/._part-00000-f3b62dad-1054-4b2e-81fd-26e54c2ae76a.csv\n-rw-r--r--   3 zeppelin hdfs   12928268 2020-05-26 04:08 /user/zeppelin/accountdevice/part-00000-f3b62dad-1054-4b2e-81fd-26e54c2ae76a.csv\n"}]},"apps":[],"jobName":"paragraph_1591296637805_505760788","id":"20200531-184032_378921030","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274963"},{"title":"1 - View the list of current Hive tables and temporary views","text":"%spark2\nspark.catalog.listTables(\"telco\").show","user":"sysadmin","dateUpdated":"2020-06-04T19:00:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Table(name=u'accounts', database=u'telco', description=None, tableType=None, isTemporary=False)\nTable(name=u'accounts_stage', database=u'telco', description=None, tableType=u'EXTERNAL', isTemporary=False)\n"}]},"apps":[],"jobName":"paragraph_1591296637805_-1146571588","id":"20200426-000605_1224242785","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274964"},{"title":"2 - List the schema of the accounts table","text":"%spark2\nspark.catalog.listColumns(\"telco\",\"accounts\").show","user":"sysadmin","dateUpdated":"2020-06-04T19:00:20+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Column(name=u'acct_num', description=None, dataType=u'int', nullable=True, isPartition=False, isBucket=False)\nColumn(name=u'acct_create_dt', description=None, dataType=u'timestamp', nullable=True, isPartition=False, isBucket=False)\nColumn(name=u'acct_close_dt', description=None, dataType=u'timestamp', nullable=True, isPartition=False, isBucket=False)\nColumn(name=u'first_name', description=None, dataType=u'string', nullable=True, isPartition=False, isBucket=False)\nColumn(name=u'last_name', description=None, dataType=u'string', nullable=True, isPartition=False, isBucket=False)\nColumn(name=u'address', description=None, dataType=u'string', nullable=True, isPartition=False, isBucket=False)\nColumn(name=u'city', description=None, dataType=u'string', nullable=True, isPartition=False, isBucket=False)\nColumn(name=u'state', description=None, dataType=u'string', nullable=True, isPartition=False, isBucket=False)\nColumn(name=u'zipcode', description=None, dataType=u'string', nullable=True, isPartition=False, isBucket=False)\nColumn(name=u'phone_number', description=None, dataType=u'string', nullable=True, isPartition=False, isBucket=False)\nColumn(name=u'created', description=None, dataType=u'timestamp', nullable=True, isPartition=False, isBucket=False)\nColumn(name=u'modified', description=None, dataType=u'timestamp', nullable=True, isPartition=False, isBucket=False)\n"}]},"apps":[],"jobName":"paragraph_1591296637806_101709438","id":"20200426-000959_248054979","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274965"},{"title":"3 - Create a new DataFrame based on the accounts table","text":"%spark2\nval accountsDF = spark.read.table(\"telco.accounts\")\naccountsDF.printSchema","user":"sysadmin","dateUpdated":"2020-06-04T19:00:33+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- acct_num: integer (nullable = true)\n |-- acct_create_dt: timestamp (nullable = true)\n |-- acct_close_dt: timestamp (nullable = true)\n |-- first_name: string (nullable = true)\n |-- last_name: string (nullable = true)\n |-- address: string (nullable = true)\n |-- city: string (nullable = true)\n |-- state: string (nullable = true)\n |-- zipcode: string (nullable = true)\n |-- phone_number: string (nullable = true)\n |-- created: timestamp (nullable = true)\n |-- modified: timestamp (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1591296637806_-1531626404","id":"20200426-001108_1151276805","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274966"},{"text":"%md\n### Perform a SQL Query on a Table","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Perform a SQL Query on a Table</h3>\n"}]},"apps":[],"jobName":"paragraph_1591296637807_-1563213330","id":"20200429-043257_859043392","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274967"},{"title":"4 - Perform a SQL query on the accounts table","text":"%spark2\nval firstLastDF = spark.sql(\"SELECT first_name,last_name FROM telco.accounts\")\nfirstLastDF.printSchema\nfirstLastDF.show(5)","user":"sysadmin","dateUpdated":"2020-06-04T19:00:44+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- first_name: string (nullable = true)\n |-- last_name: string (nullable = true)\n\n+----------+---------+\n|first_name|last_name|\n+----------+---------+\n|    Donald|   Becton|\n|     Donna|    Jones|\n|    Dorthy| Chalmers|\n|     Leila|  Spencer|\n|     Anita| Laughlin|\n+----------+---------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1591296637808_950762136","id":"20200429-043256_1081078145","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274968"},{"title":"5 - Compare the results of the SQL query from above to the equivalent query using the DataFrame API","text":"%spark2\nval firstLastDF2 = accountsDF.select(\"first_name\",\"last_name\")\nfirstLastDF2.printSchema\nfirstLastDF2.show(5)","user":"sysadmin","dateUpdated":"2020-06-04T19:00:54+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- first_name: string (nullable = true)\n |-- last_name: string (nullable = true)\n\n+----------+---------+\n|first_name|last_name|\n+----------+---------+\n|    Donald|   Becton|\n|     Donna|    Jones|\n|    Dorthy| Chalmers|\n|     Leila|  Spencer|\n|     Anita| Laughlin|\n+----------+---------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1591296637808_1517471091","id":"20200429-043254_742596193","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274969"},{"text":"%md\n### Create and Query a View","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637809_540878180","id":"20200429-043252_1665886003","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274970"},{"title":"6 - Create a DataFrame based on the account device data","text":"%spark2\nval accountDeviceDF = spark.read.option(\"header\",\"true\").option(\"inferSchema\",\"true\").csv(\"/user/zeppelin/accountdevice\")","user":"sysadmin","dateUpdated":"2020-06-04T19:01:24+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1591296637809_1172672722","id":"20200429-043252_506101829","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274971"},{"title":"7 - Create a temporary view","text":"%spark2\naccountDeviceDF.createOrReplaceTempView(\"account_dev\")","user":"sysadmin","dateUpdated":"2020-06-04T19:01:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1591296637810_570465628","id":"20200429-043250_1737448514","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274972"},{"title":"8 - List the tables and views in the devsh database","text":"%spark2\nspark.catalog.listTables(\"telco\").show","user":"sysadmin","dateUpdated":"2020-06-04T19:01:52+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Table(name=u'accounts', database=u'telco', description=None, tableType=None, isTemporary=False)\nTable(name=u'accounts_stage', database=u'telco', description=None, tableType=u'EXTERNAL', isTemporary=False)\nTable(name=u'account_dev', database=None, description=None, tableType=u'TEMPORARY', isTemporary=True)\n"}]},"apps":[],"jobName":"paragraph_1591296637811_1089698215","id":"20200429-044141_1658573369","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274973"},{"title":"9 - Use a SQL query to create a new DataFrame","text":"%spark2\nspark.sql(\"SELECT * FROM account_dev LIMIT 5\").show","user":"sysadmin","dateUpdated":"2020-06-04T19:02:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+----------+---------+---------------+--------------------+\n|    id|account_id|device_id|activation_date|   account_device_id|\n+------+----------+---------+---------------+--------------------+\n|130116|     86733|       36|  1378430416000|adf4b0aa-5ccd-416...|\n|130117|     86733|       29|  1388563821000|a87910b7-2f14-4d8...|\n|130118|     86734|       23|  1372509401000|6dac114d-0241-4e4...|\n|130119|     86734|       29|  1384441155000|cc1ead51-da1a-461...|\n|130120|     86735|       33|  1376460017000|2c2332a8-55c6-4ae...|\n+------+----------+---------+---------------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1591296637811_-1433797564","id":"20200429-044140_1395210650","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274974"},{"text":"%md\n### Use SQL to Join Two Tables","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591296637812_-1107616442","id":"20200429-044138_1651579672","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274975"},{"title":"10 - Join the accounts table and the account_dev view","text":"%spark2\nval nameDevDF = spark.sql(\"SELECT acct_num, first_name, last_name, account_device_id FROM telco.accounts JOIN account_dev ON acct_num = account_id\")\nnameDevDF.show","user":"sysadmin","dateUpdated":"2020-06-04T19:02:21+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------+---------+--------------------+\n|acct_num|first_name|last_name|   account_device_id|\n+--------+----------+---------+--------------------+\n|   32443|   Desiree|    Beall|7351fed1-f344-4cd...|\n|   32444|     Molly|   Pinder|6da22278-ff7a-461...|\n|   32445|   Melissa|  Carlson|cb993b85-6775-407...|\n|   32446|    Oliver|    Olson|48ea2c09-a0df-4d1...|\n|   32446|    Oliver|    Olson|4b49c0a6-d141-42e...|\n|   32447|       Ben|McFarlane|cc8e8361-3d67-4be...|\n|   32447|       Ben|McFarlane|b40dba90-b073-405...|\n|   32448|   Barbara|  McClure|f088d30f-1e1c-47f...|\n|   32448|   Barbara|  McClure|2805df93-2e89-433...|\n|   32449| Christina|    Smith|e0e7edbe-77fc-421...|\n|   32450|      Jake|    Weber|b3ce579f-48e3-43e...|\n|   32451|    Johnny|  Rodgers|857bbe4f-028c-475...|\n|   32451|    Johnny|  Rodgers|826e4946-48a1-43c...|\n|   32452|     Buddy|  Pinkard|a3c1d199-f70f-44f...|\n|   32452|     Buddy|  Pinkard|d3e29743-fb26-496...|\n|   32453|     Tommy|    Jones|1c1011ff-9760-410...|\n|   32454|   Deborah|   Eslick|253febd2-c2c6-406...|\n|   32455|      Rita|Rodriguez|2c4db96f-4afa-411...|\n|   32455|      Rita|Rodriguez|96f69b89-adbf-46b...|\n|   32456| Elizabeth|   Wilson|f7e3fe6a-86bf-4ce...|\n+--------+----------+---------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1591296637812_737882533","id":"20200429-044432_481513618","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274976"},{"title":"11 - Save the new DataFrame as a Hive table","text":"%spark2\nnameDevDF.write.option(\"path\",\"/user/zeppelin/hive/name_dev\").saveAsTable(\"telco.name_dev\")","user":"sysadmin","dateUpdated":"2020-06-04T19:03:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1591296637813_55150614","id":"20200429-044430_1872152104","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274977"},{"title":"12 - Use the Catalog API to confirm the table was created correctly","text":"%spark2\nspark.catalog.listTables(\"telco\").show\nspark.sql(\"DESCRIBE telco.name_dev\").show","user":"sysadmin","dateUpdated":"2020-06-04T19:03:31+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Table(name=u'accounts', database=u'telco', description=None, tableType=None, isTemporary=False)\nTable(name=u'accounts_stage', database=u'telco', description=None, tableType=u'EXTERNAL', isTemporary=False)\nTable(name=u'name_dev', database=u'telco', description=None, tableType=u'EXTERNAL', isTemporary=False)\nTable(name=u'account_dev', database=None, description=None, tableType=u'TEMPORARY', isTemporary=True)\n+-----------------+---------+-------+\n|         col_name|data_type|comment|\n+-----------------+---------+-------+\n|         acct_num|      int|   null|\n|       first_name|   string|   null|\n|        last_name|   string|   null|\n|account_device_id|   string|   null|\n+-----------------+---------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1591296637814_1116138573","id":"20200429-044657_1007317987","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274978"},{"title":"13 - Verify that the name_dev table exists in the Hive metastore","text":"%jdbc(hive)\nSHOW TABLES FROM telco","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"tab_name\naccounts\naccounts_stage\nname_dev\n"}]},"apps":[],"jobName":"paragraph_1591296637814_-787837768","id":"20200429-044653_230397289","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274979"},{"title":"14 - Confirm that the account_dev view is temporary","text":"%spark2\nspark.catalog.listTables(\"telco\").show","user":"sysadmin","dateUpdated":"2020-06-04T19:04:22+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Table(name=u'accounts', database=u'telco', description=None, tableType=None, isTemporary=False)\nTable(name=u'accounts_stage', database=u'telco', description=None, tableType=u'EXTERNAL', isTemporary=False)\nTable(name=u'name_dev', database=u'telco', description=None, tableType=u'EXTERNAL', isTemporary=False)\nTable(name=u'account_dev', database=None, description=None, tableType=u'TEMPORARY', isTemporary=True)\n"}]},"apps":[],"jobName":"paragraph_1591296637815_1985831203","id":"20200429-044651_1860942540","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274980"},{"text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Hortonworks Apache Spark Tutorials](http://hortonworks.com/tutorials/#tuts-developers) are your natural next step where you can explore Spark in more depth.\n2. [Hortonworks Community Connection (HCC)](https://community.hortonworks.com/spaces/85/data-science.html?type=question) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Hortonworks Apache Spark Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html) - official Spark documentation.\n4. [Hortonworks Apache Zeppelin Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html) - official Zeppelin documentation.\n","user":"sysadmin","dateUpdated":"2020-06-04T18:50:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We hope you've enjoyed this lab. Below are additional resources that you should find useful:</p>\n<ol>\n<li><a href=\"http://hortonworks.com/tutorials/#tuts-developers\">Hortonworks Apache Spark Tutorials</a> are your natural next step where you can explore Spark in more depth.</li>\n<li><a href=\"https://community.hortonworks.com/spaces/85/data-science.html?type=question\">Hortonworks Community Connection (HCC)</a> is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html\">Hortonworks Apache Spark Docs</a> - official Spark documentation.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html\">Hortonworks Apache Zeppelin Docs</a> - official Zeppelin documentation.</li>\n</ol>\n"}]},"apps":[],"jobName":"paragraph_1591296637816_730699822","id":"20181126-133017_244739700","dateCreated":"2020-06-04T18:50:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274981"}],"name":"ScalaSpark/10-QueryingTablesAndViewsWithSQL","id":"2FBNJVAG9","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}