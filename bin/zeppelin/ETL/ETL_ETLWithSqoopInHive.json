{"paragraphs":[{"text":"%md\n# Setup","user":"devuser","dateUpdated":"2020-01-05T19:33:21+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374450_-1447200929","id":"20191122-174342_1846188289","dateCreated":"2019-12-04T04:22:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:61904","dateFinished":"2020-01-05T19:33:21+0000","dateStarted":"2020-01-05T19:33:21+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Setup</h1>\n"}]}},{"text":"%md\nGrant the following privileges to testuser in the MySQL database:\n\nGRANT ALL ON airlinesdb.airline_raw to 'testuser’;\nFLUSH PRIVILEGES;\n\nand confirm the grant is effective\n\nmysql> SHOW GRANTS FOR 'testuser';\n+----------------------------------------------------------------------+\n| Grants for testuser@%                                                |\n+----------------------------------------------------------------------+\n| GRANT USAGE ON *.* TO 'testuser'@'%'                                 |\n| GRANT ALL PRIVILEGES ON `airlinesdb`.`airline_raw` TO 'testuser'@'%' |\n+----------------------------------------------------------------------+\n2 rows in set (0.00 sec)","user":"devuser","dateUpdated":"2020-01-05T19:33:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374451_1701274706","id":"20191122-174358_1560456850","dateCreated":"2019-12-04T04:22:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:61905","dateFinished":"2020-01-05T19:33:25+0000","dateStarted":"2020-01-05T19:33:25+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Grant the following privileges to testuser in the MySQL database:</p>\n<p>GRANT ALL ON airlinesdb.airline_raw to 'testuser’;\n<br  />FLUSH PRIVILEGES;</p>\n<p>and confirm the grant is effective</p>\n<p>mysql> SHOW GRANTS FOR 'testuser';\n<br  />+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-+\n<br  />| Grants for testuser@%                                                |\n<br  />+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-+\n<br  />| GRANT USAGE ON <em>.</em> TO 'testuser'@'%'                                 |\n<br  />| GRANT ALL PRIVILEGES ON <code>airlinesdb</code>.<code>airline_raw</code> TO 'testuser'@'%' |\n<br  />+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-+\n<br  />2 rows in set (0.00 sec)</p>\n"}]}},{"text":"%md\n## Data Ingest","user":"devuser","dateUpdated":"2020-01-05T19:33:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374451_948639280","id":"20190528-115010_1883653124","dateCreated":"2019-12-04T04:22:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:61906","dateFinished":"2020-01-05T19:33:27+0000","dateStarted":"2020-01-05T19:33:27+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Data Ingest</h2>\n"}]}},{"title":"1. Delete the HDFS directory","text":"%sh\nhdfs dfs -rm -r /user/zeppelin/airlines_raw","user":"devuser","dateUpdated":"2019-12-04T04:22:54+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374451_426724664","id":"20191122-172124_1038812088","dateCreated":"2019-12-04T04:22:54+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61907"},{"title":"2. Drop the table if it exists","text":"%jdbc(hive)\nDROP TABLE IF EXISTS airlines_raw;","user":"devuser","dateUpdated":"2019-12-04T04:22:54+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374452_-1597134647","id":"20190603-151558_2113520914","dateCreated":"2019-12-04T04:22:54+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61908"},{"title":"3. Import the table from Mysql with Sqoop","text":"%md\nThe sqqop command needs to be executed by the hive service user.\nExecute the following code in a terminal as the root user\n```console\nsudo -u hive sqoop import --connect jdbc:mysql:///ip-172-31-6-78.eu-central-1.compute.internal:3306/airlinesdb --username testuser --table airline_raw --input-fields-terminated-by ',' --split-by Year --hive-import --hive-table default.airlines_raw\nexit\n```","user":"devuser","dateUpdated":"2019-12-04T04:22:54+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374452_1852605248","id":"20190603-164459_396362074","dateCreated":"2019-12-04T04:22:54+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61909"},{"title":"4. Query the data to confirm successful import","text":"%jdbc(hive)\nSELECT * FROM airlines_raw;","user":"devuser","dateUpdated":"2019-12-04T04:22:54+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"airlines_raw.year":"string","airlines_raw.month":"string","airlines_raw.dayofmonth":"string","airlines_raw.dayofweek":"string","airlines_raw.deptime":"string","airlines_raw.crsdeptime":"string","airlines_raw.arrtime":"string","airlines_raw.crsarrtime":"string","airlines_raw.uniquecarrier":"string","airlines_raw.flightnum":"string","airlines_raw.tailnum":"string","airlines_raw.actualelapsedtime":"string","airlines_raw.crselapsedtime":"string","airlines_raw.airtime":"string","airlines_raw.arrdelay":"string","airlines_raw.depdelay":"string","airlines_raw.origin":"string","airlines_raw.dest":"string","airlines_raw.distance":"string","airlines_raw.taxiin":"string","airlines_raw.taxiout":"string","airlines_raw.cancelled":"string","airlines_raw.cancellationcode":"string","airlines_raw.diverted":"string","airlines_raw.carrierdelay":"string","airlines_raw.weatherdelay":"string","airlines_raw.nasdelay":"string","airlines_raw.securitydelay":"string","airlines_raw.lateaircraftdelay":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374452_-1330295742","id":"20190528-113331_1589196989","dateCreated":"2019-12-04T04:22:54+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61910"},{"title":"5. Create a managed table from the external table","text":"%jdbc(hive)\nDROP TABLE IF EXISTS airlines;\nCREATE TABLE airlines STORED AS ORC AS SELECT * FROM airlines_raw;","user":"devuser","dateUpdated":"2019-12-04T04:22:54+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374453_1350711213","id":"20190528-113426_1983073818","dateCreated":"2019-12-04T04:22:54+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61911"},{"title":"6. Query the table to confirm successful creation","text":"%jdbc(hive)\nSELECT * FROM airlines;","user":"devuser","dateUpdated":"2019-12-04T04:22:54+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"airlines.year":"string","airlines.month":"string","airlines.dayofmonth":"string","airlines.dayofweek":"string","airlines.deptime":"string","airlines.crsdeptime":"string","airlines.arrtime":"string","airlines.crsarrtime":"string","airlines.uniquecarrier":"string","airlines.flightnum":"string","airlines.tailnum":"string","airlines.actualelapsedtime":"string","airlines.crselapsedtime":"string","airlines.airtime":"string","airlines.arrdelay":"string","airlines.depdelay":"string","airlines.origin":"string","airlines.dest":"string","airlines.distance":"string","airlines.taxiin":"string","airlines.taxiout":"string","airlines.cancelled":"string","airlines.cancellationcode":"string","airlines.diverted":"string","airlines.carrierdelay":"string","airlines.weatherdelay":"string","airlines.nasdelay":"string","airlines.securitydelay":"string","airlines.lateaircraftdelay":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374453_1022430579","id":"20190528-113536_288891615","dateCreated":"2019-12-04T04:22:54+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61912"},{"text":"%md\n## Data Analysis","user":"devuser","dateUpdated":"2020-01-05T19:33:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374453_-1892321583","id":"20190528-115043_412794029","dateCreated":"2019-12-04T04:22:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:61913","dateFinished":"2020-01-05T19:33:34+0000","dateStarted":"2020-01-05T19:33:34+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Data Analysis</h2>\n"}]}},{"title":"6. Determine the amount of canceled flights by month and year for each airline","text":"%jdbc(hive)\nSELECT uniquecarrier, count(cancelled) AS canceledflightsamount, year, month FROM airlines GROUP BY uniquecarrier, year, month ORDER BY uniquecarrier,year ASC,month ASC","user":"devuser","dateUpdated":"2019-12-04T04:22:54+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"uniquecarrier":"string","canceledflightsamount":"string","year":"string","month":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374453_-1751992234","id":"20190528-115126_1700571367","dateCreated":"2019-12-04T04:22:54+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61914"},{"title":"7. How many flights were considered late by month and year for each  airline?","text":"%jdbc(hive)\nSELECT uniquecarrier, count(*) AS lateflights, year, month FROM airlines WHERE arrdelay > 0 GROUP BY uniquecarrier, year, month ORDER BY uniquecarrier,year ASC,month ASC","user":"devuser","dateUpdated":"2019-12-04T04:22:54+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"uniquecarrier":"string","lateflights":"string","year":"string","month":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374454_-1356396973","id":"20190528-115208_1981632336","dateCreated":"2019-12-04T04:22:54+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61915"},{"title":"8. Determine the unique carrier with the highest delays (NASDelay and SecurityDelay)","text":"%jdbc(hive)\nSELECT uniquecarrier, count(NASDelay) + count(SecurityDelay) AS totaldelay FROM airlines GROUP BY uniquecarrier ORDER BY totaldelay DESC LIMIT 1","user":"devuser","dateUpdated":"2019-12-04T04:22:54+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"uniquecarrier":"string","totaldelay":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374454_644114976","id":"20190528-115248_915307060","dateCreated":"2019-12-04T04:22:54+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61916"},{"title":"9. Determine the unique carrier with the least delays","text":"%jdbc(hive)\nSELECT uniquecarrier, count(NASDelay) + count(SecurityDelay) AS totaldelay FROM airlines GROUP BY uniquecarrier ORDER BY totaldelay ASC LIMIT 1","user":"devuser","dateUpdated":"2019-12-04T04:22:54+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"uniquecarrier":"string","totaldelay":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374454_-2023188739","id":"20190528-115348_484747662","dateCreated":"2019-12-04T04:22:54+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61917"},{"user":"devuser","dateUpdated":"2019-12-04T04:22:54+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575433374454_593441116","id":"20190528-115436_379811721","dateCreated":"2019-12-04T04:22:54+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61918"}],"name":"ETL/ETLWithSqoopInHive","id":"2EU3RRR1F","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
