{"paragraphs":[{"text":"%md\n# Setup","user":"admin","dateUpdated":"2019-11-22T18:31:22+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574447458045_-419228511","id":"20191122-183058_1696104181","dateCreated":"2019-11-22T18:30:58+0000","dateStarted":"2019-11-22T18:31:22+0000","dateFinished":"2019-11-22T18:31:22+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:88940"},{"text":"%md\nYou need to execute the code below as root\n\n'''\ncd /var/lib/mysql\nwget https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-8.0.16.tar.gz\ntar xvf mysql-connector-java-8.0.16.tar.gz\nmv mysql-connector-java-8.0.16/mysql-connector-java-8.0.16.jar .\n'''\nand add the following dependency to the Spark interpreter\n/var/lib/mysql/mysql-connector-java-8.0.16.jar","user":"admin","dateUpdated":"2019-11-22T18:34:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574447485163_-1527267251","id":"20191122-183125_1645365134","dateCreated":"2019-11-22T18:31:25+0000","dateStarted":"2019-11-22T18:34:14+0000","dateFinished":"2019-11-22T18:34:14+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88941"},{"text":"%md\n## Data Ingest","user":"admin","dateUpdated":"2019-11-22T17:09:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574442531552_-1182590185","id":"20190528-115010_1883653124","dateCreated":"2019-11-22T17:08:51+0000","dateStarted":"2019-11-22T17:09:04+0000","dateFinished":"2019-11-22T17:09:04+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88942"},{"title":"1. Drop the table if it exists","text":"%jdbc(hive)\nDROP TABLE IF EXISTS airlines_raw;","user":"admin","dateUpdated":"2019-11-22T17:55:31+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574442531553_329373805","id":"20190603-151558_2113520914","dateCreated":"2019-11-22T17:08:51+0000","dateStarted":"2019-11-22T17:55:31+0000","dateFinished":"2019-11-22T17:55:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88943"},{"title":"2. Import the table from MySQL with Spark","text":"val airlines_raw = spark.read.format(\"jdbc\")\n                        .option(\"url\",\"jdbc:mysql://ip-172-31-6-78.eu-central-1.compute.internal:3306/airlinesdb\")\n                        .option(\"driver\",\"com.mysql.cj.jdbc.Driver\")\n                        .option(\"dbtable\",\"airline_raw\")\n                        .option(\"user\",\"testuser\")\n                        .load()\nairlines_raw.createOrReplaceTempView(\"airlines_raw\")","user":"admin","dateUpdated":"2019-11-22T18:25:21+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574442531553_-324923368","id":"20190603-164459_396362074","dateCreated":"2019-11-22T17:08:51+0000","dateStarted":"2019-11-22T18:25:21+0000","dateFinished":"2019-11-22T18:25:46+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88944"},{"title":"3. Query the data to confirm successful import","text":"%sql\nSELECT * FROM airlines_raw LIMIT 10","user":"admin","dateUpdated":"2019-11-22T18:25:49+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"airlines_raw.year":"string","airlines_raw.month":"string","airlines_raw.dayofmonth":"string","airlines_raw.dayofweek":"string","airlines_raw.deptime":"string","airlines_raw.crsdeptime":"string","airlines_raw.arrtime":"string","airlines_raw.crsarrtime":"string","airlines_raw.uniquecarrier":"string","airlines_raw.flightnum":"string","airlines_raw.tailnum":"string","airlines_raw.actualelapsedtime":"string","airlines_raw.crselapsedtime":"string","airlines_raw.airtime":"string","airlines_raw.arrdelay":"string","airlines_raw.depdelay":"string","airlines_raw.origin":"string","airlines_raw.dest":"string","airlines_raw.distance":"string","airlines_raw.taxiin":"string","airlines_raw.taxiout":"string","airlines_raw.cancelled":"string","airlines_raw.cancellationcode":"string","airlines_raw.diverted":"string","airlines_raw.carrierdelay":"string","airlines_raw.weatherdelay":"string","airlines_raw.nasdelay":"string","airlines_raw.securitydelay":"string","airlines_raw.lateaircraftdelay":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-6-78.eu-central-1.compute.internal:4040/jobs/job?id=0"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1574442531554_-643116881","id":"20190528-113331_1589196989","dateCreated":"2019-11-22T17:08:51+0000","dateStarted":"2019-11-22T18:25:49+0000","dateFinished":"2019-11-22T18:30:44+0000","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88945"},{"title":"4. Create a managed table from the external table","text":"%jdbc(hive)\nDROP TABLE IF EXISTS airlines;\nCREATE TABLE airlines STORED AS ORC AS SELECT * FROM airlines_raw;","user":"admin","dateUpdated":"2019-11-22T17:08:51+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574442531558_76759191","id":"20190528-113426_1983073818","dateCreated":"2019-11-22T17:08:51+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88946"},{"title":"5. Query the table to confirm successful creation","text":"%jdbc(hive)\nSELECT * FROM airlines;","user":"admin","dateUpdated":"2019-11-22T17:08:51+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"airlines.year":"string","airlines.month":"string","airlines.dayofmonth":"string","airlines.dayofweek":"string","airlines.deptime":"string","airlines.crsdeptime":"string","airlines.arrtime":"string","airlines.crsarrtime":"string","airlines.uniquecarrier":"string","airlines.flightnum":"string","airlines.tailnum":"string","airlines.actualelapsedtime":"string","airlines.crselapsedtime":"string","airlines.airtime":"string","airlines.arrdelay":"string","airlines.depdelay":"string","airlines.origin":"string","airlines.dest":"string","airlines.distance":"string","airlines.taxiin":"string","airlines.taxiout":"string","airlines.cancelled":"string","airlines.cancellationcode":"string","airlines.diverted":"string","airlines.carrierdelay":"string","airlines.weatherdelay":"string","airlines.nasdelay":"string","airlines.securitydelay":"string","airlines.lateaircraftdelay":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574442531559_-646816007","id":"20190528-113536_288891615","dateCreated":"2019-11-22T17:08:51+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88947"},{"text":"%md\n## Data Analysis","user":"admin","dateUpdated":"2019-11-22T17:08:51+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574442531561_596030381","id":"20190528-115043_412794029","dateCreated":"2019-11-22T17:08:51+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88948"},{"title":"6. Determine the amount of canceled flights by month and year for each airline","text":"%jdbc(hive)\nSELECT uniquecarrier, count(cancelled) AS canceledflightsamount, year, month FROM airlines GROUP BY uniquecarrier, year, month ORDER BY uniquecarrier,year ASC,month ASC","user":"admin","dateUpdated":"2019-11-22T17:08:51+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"uniquecarrier":"string","canceledflightsamount":"string","year":"string","month":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574442531562_-624101660","id":"20190528-115126_1700571367","dateCreated":"2019-11-22T17:08:51+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88949"},{"title":"7. How many flights were considered late by month and year for each  airline?","text":"%jdbc(hive)\nSELECT uniquecarrier, count(*) AS lateflights, year, month FROM airlines WHERE arrdelay > 0 GROUP BY uniquecarrier, year, month ORDER BY uniquecarrier,year ASC,month ASC","user":"admin","dateUpdated":"2019-11-22T17:08:51+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"uniquecarrier":"string","lateflights":"string","year":"string","month":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574442531563_-2143077067","id":"20190528-115208_1981632336","dateCreated":"2019-11-22T17:08:51+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88950"},{"title":"8. Determine the unique carrier with the highest delays (NASDelay and SecurityDelay)","text":"%jdbc(hive)\nSELECT uniquecarrier, count(NASDelay) + count(SecurityDelay) AS totaldelay FROM airlines GROUP BY uniquecarrier ORDER BY totaldelay DESC LIMIT 1","user":"admin","dateUpdated":"2019-11-22T17:08:51+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"uniquecarrier":"string","totaldelay":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574442531564_1906576109","id":"20190528-115248_915307060","dateCreated":"2019-11-22T17:08:51+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88951"},{"title":"9. Determine the unique carrier with the least delays","text":"%jdbc(hive)\nSELECT uniquecarrier, count(NASDelay) + count(SecurityDelay) AS totaldelay FROM airlines GROUP BY uniquecarrier ORDER BY totaldelay ASC LIMIT 1","user":"admin","dateUpdated":"2019-11-22T17:08:51+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"uniquecarrier":"string","totaldelay":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574442531565_236817099","id":"20190528-115348_484747662","dateCreated":"2019-11-22T17:08:51+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88952"},{"user":"admin","dateUpdated":"2019-11-22T17:08:51+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574442531565_-1653335844","id":"20190528-115436_379811721","dateCreated":"2019-11-22T17:08:51+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88953"}],"name":"Demos/ETLOffloadWithSpark","id":"2ESVVEMY1","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
