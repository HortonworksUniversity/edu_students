{"paragraphs":[{"text":"%md\n# About\n**Lab:** Hive Joins\n**Objective:** Become familiar with using Hive joins\n**File locations:** hostname:/tmp/movies hdfs:///data/movies\n**Successful outcome:** Understanding hive Joins\n**Before you begin:** N/A\n**Related lessons:** Hive Joins\n\n---","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>About</h1>\n<p><strong>Lab:</strong> Hive Joins\n<br  /><strong>Objective:</strong> Become familiar with using Hive joins\n<br  /><strong>File locations:</strong> hostname:/tmp/movies hdfs:///data/movies\n<br  /><strong>Successful outcome:</strong> Understanding hive Joins\n<br  /><strong>Before you begin:</strong> N/A\n<br  /><strong>Related lessons:</strong> Hive Joins</p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1591759067254_-1712134668","id":"20181126-092644_1457476546","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:46868"},{"text":"%md\n# Setup\nThis setup may have been completed in an earlier notebook","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Setup</h1>\n<p>This setup may have been completed in an earlier notebook</p>\n"}]},"apps":[],"jobName":"paragraph_1591759067256_2009318360","id":"20181201-044336_178705192","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46869"},{"title":"Retrieve the files from IMDb","text":"%sh\nrm -r /tmp/movies\nmkdir -p /tmp/movies\nwget -nv https://datasets.imdbws.com/title.basics.tsv.gz -O /tmp/movies/title.basics.tsv.gz\nwget -nv https://datasets.imdbws.com/title.crew.tsv.gz -O /tmp/movies/title.crew.tsv.gz\nwget -nv https://datasets.imdbws.com/name.basics.tsv.gz -O /tmp/movies/name.basics.tsv.gz\nwget -nv https://datasets.imdbws.com/title.ratings.tsv.gz -O /tmp/movies/title.ratings.tsv.gz\n","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591759067256_1307914261","id":"20191018-101805_1346904148","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46870"},{"title":"List the directory for /tmp/movies","text":"%sh\nls /tmp/movies","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591759067256_-439844870","id":"20200521-192545_111560186","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46871"},{"title":"Use gunzip to extract the files","text":"%sh\ngunzip /tmp/movies/title.basics.tsv.gz\ngunzip /tmp/movies/title.crew.tsv.gz\ngunzip /tmp/movies/name.basics.tsv.gz\ngunzip /tmp/movies/title.ratings.tsv.gz","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591759067257_1088365207","id":"20200521-071022_1750534377","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46872"},{"title":"List directory for /tmp/movies","text":"%sh\nls /tmp/movies","user":"sysadmin","dateUpdated":"2020-06-11T23:28:47+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"name.basics.tsv\ntitle.basics.tsv\ntitle.crew.tsv\ntitle.ratings.tsv\n"}]},"apps":[],"jobName":"paragraph_1591759067257_1917941826","id":"20191112-222001_2079180049","dateCreated":"2020-06-10T03:17:47+0000","dateStarted":"2020-06-11T23:28:47+0000","dateFinished":"2020-06-11T23:28:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:46873"},{"title":"Copy the movie data in HDFS","text":"%sh\nsudo -u hdfs hdfs dfs -rm -r -skipTrash /data/movies\nsudo -u hdfs hdfs dfs -mkdir /data/movies\nsudo -u hdfs hdfs dfs -put /tmp/movies/* /data/movies","user":"sysadmin","dateUpdated":"2020-06-11T23:30:08+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Deleted /data/movies\n"}]},"apps":[],"jobName":"paragraph_1591759067257_993596662","id":"20190606-132331_1529571930","dateCreated":"2020-06-10T03:17:47+0000","dateStarted":"2020-06-11T23:30:08+0000","dateFinished":"2020-06-11T23:30:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:46874"},{"title":"Grant Hive access to /data/movie","text":"%sh\nsudo -u hdfs hdfs dfs -chown -R hive /data/movies","user":"sysadmin","dateUpdated":"2020-06-11T23:30:52+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1591759067257_100392173","id":"20200521-071101_1320773315","dateCreated":"2020-06-10T03:17:47+0000","dateStarted":"2020-06-11T23:30:52+0000","dateFinished":"2020-06-11T23:30:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:46875"},{"title":"List the content of HDFS /data/movies","text":"%sh\nhdfs dfs -ls /data/movies","user":"sysadmin","dateUpdated":"2020-06-11T23:30:57+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Found 4 items\n-rw-r--r--   3 hive hdfs  838796238 2020-06-11 23:30 /data/movies/name.basics.tsv\n-rw-r--r--   3 hive hdfs  585035615 2020-06-11 23:30 /data/movies/title.basics.tsv\n-rw-r--r--   3 hive hdfs  223503103 2020-06-11 23:30 /data/movies/title.crew.tsv\n-rw-r--r--   3 hive hdfs   17889432 2020-06-11 23:30 /data/movies/title.ratings.tsv\n"}]},"apps":[],"jobName":"paragraph_1591759067257_-623084556","id":"20191112-222114_1642884081","dateCreated":"2020-06-10T03:17:47+0000","dateStarted":"2020-06-11T23:30:57+0000","dateFinished":"2020-06-11T23:30:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:46876"},{"title":"Create the movies database","text":"%jdbc(hive_interactive)\nDROP DATABASE IF EXISTS movies CASCADE;\n\nCREATE DATABASE movies;\n\nUSE movies;\n\n-- Contains the following information for titles\nCREATE EXTERNAL TABLE movie_title_stage (\n                        tconst string,\n                        titleType string,\n                        primaryTitle string,\n                        originalTitle string,\n                        isAdult string,\n                        startYear string,\n                        endYear string,\n                        runtimeMinutes string,\n                        genres ARRAY<STRING>\n                        ) \nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '\\t' \nLOCATION '/warehouse/tablespace/external/hive/movie_title_stage/';\n\n-- Load data\nLOAD DATA  INPATH '/data/movies/title.basics.tsv' OVERWRITE INTO TABLE movie_title_stage;\n\n-- Remove header for movie_title\nALTER TABLE movie_title_stage SET TBLPROPERTIES (\"skip.header.line.count\"=\"1\");\n\n\n-- Contains the information for directors and writers\nCREATE EXTERNAL TABLE movie_crew_stage(\n                        tconst string,\n                        directors ARRAY<STRING>,\n                        writers ARRAY<STRING>\n                        ) \nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '\\t' \nLOCATION '/warehouse/tablespace/external/hive/movie_crew_stage/';\n\n-- Load data movie_crew\nLOAD DATA  INPATH '/data/movies/title.crew.tsv' OVERWRITE INTO TABLE movie_crew_stage;\n\n-- Remove header for movie_crew\nALTER TABLE movie_crew_stage SET TBLPROPERTIES (\"skip.header.line.count\"=\"1\");\n\n-- Contains the information for names\nCREATE EXTERNAL TABLE movie_crew_info_stage(\n                        nconst string,\n                        primaryName string,\n                        birthYear string,\n                        deathYear string,\n                        primaryProfession ARRAY<STRING>,\n                        knownForTitles ARRAY<STRING>\n                        )\nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '\\t' \nLOCATION '/warehouse/tablespace/external/hive/movie_crew_info_stage/';\n\n-- Load data movie_crew_info\nLOAD DATA  INPATH '/data/movies/name.basics.tsv' OVERWRITE INTO TABLE movie_crew_info_stage;\n\n-- Remove header for movie_crew_info\nALTER TABLE movie_crew_info_stage SET TBLPROPERTIES (\"skip.header.line.count\"=\"1\");\n\n\n-- Ratings and vote information for titles\nCREATE EXTERNAL TABLE ratings_stage(\n                        tconst string,\n                        averageRting double,\n                        numVotes int\n                        ) \nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '\\t' \nLOCATION '/warehouse/tablespace/external/hive/ratings_stage/';\n\n\n-- Load data ratings\nLOAD DATA  INPATH '/data/movies/title.ratings.tsv' OVERWRITE INTO TABLE ratings_stage;\n\n-- Remove header for ratings\nALTER TABLE ratings_stage SET TBLPROPERTIES (\"skip.header.line.count\"=\"1\");\n","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591759067257_1889516090","id":"20190606-132416_510216579","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46877"},{"text":"%md\n# Lab\n","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Lab</h1>\n"}]},"apps":[],"jobName":"paragraph_1591759067257_-679493499","id":"20181126-093358_358613711","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46878"},{"text":"%md\nWe are going to use the new movie database. You can do a describe on the tables.\n\n~~~\nuse movies;\ndescribe movie_title;\ndescribe movie_crew;\ndescribe movie_crew_info;\ndescribe ratings;\n~~~\n\nReview the tables to determine keys to join.","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We are going to use the new movie database. You can do a describe on the tables.</p>\n<pre><code>use movies;\ndescribe movie_title;\ndescribe movie_crew;\ndescribe movie_crew_info;\ndescribe ratings;\n</code></pre>\n<p>Review the tables to determine keys to join.</p>\n"}]},"apps":[],"jobName":"paragraph_1591759067257_1566902443","id":"20181201-173003_1022275665","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46879"},{"title":"1 - Use movies database and create a join for  the movie_title_stage and rating_stage tables. Show the title type, primary title ,original title and average rating. Limit 5","text":"","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"2":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"3":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591759067257_320824746","id":"20181126-094403_539011278","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46880"},{"title":"2 - Execute the Explain Plan on the Join statement","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591759067258_-1165990796","id":"20200521-072822_742234962","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46881"},{"title":"3 - Join the movie_crew_info_stage table to the movie_crew_stage table. Display the Title Type, Original Title, Movie Title, Start Year, Primary name of crew member, crew member birth year and primary profession. ( Hint: You may need to use the substring UDF on the table keys.)","text":"","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591759067258_-1240137895","id":"20181018-110639_553156023","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46882"},{"title":"4 - Execute the Explain Plan on the Join statement ","text":"","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591759067258_1332576235","id":"20181126-095334_1706920776","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46883"},{"text":"%md\nWe are going to create a materialized view using a table join.\n\n~~~\nCreate a materialized view  mv_movie_ratings that joins tables movie_title and rating. \nInclude only the movies that have a start year after 2001 and an average rating greater than 5.5. (Limit to 5 rows.) \n~~~\n\nBut first we need to drop the materialized view if it already exists.","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We are going to create a materialized view using a table join.</p>\n<pre><code>Create a materialized view  mv_movie_ratings that joins tables movie_title and rating. \nInclude only the movies that have a start year after 2001 and an average rating greater than 5.5. (Limit to 5 rows.) \n</code></pre>\n<p>But first we need to drop the materialized view if it already exists.</p>\n"}]},"apps":[],"jobName":"paragraph_1591759067258_-2080644387","id":"20181203-225219_1680906315","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46884"},{"title":"5 - Drop the materialized view if exist","text":"\n","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591759067258_1108409381","id":"20181204-010437_1605522409","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46885"},{"title":"6 - Create the materialized view","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591759067258_-1149086075","id":"20200521-071445_1738127090","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46886"},{"title":"7 - Execute a Query on the materialized view. Limit 5","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591759067258_-1327195567","id":"20181216-023545_1023157428","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46887"},{"text":"%md\n###Optional Challenge:\nTry to join the movie_title, rating and movie_crew and movie_crew_info","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Optional Challenge:</h3>\n<p>Try to join the movie_title, rating and movie_crew and movie_crew_info</p>\n"}]},"apps":[],"jobName":"paragraph_1591759067258_1465319160","id":"20181217-205332_741870945","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46888"},{"title":"Optional Challenge:","text":"\n","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591759067258_-782333084","id":"20181217-205355_605112851","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46889"},{"text":"%md\n# Result\n**You have now:** You have now successfully created a join in Hive\n\n---","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Result</h1>\n<p><strong>You have now:</strong> You have now successfully created a join in Hive</p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1591759067258_2104412137","id":"20181126-133507_1472573213","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46890"},{"text":"%md\n# Solution\n---","user":"sysadmin","dateUpdated":"2020-06-10T03:17:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Solution</h1>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1591759067259_-1899032111","id":"20181018-125200_1133281582","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46891"},{"title":"1 - Use movies database and create a join for movie_title_stage and rating_stage title using the tconst key. Show the title type, primary title ,original title and average rating. Limit 5","text":"%jdbc(hive_interactive)\nSELECT movie_title_stage.titleType, movie_title_stage.primaryTitle, movie_title_stage.originalTitle, ratings_stage.averageRting FROM movie_title_stage JOIN ratings_stage ON (movie_title_stage.tconst=ratings_stage.tconst) LIMIT 5;\n","user":"sysadmin","dateUpdated":"2020-06-11T23:31:15+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movie_title_stage.titletype":"string","movie_title_stage.primarytitle":"string","movie_title_stage.originaltitle":"string","ratings_stage.averagerting":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"2":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"3":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movie_title_stage.titletype\tmovie_title_stage.primarytitle\tmovie_title_stage.originaltitle\tratings_stage.averagerting\nmovie\tToulouse-Lautrec, l'insaisissable\tToulouse-Lautrec, l'insaisissable\t8.5\ntvEpisode\tDarby's Tail/Tigger's Delivery Service\tDarby's Tail/Tigger's Delivery Service\t7.8\ntvEpisode\tSuicide Hotel\tSuicide Hotel\t7.7\ntvMiniSeries\tWhite House Farm\tWhite House Farm\t7.3\ntvEpisode\tFlirting with Disaster\tFlirting with Disaster\t8.4\n"}]},"apps":[],"jobName":"paragraph_1591759067259_-999692763","id":"20181018-110338_1899474794","dateCreated":"2020-06-10T03:17:47+0000","dateStarted":"2020-06-11T23:31:15+0000","dateFinished":"2020-06-11T23:31:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:46892"},{"title":"2 - Execute the Explain Plan on the Join statement","text":"%jdbc(hive_interactive)\nEXPLAIN SELECT movie_title_stage.titleType, movie_title_stage.primaryTitle, movie_title_stage.originalTitle, ratings_stage.averageRting FROM movie_title_stage JOIN ratings_stage ON (movie_title_stage.tconst=ratings_stage.tconst) LIMIT 5;\n","user":"sysadmin","dateUpdated":"2020-06-11T23:31:43+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Explain\nPlan optimized by CBO.\n\nVertex dependency in root stage\nMap 1 <- Map 2 (BROADCAST_EDGE)\n\nStage-0\n  Fetch Operator\n    limit:5\n    Stage-1\n      Map 1 llap\n      File Output Operator [FS_11]\n        Limit [LIM_10] (rows=5 width=699)\n          Number of rows:5\n          Select Operator [SEL_9] (rows=2105241 width=699)\n            Output:[\"_col0\",\"_col1\",\"_col2\",\"_col3\"]\n            Map Join Operator [MAPJOIN_16] (rows=2105241 width=699)\n              Conds:SEL_2._col0=RS_7._col0(Inner),Output:[\"_col1\",\"_col2\",\"_col3\",\"_col5\"]\n            <-Map 2 [BROADCAST_EDGE] llap\n              BROADCAST [RS_7]\n                PartitionCols:_col0\n                Select Operator [SEL_5] (rows=574154 width=182)\n                  Output:[\"_col0\",\"_col1\"]\n                  Filter Operator [FIL_15] (rows=574154 width=182)\n                    predicate:tconst is not null\n                    TableScan [TS_3] (rows=604372 width=182)\n                      movies@ratings_stage,ratings_stage,Tbl:COMPLETE,Col:NONE,Output:[\"tconst\",\"averagerting\"]\n            <-Select Operator [SEL_2] (rows=1913856 width=699)\n                Output:[\"_col0\",\"_col1\",\"_col2\",\"_col3\"]\n                Filter Operator [FIL_14] (rows=1913856 width=699)\n                  predicate:tconst is not null\n                  TableScan [TS_0] (rows=2014585 width=699)\n                    movies@movie_title_stage,movie_title_stage,Tbl:COMPLETE,Col:NONE,Output:[\"tconst\",\"titletype\",\"primarytitle\",\"originaltitle\"]\n\n"}]},"apps":[],"jobName":"paragraph_1591759067259_-457804749","id":"20200521-073014_1477342534","dateCreated":"2020-06-10T03:17:47+0000","dateStarted":"2020-06-11T23:31:43+0000","dateFinished":"2020-06-11T23:31:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:46893"},{"title":"3 - Join the movie_crew_info_stage table to the movie_crew_stage table. Display the Title Type, Original Title, Movie Title, Start Year, Primary name of crew member, crew member birth year and primary profession. ( Hint: You may need to use the substring UDF on the table keys.)","text":"%jdbc(hive_interactive)\nSELECT movie_title_stage.titleType,movie_title_stage.originalTitle,movie_title_stage.startYear, movie_crew_info_stage.primaryname,movie_crew_info_stage.birthyear,movie_crew_info_stage.primaryprofession FROM movie_title_stage JOIN movie_crew_info_stage \nON (SUBSTR(movie_title_stage.tconst,3,9) = SUBSTR(movie_crew_info_stage.nconst,3,9)) LIMIT 5;\n","user":"sysadmin","dateUpdated":"2020-06-11T23:31:47+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movie_title_stage.titletype":"string","movie_title_stage.originaltitle":"string","movie_title_stage.startyear":"string","movie_crew_info_stage.primaryname":"string","movie_crew_info_stage.birthyear":"string","movie_crew_info_stage.primaryprofession":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movie_title_stage.titletype\tmovie_title_stage.originaltitle\tmovie_title_stage.startyear\tmovie_crew_info_stage.primaryname\tmovie_crew_info_stage.birthyear\tmovie_crew_info_stage.primaryprofession\ntvEpisode\tPossessor\t2019\tKabeer Kumar\tnull\t[\"assistant_director\"]\ntvEpisode\tEpisode #1.8\t2014\tRii Coleman\tnull\t[]\ntvEpisode\tPrelude to Terminal Fate\t2019\tMichael V. Meed\tnull\t[]\nvideo\tIzzy-S: Free My Nigga Freestyle\t2015\tEd Geronia\tnull\t[\"writer\"]\ntvEpisode\tJeremy Kyle: TV on Trial\t2019\tPaul Bennett\tnull\t[\"actor\"]\n"}]},"apps":[],"jobName":"paragraph_1591759067259_-1720947140","id":"20181126-094450_1417148698","dateCreated":"2020-06-10T03:17:47+0000","dateStarted":"2020-06-11T23:31:47+0000","dateFinished":"2020-06-11T23:32:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:46894"},{"title":"4 - Execute the Explain Plans on the Join statement","text":"%jdbc(hive_interactive)\nEXPLAIN SELECT movie_title_stage.titleType,movie_title_stage.originalTitle,movie_title_stage.startYear, movie_crew_info_stage.primaryname,movie_crew_info_stage.birthyear,movie_crew_info_stage.primaryprofession from movie_title_stage JOIN movie_crew_info_stage \nON (SUBSTR(movie_title_stage.tconst,3,9) = SUBSTR(movie_crew_info_stage.nconst,3,9)) LIMIT 5;\n","user":"sysadmin","dateUpdated":"2020-06-11T23:32:17+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dc_comics_acid_insert.page_id":"string","dc_comics_acid_insert.name":"string","dc_comics_acid_insert.urlslug":"string","dc_comics_acid_insert.id":"string","dc_comics_acid_insert.align":"string","dc_comics_acid_insert.eye":"string","dc_comics_acid_insert.hair":"string","dc_comics_acid_insert.sex":"string","dc_comics_acid_insert.gsm":"string","dc_comics_acid_insert.alive":"string","dc_comics_acid_insert.appearances":"string","dc_comics_acid_insert.first_appearances":"string","dc_comics_acid_insert.year":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Explain\nPlan optimized by CBO.\n\nVertex dependency in root stage\nMap 2 <- Map 1 (BROADCAST_EDGE)\n\nStage-0\n  Fetch Operator\n    limit:5\n    Stage-1\n      Map 2 llap\n      File Output Operator [FS_11]\n        Limit [LIM_10] (rows=5 width=699)\n          Number of rows:5\n          Select Operator [SEL_9] (rows=2105241 width=699)\n            Output:[\"_col0\",\"_col1\",\"_col2\",\"_col3\",\"_col4\",\"_col5\"]\n            Map Join Operator [MAPJOIN_16] (rows=2105241 width=699)\n              Conds:RS_6.substr(_col0, 3, 9)=SEL_5.substr(_col0, 3, 9)(Inner),Output:[\"_col1\",\"_col2\",\"_col3\",\"_col5\",\"_col6\",\"_col7\"]\n            <-Map 1 [BROADCAST_EDGE] llap\n              BROADCAST [RS_6]\n                PartitionCols:substr(_col0, 3, 9)\n                Select Operator [SEL_2] (rows=1913856 width=699)\n                  Output:[\"_col0\",\"_col1\",\"_col2\",\"_col3\"]\n                  Filter Operator [FIL_14] (rows=1913856 width=699)\n                    predicate:substr(tconst, 3, 9) is not null\n                    TableScan [TS_0] (rows=2014585 width=699)\n                      movies@movie_title_stage,movie_title_stage,Tbl:COMPLETE,Col:NONE,Output:[\"tconst\",\"titletype\",\"originaltitle\",\"startyear\"]\n            <-Select Operator [SEL_5] (rows=1801213 width=2348)\n                Output:[\"_col0\",\"_col1\",\"_col2\",\"_col3\"]\n                Filter Operator [FIL_15] (rows=1801213 width=2348)\n                  predicate:substr(nconst, 3, 9) is not null\n                  TableScan [TS_3] (rows=1896013 width=2348)\n                    movies@movie_crew_info_stage,movie_crew_info_stage,Tbl:COMPLETE,Col:NONE,Output:[\"nconst\",\"primaryname\",\"birthyear\",\"primaryprofession\"]\n\n"}]},"apps":[],"jobName":"paragraph_1591759067259_545147294","id":"20181018-110637_1031040934","dateCreated":"2020-06-10T03:17:47+0000","dateStarted":"2020-06-11T23:32:17+0000","dateFinished":"2020-06-11T23:32:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:46895"},{"title":"5 - Drop the materialized view if exists","text":"%jdbc(hive_interactive)\nDROP MATERIALIZED VIEW IF EXISTS movies.mv_movie_ratings;\n\n","user":"sysadmin","dateUpdated":"2020-06-11T23:32:20+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1591759067259_-878284217","id":"20181018-111736_1626489692","dateCreated":"2020-06-10T03:17:47+0000","dateStarted":"2020-06-11T23:32:21+0000","dateFinished":"2020-06-11T23:32:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:46896"},{"title":"6 - Create the materialized view","text":"%jdbc(hive_interactive)\nCREATE MATERIALIZED VIEW IF NOT EXISTS movies.mv_movie_ratings AS SELECT movie_title_stage.titleType, movie_title_stage.primaryTitle, movie_title_stage.originalTitle, ratings_stage.averageRting from movie_title_stage JOIN ratings_stage ON (movie_title_stage.tconst=ratings_stage.tconst) where movie_title_stage.startYear> 2001 and ratings_stage.averageRting >5.5;","user":"sysadmin","dateUpdated":"2020-06-11T23:32:22+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1591759067259_-1126699758","id":"20200521-072408_702133135","dateCreated":"2020-06-10T03:17:47+0000","dateStarted":"2020-06-11T23:32:22+0000","dateFinished":"2020-06-11T23:32:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:46897"},{"title":"7 - Execute a Query on the materialized view. Limit 5","text":"%jdbc(hive_interactive)\nSELECT * FROM movies.mv_movie_ratings LIMIT 5;\n","user":"sysadmin","dateUpdated":"2020-06-11T23:32:42+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"mv_movie_ratings.titletype":"string","mv_movie_ratings.primarytitle":"string","mv_movie_ratings.originaltitle":"string","mv_movie_ratings.averagerting":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"mv_movie_ratings.titletype\tmv_movie_ratings.primarytitle\tmv_movie_ratings.originaltitle\tmv_movie_ratings.averagerting\nmovie\tToulouse-Lautrec, l'insaisissable\tToulouse-Lautrec, l'insaisissable\t8.5\ntvEpisode\tDarby's Tail/Tigger's Delivery Service\tDarby's Tail/Tigger's Delivery Service\t7.8\ntvEpisode\tSuicide Hotel\tSuicide Hotel\t7.7\ntvMiniSeries\tWhite House Farm\tWhite House Farm\t7.3\ntvEpisode\tFlirting with Disaster\tFlirting with Disaster\t8.4\n"}]},"apps":[],"jobName":"paragraph_1591759067259_81448757","id":"20181216-031305_1172702300","dateCreated":"2020-06-10T03:17:47+0000","dateStarted":"2020-06-11T23:32:43+0000","dateFinished":"2020-06-11T23:32:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:46898"},{"text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Apache Spark Tutorials](http://hortonworks.com/tutorials/#tuts-developers) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community Connection (HCC)](https://community.hortonworks.com/spaces/85/data-science.html?type=question) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Cloudera Apache Spark Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html) - official Spark documentation.\n4. [Cloudera Apache Zeppelin Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html) - official Zeppelin documentation.\n","user":"sysadmin","dateUpdated":"2020-06-11T23:32:31+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We hope you've enjoyed this lab. Below are additional resources that you should find useful:</p>\n<ol>\n<li><a href=\"http://hortonworks.com/tutorials/#tuts-developers\">Cloudera Apache Spark Tutorials</a> are your natural next step where you can explore Spark in more depth.</li>\n<li><a href=\"https://community.hortonworks.com/spaces/85/data-science.html?type=question\">Cloudera Community Connection (HCC)</a> is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html\">Cloudera Apache Spark Docs</a> - official Spark documentation.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html\">Cloudera Apache Zeppelin Docs</a> - official Zeppelin documentation.</li>\n</ol>\n"}]},"apps":[],"jobName":"paragraph_1591759067259_-163107763","id":"20181126-133017_244739700","dateCreated":"2020-06-10T03:17:47+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46899"}],"name":"Hive/06-Joins","id":"2FD6M55W5","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}