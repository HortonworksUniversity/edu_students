{"paragraphs":[{"text":"%md\n# About\n**Lab:** Hive File Formats\n**Objective:** Become familiar with using Hive with different file formats\n**File locations:** hostname:/tmp/dc hdfs://data/dc/dc-wikia-data.csv\n**Successful outcome:** Understanding hive file formats\n**Before you begin:**\n**Related lessons:** Hive File Formats\n\n---","user":"sysadmin","dateUpdated":"2020-05-22T00:02:00+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>About</h1>\n<p><strong>Lab:</strong> Hive Partitions\n<br  /><strong>Objective:</strong> Become familiar with using Hive partitions\n<br  /><strong>File locations:</strong> hostname:/tmp/movies  hdfs:///data/movies\n<br  /><strong>Successful outcome:</strong> Understanding hive partitions\n<br  /><strong>Before you begin:</strong> N/A\n<br  /><strong>Related lessons:</strong> Hive Partitions and Bucketing</p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1590103582544_-1148569457","id":"20181126-092644_1457476546","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19892"},{"text":"%md\n# Setup","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Setup</h1>\n"}]},"apps":[],"jobName":"paragraph_1590103582549_1070273890","id":"20181201-044336_178705192","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19893"},{"title":"Retrieve the movie files from IMDb","text":"%sh\nrm -r /tmp/movies\nmkdir -p /tmp/movies\nwget -nv https://datasets.imdbws.com/title.basics.tsv.gz -O /tmp/movies/title.basics.tsv.gz\nwget -nv https://datasets.imdbws.com/title.crew.tsv.gz -O /tmp/movies/title.crew.tsv.gz\nwget -nv https://datasets.imdbws.com/name.basics.tsv.gz -O /tmp/movies/name.basics.tsv.gz\nwget -nv https://datasets.imdbws.com/title.ratings.tsv.gz -O /tmp/movies/title.ratings.tsv.gz\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582549_-1521094707","id":"20191018-091923_657123172","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19894"},{"title":"List the directory for /tmp/movies","text":"%sh\nls /tmp/movies","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582549_-1024681523","id":"20200521-060241_1850983096","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19895"},{"title":"Use gunzip to extract the files","text":"%sh\ngunzip /tmp/movies/title.basics.tsv.gz\ngunzip /tmp/movies/title.crew.tsv.gz\ngunzip /tmp/movies/name.basics.tsv.gz\ngunzip /tmp/movies/title.ratings.tsv.gz","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":true,"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582549_-1529185986","id":"20200521-060054_1193914029","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19896"},{"title":"List the directory for /tmp/movies","text":"%sh\nls /tmp/movies","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582549_618189238","id":"20191112-215256_2038626591","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19897"},{"title":"Copy the movie data in HDFS","text":"%sh\nsudo -u hdfs hdfs dfs -rm -r -skipTrash /data/movies\nsudo -u hdfs hdfs dfs -mkdir /data/movies\nsudo -u hdfs hdfs dfs -put /tmp/movies/* /data/movies","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582549_1646709864","id":"20190606-110748_33574834","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19898"},{"title":"Grant Hive access to /data/movies","text":"%sh\nsudo -u hdfs hdfs dfs -chown -R hive /data/movies","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582550_1396752460","id":"20200521-061453_1473775353","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19899"},{"title":"List the content of HDFS /data/movies","text":"%sh\nhdfs dfs -ls /data/movies","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582550_-951713191","id":"20191112-215736_1847535885","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19900"},{"title":"Create the movies database","text":"%jdbc(hive_interactive)\n\nDROP DATABASE IF EXISTS movies CASCADE;\n\nCREATE DATABASE movies;\n\nUSE movies;\n\n-- Contains the following information for titles\nCREATE EXTERNAL TABLE movie_title_stage (\n                        tconst string,\n                        titleType string,\n                        primaryTitle string,\n                        originalTitle string,\n                        isAdult string,\n                        startYear string,\n                        endYear string,\n                        runtimeMinutes string,\n                        genres ARRAY<STRING>\n                        ) \nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '\\t' \nLOCATION '/warehouse/tablespace/external/hive/movie_title_stage/';\n\n-- Load data\nLOAD DATA  INPATH '/data/movies/title.basics.tsv' OVERWRITE INTO TABLE movie_title_stage;\n\n-- Remove header for movie_title\nALTER TABLE movie_title_stage SET TBLPROPERTIES (\"skip.header.line.count\"=\"1\");\n\n\n-- Contains the information for directors and writers\nCREATE EXTERNAL TABLE movie_crew_stage(\n                        tconst string,\n                        directors ARRAY<STRING>,\n                        writers ARRAY<STRING>\n                        ) \nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '\\t' \nLOCATION '/warehouse/tablespace/external/hive/movie_crew_stage/';\n\n-- Load data movie_crew\nLOAD DATA  INPATH '/data/movies/title.crew.tsv' OVERWRITE INTO TABLE movie_crew_stage;\n\n-- Remove header for movie_crew\nALTER TABLE movie_crew_stage SET TBLPROPERTIES (\"skip.header.line.count\"=\"1\");\n\n-- Contains the information for names\nCREATE EXTERNAL TABLE movie_crew_info_stage(\n                        nconst string,\n                        primaryName string,\n                        birthYear string,\n                        deathYear string,\n                        primaryProfession ARRAY<STRING>,\n                        knownForTitles ARRAY<STRING>\n                        )\nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '\\t' \nLOCATION '/warehouse/tablespace/external/hive/movie_crew_info_stage/';\n\n-- Load data movie_crew_info\nLOAD DATA  INPATH '/data/movies/name.basics.tsv' OVERWRITE INTO TABLE movie_crew_info_stage;\n\n-- Remove header for movie_crew_info\nALTER TABLE movie_crew_info_stage SET TBLPROPERTIES (\"skip.header.line.count\"=\"1\");\n\n\n-- Ratings and vote information for titles\nCREATE EXTERNAL TABLE ratings_stage(\n                        tconst string,\n                        averageRting double,\n                        numVotes int\n                        ) \nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '\\t' \nLOCATION '/warehouse/tablespace/external/hive/ratings_stage/';\n\n\n-- Load data ratings\nLOAD DATA  INPATH '/data/movies/title.ratings.tsv' OVERWRITE INTO TABLE ratings_stage;\n\n-- Remove header for ratings\nALTER TABLE ratings_stage SET TBLPROPERTIES (\"skip.header.line.count\"=\"1\");","user":"sysadmin","dateUpdated":"2020-05-22T17:56:12+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582550_-433898053","id":"20190606-095119_1754382374","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19901"},{"text":"%md\n# Lab\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Lab</h1>\n"}]},"apps":[],"jobName":"paragraph_1590103582550_1887908507","id":"20181126-093358_358613711","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19902"},{"text":"%md\nWe are going to use the new movie database and do a describe on the tables listed  below\n\n~~~\nuse movies;\ndescribe movie_title_stage;\ndescribe movie_crew_stage;\ndescribe movie_crew_info_stage;\ndescribe ratings_stage;\n~~~\n\nAlso, try some queries on the tables for practice. Limit your data to 5 rows.","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We are going to use the new movie database and do a describe on the tables listed  below</p>\n<pre><code>use movies;\ndescribe movie_title_stage;\ndescribe movie_crew_stage;\ndescribe movie_crew_info_stage;\ndescribe ratings_stage;\n</code></pre>\n<p>Also, try some queries on the tables for practice. Limit your data to 5 rows.</p>\n"}]},"apps":[],"jobName":"paragraph_1590103582550_-1249095868","id":"20181201-173003_1022275665","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19903"},{"title":"1 - Use movies database and describe tables","text":"","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"2":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"3":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582551_117895126","id":"20181126-094403_539011278","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19904"},{"title":"2 - Count the rows in the tables","text":"\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582551_1965367535","id":"20200521-075819_1366956671","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19905"},{"title":"3 - Query the table movie_titles_stage limit 5","text":"","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582551_-469636777","id":"20181018-110639_553156023","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19906"},{"text":"%md\nIn the next cell execute the following command:\n```console\nEXPLAIN EXTENDED Select count(*) from movie_title where startYear='1999';\n```","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In the next cell execute the following command:</p>\n<pre><code class=\"console\">EXPLAIN EXTENDED Select count(*) from movie_title where startYear='1999';\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1590103582551_-919757329","id":"20181203-223948_1133465454","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19907"},{"title":"4 - Execute Explain Plan","text":"","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582551_237186419","id":"20181126-095334_1706920776","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19908"},{"text":"%md\nWe are going to create a table that is partitioned using dynamic partitioning\n\n~~~\nCREATE EXTERNAL TABLE  movie_title_partition( \n                        tconst string,\n                        titleType string,\n                        primaryTitle string,\n                        originalTitle string,\n                        isAdult string,\n                        endYear string,\n                        runtimeMinutes string,\n                        genres ARRAY<STRING>\n                        ) \nPARTITIONED BY (startYear string)\nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '\\t' \nLOCATION '/warehouse/tablespace/external/hive/movie_title_partition/';\n\nDESCRIBE FORMATTED movie_title_partition;\n\nINSERT INTO TABLE movie_title_partition\nPARTITION(startYear)\nSELECT tconst,titleType,primaryTitle,originalTitle,isAdult,endYear,runtimeMinutes,genres,startYear\nFROM movie_title_stage;\n\n\n~~~\n\nBut first we need to drop the table if it already exists.","user":"sysadmin","dateUpdated":"2020-05-22T17:56:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We are going to create a table that is partitioned using dynamic partitioning</p>\n<pre><code>CREATE EXTERNAL TABLE  movie_title_partition( \n                        tconst string,\n                        titleType string,\n                        primaryTitle string,\n                        originalTitle string,\n                        isAdult string,\n                        endYear string,\n                        runtimeMinutes string,\n                        genres ARRAY&lt;STRING&gt;\n                        ) \nPARTITIONED BY (startYear string)\nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '\\t' \nLOCATION '/warehouse/tablespace/external/hive/movie_title_partition/';\n\nDESCRIBE FORMATTED movie_title_partition;\n\nINSERT INTO TABLE movie_title_partition\nPARTITION(startYear)\nSELECT tconst,titleType,primaryTitle,originalTitle,isAdult,endYear,runtimeMinutes,genres,startYear\nFROM movie_title_stage;\n</code></pre>\n<p>But first we need to drop the table if it already exists.</p>\n"}]},"apps":[],"jobName":"paragraph_1590103582551_1037014121","id":"20181203-225219_1680906315","dateCreated":"2020-05-21T23:26:22+0000","dateStarted":"2020-05-22T17:56:46+0000","dateFinished":"2020-05-22T17:56:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:19909"},{"title":"5 - Drop the movie_title_partition table","text":"\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582552_1793138534","id":"20181204-010437_1605522409","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19910"},{"title":"6 - Create the movie_title_partition table","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582552_799376212","id":"20200521-061812_38094239","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19911"},{"title":"7 - Load movie_title_partition using table movie_title_stage ","text":"\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582552_-2130451104","id":"20181203-230842_273863334","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19912"},{"title":"8 - Execute the same explain plan query on the new table","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582552_-654312635","id":"20181203-235120_980568715","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19913"},{"text":"%md\n### What are some differences between the explain plans?","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>What are some differences between the explain plans?</h3>\n"}]},"apps":[],"jobName":"paragraph_1590103582552_357048045","id":"20181204-001102_1217012735","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19914"},{"text":"%md\n### We are going to create another partitioned table...\nMake a new external table from the movie_crew_info table and Partition the table  by birthYear\n\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>We are going to create another partitioned table&hellip;</h3>\n<p>Make a new external table from the movie_crew_info table and Partition the table  by birthYear</p>\n"}]},"apps":[],"jobName":"paragraph_1590103582552_962255996","id":"20181204-000517_618949634","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19915"},{"title":"9 - Drop the table movie_crew_info_partition if exists","text":"","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"stock_exchange":"string","stock_symbol":"string","stock_date":"string","stock_price_open":"string","stock_price_high":"string","stock_price_low":"string","stock_price_close":"string","stock_volume":"string","stock_price_adj_close":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582552_-883913487","id":"20181126-095509_674195979","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19916"},{"title":"10 - Create the table movie_crew_info_partition","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582553_715874110","id":"20200521-061920_68055052","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19917"},{"title":"11 - Load the table movie_crew_info_partition","text":"","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582553_-261021918","id":"20181126-095817_1749585937","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19918"},{"title":"12 - Execute a query on the table on a specific birth years","text":"","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582553_-1247155878","id":"20181126-131410_2059805867","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19919"},{"text":"%md\nIn a new paragraph show the partitions on the movie_tittle_partitions table\n```console\n%jdbc(hive_interactive)\nshow partitions movie_crew_info_partition;\n```","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>In a new paragraph show the partitions on the movie_tittle_partitions table</p>\n<pre><code class=\"console\">%jdbc(hive_interactive)\nshow partitions movie_crew_info_partition;\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1590103582553_231570017","id":"20181201-193217_1030043204","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19920"},{"title":"13 - List the partitions for the partitioned table","text":"\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582553_-1519803435","id":"20190606-101159_1857183606","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19921"},{"title":"14 - Use HDFS to list /warehouse/tablespace/external/hive/movie_crew_info_partition/","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582553_644030799","id":"20200521-064026_1931684886","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19922"},{"text":"%md\n#Practice SQL","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Practice SQL</h1>\n"}]},"apps":[],"jobName":"paragraph_1590103582553_-1667251459","id":"20181204-001505_340371368","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19923"},{"title":"15 - Execute a query on the partitioned movie title table. Find the  title in uppercase of all the  movies that are short genre and have a runtime over 60 minutes.","text":"\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582554_308119505","id":"20181204-001519_78494032","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19924"},{"title":"16 - Delete all of the movie titles that have a start year of 1959? ( What happens?) Try to solve. Hint: Hive ACID","text":"\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582554_-1755359449","id":"20181204-011317_2037143876","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19925"},{"title":"17 -  What's the total runtime minutes of  short titles in 2001?","text":"","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582554_1964385587","id":"20181204-012052_811714695","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19926"},{"text":"%md\n# Result\n**You have now:** You have now successfully created a Hive partitioned table and ran queries on the tables.\n\n---","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Result</h1>\n<p><strong>You have now:</strong> You have now successfully created a Hive partitioned table and ran queries on the tables.</p>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1590103582554_599817348","id":"20181126-133507_1472573213","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19927"},{"text":"%md\n# Solution\n---","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Solution</h1>\n<hr />\n"}]},"apps":[],"jobName":"paragraph_1590103582554_1174659351","id":"20181018-125200_1133281582","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19928"},{"title":"1 - Use movies database and describe tables","text":"%jdbc(hive_interactive)\nuse movies;\ndescribe movie_title_stage;\ndescribe movie_crew_stage;\ndescribe movie_crew_info_stage;\ndescribe ratings_stage;","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"2":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"3":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"4":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582554_1961825160","id":"20181018-110338_1899474794","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19929"},{"title":"2 - Count the rows in all tables","text":"%jdbc(hive_interactive)\nSELECT count(*) FROM movie_title_stage;\nSELECT count(*) FROM movie_crew_stage;\nSELECT count(*) FROM movie_crew_info_stage;\nSELECT count(*) FROM ratings_stage;\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"2":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"_c0":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"3":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"_c0":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582555_1529923873","id":"20200521-080145_211398482","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19930"},{"title":"3 - Query the table movie_title_stage limit 5","text":"%jdbc(hive_interactive)\nSELECT * FROM movie_title_stage limit 5;","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movie_title_stage.tconst":"string","movie_title_stage.titletype":"string","movie_title_stage.primarytitle":"string","movie_title_stage.originaltitle":"string","movie_title_stage.isadult":"string","movie_title_stage.startyear":"string","movie_title_stage.endyear":"string","movie_title_stage.runtimeminutes":"string","movie_title_stage.genres":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582555_16953719","id":"20181126-094450_1417148698","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19931"},{"title":"4 - Execute Explain Plan","text":"%jdbc(hive_interactive)\nEXPLAIN EXTENDED Select count(*) from movie_title_stage where startYear='1999';","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582555_-119534045","id":"20181126-095018_538251360","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19932"},{"title":"5 - Drop the movie_title_partition table","text":"%jdbc(hive_interactive)\nDRoP TABLE IF EXISTS movie_title_partiton;","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582555_-2013148435","id":"20200521-062320_2002578865","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19933"},{"title":"6 - Create the movie_title_partition table","text":"%jdbc(hive_interactive)\n\nCREATE EXTERNAL TABLE  movie_title_partition( \n                        tconst string,\n                        titleType string,\n                        primaryTitle string,\n                        originalTitle string,\n                        isAdult string,\n                        endYear string,\n                        runtimeMinutes string,\n                        genres ARRAY<STRING>\n                        ) \nPARTITIONED BY (startYear string)\nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '\\t' \nLOCATION '/warehouse/tablespace/external/hive/movie_title_partition/';\n","user":"sysadmin","dateUpdated":"2020-05-22T17:57:08+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dc_comics_acid_insert.page_id":"string","dc_comics_acid_insert.name":"string","dc_comics_acid_insert.urlslug":"string","dc_comics_acid_insert.id":"string","dc_comics_acid_insert.align":"string","dc_comics_acid_insert.eye":"string","dc_comics_acid_insert.hair":"string","dc_comics_acid_insert.sex":"string","dc_comics_acid_insert.gsm":"string","dc_comics_acid_insert.alive":"string","dc_comics_acid_insert.appearances":"string","dc_comics_acid_insert.first_appearances":"string","dc_comics_acid_insert.year":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582555_-1627945020","id":"20181018-110637_1031040934","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19934"},{"title":"7 - Load movie_title_partition using table movie_title","text":"%jdbc(hive_interactive)\nUSE movies;\nINSERT INTO TABLE movie_title_partition\nPARTITION(startYear)\nSELECT tconst,titleType,primaryTitle,originalTitle,isAdult,endYear,runtimeMinutes,genres,startYear\nFROM movie_title_stage;","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582555_1224501944","id":"20181018-111736_1626489692","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19935"},{"title":"8 - Execute the same explain plan query on the new table","text":"%jdbc(hive_interactive)\nEXPLAIN EXTENDED SELECT count(*) FROM movie_title_partition WHERE startYear='1999';","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582556_1697552234","id":"20181018-110351_344629664","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19936"},{"title":"9 - Drop the table movie_crew_info_partition if exists","text":"%jdbc(hive_interactive)\nDROP TABLE IF EXISTS movie_crew_info_partition;","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582556_-82771648","id":"20200521-062617_1838967956","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19937"},{"title":"10 - Create the table movie_crew_info_partition","text":"%jdbc(hive_interactive)\nCREATE EXTERNAL TABLE movie_crew_info_partition( \n                        nconst string,\n                        primaryName string,\n                        deathYear string,\n                        primaryProfession ARRAY<STRING>,\n                        knownForTitles ARRAY<STRING>\n                        ) \nPARTITIONED BY (birthYear string )\nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '\\t' \nLOCATION '/warehouse/tablespace/external/hive/movie_crew_info_partition/';\n","user":"sysadmin","dateUpdated":"2020-05-22T17:57:17+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dc_comics_acid.page_id":"string","dc_comics_acid.name":"string","dc_comics_acid.urlslug":"string","dc_comics_acid.id":"string","dc_comics_acid.align":"string","dc_comics_acid.eye":"string","dc_comics_acid.hair":"string","dc_comics_acid.sex":"string","dc_comics_acid.gsm":"string","dc_comics_acid.alive":"string","dc_comics_acid.appearances":"string","dc_comics_acid.first_appearances":"string","dc_comics_acid.year":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582556_-611284504","id":"20181018-112106_390244690","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19938"},{"title":"11 - Load the partitioned table","text":"%jdbc(hive_interactive)\n\nINSERT INTO TABLE movie_crew_info_partition\nPARTITION(birthYear)\nSELECT nconst,primaryName,deathYear,primaryProfession,knownForTitles,birthyear\nFROM movie_crew_info_stage;\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"2":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dc_comics_acid.page_id":"string","dc_comics_acid.name":"string","dc_comics_acid.urlslug":"string","dc_comics_acid.id":"string","dc_comics_acid.align":"string","dc_comics_acid.eye":"string","dc_comics_acid.hair":"string","dc_comics_acid.sex":"string","dc_comics_acid.gsm":"string","dc_comics_acid.alive":"string","dc_comics_acid.appearances":"string","dc_comics_acid.first_appearances":"string","dc_comics_acid.year":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582556_22606566","id":"20181126-131556_320618379","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19939"},{"title":"12 - Execute a query on the table on a specific birth year limit 5","text":"%jdbc(hive_interactive)\nSELECT * FROM movie_crew_info_partition WHERE birthYear=\"1989\" LIMIT 5;","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movie_crew_info_partition.nconst":"string","movie_crew_info_partition.primaryname":"string","movie_crew_info_partition.deathyear":"string","movie_crew_info_partition.primaryprofession":"string","movie_crew_info_partition.knownfortitles":"string","movie_crew_info_partition.birthyear":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582556_1168197645","id":"20181018-125344_1620499029","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19940"},{"title":"13 - List the partitions for the partitioned table","text":"%jdbc(hive_interactive)\nSHOW PARTITIONS movie_crew_info_partition;","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"partition":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582556_1463085829","id":"20190606-101406_23714212","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19941"},{"title":"14 - Use HDFS to list /warehouse/tablespace/external/hive/movie_crew_info_partition/","text":"%sh\nhdfs dfs -ls /warehouse/tablespace/external/hive/movie_crew_info_partition/\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582557_1208622315","id":"20200521-063716_883148448","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19942"},{"title":"15 - Execute a query on the partitioned movie title table. Find the  title of all the  movies that are non-adult, Short genre and have a runtime over 60 minutes.","text":"%jdbc(hive_interactive)\nSELECT upper(primarytitle) FROM movie_title_partition WHERE runtimeminutes>60 AND array_contains(genres, 'Short')","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"_c0":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[],"groups":[],"values":[]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582557_1402857658","id":"20181018-125022_873188625","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19943"},{"title":"16 - Delete all of the movie titles that have a start year of 1959? ( What happens?) Try to solve. Hint: Hive ACID","text":"%jdbc(hive_interactive)\n--The table must be stored as orc and transactional to do delete\nCREATE TABLE movie_crew stored AS orc AS SELECT * FROM movie_crew_info_partition;\n\nALTER TABLE movie_crew SET TBLPROPERTIES ('transactional'='true'); \n\nDELETE FROM movie_crew WHERE birthYear=1959;\n\nSELECT * FROM movie_crew WHERE birthYear=1959;","user":"sysadmin","dateUpdated":"2020-05-22T17:57:35+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movie_crew_orc.nconst":"string","movie_crew_orc.primaryname":"string","movie_crew_orc.deathyear":"string","movie_crew_orc.primaryprofession":"string","movie_crew_orc.knownfortitles":"string","movie_crew_orc.birthyear":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"3":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movie_crew.nconst":"string","movie_crew.primaryname":"string","movie_crew.deathyear":"string","movie_crew.primaryprofession":"string","movie_crew.knownfortitles":"string","movie_crew.birthyear":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582557_714890727","id":"20181204-020000_90813177","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19944"},{"title":"17 -  Whats the total runtime minutes of  short titles in 2001?","text":"%jdbc(hive_interactive)\nSELECT sum(runtimeminutes) FROM movie_title_partition WHERE array_contains(genres, 'Short')","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"_c0":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582557_-1192928540","id":"20181204-065751_120028448","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19945"},{"text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Apache Spark Tutorials](http://hortonworks.com/tutorials/#tuts-developers) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community Connection (HCC)](https://community.hortonworks.com/spaces/85/data-science.html?type=question) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Cloudera Apache Spark Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html) - official Spark documentation.\n4. [Cloudera Apache Zeppelin Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html) - official Zeppelin documentation.\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>We hope you've enjoyed this lab. Below are additional resources that you should find useful:</p>\n<ol>\n<li><a href=\"http://hortonworks.com/tutorials/#tuts-developers\">Cloudera Apache Spark Tutorials</a> are your natural next step where you can explore Spark in more depth.</li>\n<li><a href=\"https://community.hortonworks.com/spaces/85/data-science.html?type=question\">Cloudera Community Connection (HCC)</a> is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html\">Cloudera Apache Spark Docs</a> - official Spark documentation.</li>\n<li><a href=\"https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html\">Cloudera Apache Zeppelin Docs</a> - official Zeppelin documentation.</li>\n</ol>\n"}]},"apps":[],"jobName":"paragraph_1590103582557_1866820317","id":"20181126-133017_244739700","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19946"},{"text":"%angular\n","user":"sysadmin","dateUpdated":"2020-05-21T23:26:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1590103582557_-869819416","id":"20191112-221026_523320455","dateCreated":"2020-05-21T23:26:22+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19947"}],"name":"Hive/04-Partitions","id":"2FAV8JTHJ","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}