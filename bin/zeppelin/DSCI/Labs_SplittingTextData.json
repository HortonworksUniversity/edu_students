{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:**\n**File locations:**\n**Successful outcome:**\n**Before you begin:**\n**Related lessons:**\n\n---","user":"admin","dateUpdated":"2019-11-28T11:16:33+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125776_-655890435","id":"20171105-200834_1116095891","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T11:16:33+0000","dateFinished":"2019-11-28T11:16:33+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:46726"},{"text":"%md\n# Setup\n---","user":"admin","dateUpdated":"2019-11-28T12:39:02+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125777_-656275184","id":"20181114-164229_902436001","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T12:39:02+0000","dateFinished":"2019-11-28T12:39:02+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46727"},{"title":"Read the data from S3 and store it in HDFS","text":"%sh\nrm -f DEV-343_labs.tgz\nwget -nv https://hwu-training-public-repo.s3-us-west-2.amazonaws.com/TOPS/ILT/NG-1.0/DEV/DEV-343/DEV-343_labs.tgz\ntar -xvf DEV-343_labs.tgz\nhdfs dfs -rm -r -f data\nhdfs dfs -put data/ .","user":"admin","dateUpdated":"2019-11-28T12:39:34+0000","config":{"tableHide":false,"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125777_-656275184","id":"20181114-164621_138379904","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T12:39:34+0000","dateFinished":"2019-11-28T12:40:39+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46728"},{"text":"%md\n# Lab\n---","user":"admin","dateUpdated":"2019-11-28T12:41:07+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125777_-656275184","id":"20181114-164844_1661453681","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T12:41:07+0000","dateFinished":"2019-11-28T12:41:07+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46729"},{"text":"%md\nWe provide a data file (spark-labs/data/wiki-pageviews.txt) that contains a dump of pageview data for many projects under the Wikimedia umbrella.\nThe data file has lines containing four fields. \n1. Domain.project (e.g. \"en.b\")\n2. Page name (e.g. \"AP_Biology/Evolution\") \n3. Page view count (e.g. 1)\n4. Total response size in bytes (e.g. 10662 - but for this particular dump, value is always 0).\n\nThe data is in simple text format, so when we read it in, we get a dataframe with a single column - a string containing all the data in each row. This is cumbersome to work with. In this lab, we'll apply a better schema to this data.","user":"admin","dateUpdated":"2019-11-28T12:41:15+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125777_-656275184","id":"20181115-084123_1911813743","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T12:41:15+0000","dateFinished":"2019-11-28T12:41:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46730"},{"title":"1 - Read the data","text":"","user":"admin","dateUpdated":"2019-11-28T12:41:20+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125777_-656275184","id":"20171105-200623_656362182","dateCreated":"2019-11-27T15:38:45+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46731"},{"text":"%md\nCreate a dataframe by splitting each line up.\n* Use split() to split on a whitespace (pattern of \"\\\\s+\" )\n* To rename a column, use as(newName)","user":"admin","dateUpdated":"2019-11-28T12:41:22+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125778_-655120937","id":"20171105-201923_413365117","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T12:41:22+0000","dateFinished":"2019-11-28T12:41:22+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46732"},{"title":"2 - Create a splitViewsDF DataFrame ","text":"","user":"admin","dateUpdated":"2019-11-28T12:41:24+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125778_-655120937","id":"20171105-201709_849284875","dateCreated":"2019-11-27T15:38:45+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46733"},{"text":"%md\nUse a select to create a dataframe with the schema above.\n* You can select the nth element of a row containing an array via syntax like this: splitLine(n)\n* You can cast an element using cast(dataType)Providing data type to convert to, e.g. \"integer\", \"long\", \"boolean\", etc.\n* You can name a selected column using as(newName)\n\nOnce you've created the dataframe, then:\n* View the schema.\n* View a few rows of the data.\n* Your data should look something like the below.\n\n```\n+------+---------+---------+----+\n|domain| pageName|viewCount|size|\n+------+---------+---------+----+\n|    aa|Main_Page|        3|   0|\n|    aa|Main_page|        1|   0|\n|    aa|User:Sav |        1|   0|\n|    aa|Wikipedia|        1|   0|\n|  aa.b|User:Savh|        1|   0|\n+------+---------+---------+----+\n```","user":"admin","dateUpdated":"2019-11-28T12:41:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125778_-655120937","id":"20171105-201449_1118165660","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T12:41:27+0000","dateFinished":"2019-11-28T12:41:27+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46734"},{"title":"3 - Create a better schema","text":"","user":"admin","dateUpdated":"2019-11-28T12:41:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":true},"editorMode":"ace/mode/scala","title":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574935313894_-914605394","id":"20191128-100153_62082661","dateCreated":"2019-11-28T10:01:53+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46735"},{"title":"4 - Find rows where the viewCount > 500, and display 5 of them","text":"","user":"admin","dateUpdated":"2019-11-28T12:41:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574938282049_-1244271213","id":"20191128-105122_1458696522","dateCreated":"2019-11-28T10:51:22+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46736"},{"title":"5 - Find the 5 rows with the largest viewCount and a domain of \"en\"","text":"","user":"admin","dateUpdated":"2019-11-28T12:41:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574938314678_2115032731","id":"20191128-105154_867299313","dateCreated":"2019-11-28T10:51:54+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46737"},{"title":"6 - Find the 5 rows with the largest viewCount and a domain of \"en\", and where the pageName doesn't contain a colon (\":\")","text":"","user":"admin","dateUpdated":"2019-11-28T12:41:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574938360819_1009461962","id":"20191128-105240_1571138484","dateCreated":"2019-11-28T10:52:40+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46738"},{"text":"%md\n# Result\n**You have now:** seen that text data can require a little more work than data like JSON with a pre-existing structure. Once you’ve restructured it with a clear schema, which is not usually difficult, then the full power of DataFrames can be easily applied.\n\n---","user":"admin","dateUpdated":"2019-11-28T12:41:40+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125778_-655120937","id":"20181119-142716_792318228","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T12:41:40+0000","dateFinished":"2019-11-28T12:41:40+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46739"},{"text":"%md\n# Solution\n---","user":"admin","dateUpdated":"2019-11-28T12:41:42+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125778_-655120937","id":"20171113-155535_1769142099","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T12:41:42+0000","dateFinished":"2019-11-28T12:41:42+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46740"},{"title":"1 - Read the data","text":"val viewsDF=spark.read.text(\"data/wiki-pageviews.txt\")\nz.show(viewsDF)","user":"admin","dateUpdated":"2019-11-28T12:41:55+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125778_-655120937","id":"20181115-084422_413255504","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T12:41:55+0000","dateFinished":"2019-11-28T12:42:00+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46741"},{"title":"2 - Create a splitViewsDF DataFrame ","text":"val splitViewsDF = viewsDF.select(split('value, \"\\\\s+\").as(\"splitLine\"))\nz.show(splitViewsDF)","user":"admin","dateUpdated":"2019-11-28T12:42:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125778_-655120937","id":"20181115-092436_561920580","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T12:42:08+0000","dateFinished":"2019-11-28T12:42:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46742"},{"title":"3 - Create a better schema","text":"val viewsWithSchemaDF = splitViewsDF.select('splitLine(0).as(\"domain\"), 'splitLine(1).as(\"pageName\"), 'splitLine(2).cast(\"integer\").as(\"viewCount\"), 'splitLine(3).cast(\"long\").as(\"size\"))\nz.show(viewsWithSchemaDF)","user":"admin","dateUpdated":"2019-11-28T12:42:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574870032714_-1552473032","id":"20191127-155352_747968443","dateCreated":"2019-11-27T15:53:52+0000","dateStarted":"2019-11-28T12:42:17+0000","dateFinished":"2019-11-28T12:42:18+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46743"},{"title":"4 - Find rows where the viewCount > 500, and display 5 of them","text":"z.show(viewsWithSchemaDF.filter('viewCount>500))","user":"admin","dateUpdated":"2019-11-28T12:42:25+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574870207222_-1670177192","id":"20191127-155647_1467107985","dateCreated":"2019-11-27T15:56:47+0000","dateStarted":"2019-11-28T12:42:25+0000","dateFinished":"2019-11-28T12:42:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46744"},{"title":"5 - Find the 5 rows with the largest viewCount and a domain of \"en\"","text":"z.show(viewsWithSchemaDF.filter('domain===\"en\").filter('viewCount>500))","user":"admin","dateUpdated":"2019-11-28T12:42:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574934983011_1273585839","id":"20191128-095623_677026395","dateCreated":"2019-11-28T09:56:23+0000","dateStarted":"2019-11-28T12:42:39+0000","dateFinished":"2019-11-28T12:42:50+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46745"},{"title":"6 - Find the 5 rows with the largest viewCount and a domain of \"en\", and where the pageName doesn't contain a colon (\":\")","text":"z.show(viewsWithSchemaDF.filter('domain===\"en\").filter(!'pageName.contains(\":\")).orderBy('viewcount.desc))","user":"admin","dateUpdated":"2019-11-28T12:43:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574935076340_-809305144","id":"20191128-095756_1460096983","dateCreated":"2019-11-28T09:57:56+0000","dateStarted":"2019-11-28T12:43:01+0000","dateFinished":"2019-11-28T12:43:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46746"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Hortonworks Apache Spark Tutorials](http://hortonworks.com/tutorials/#tuts-developers) are your natural next step where you can explore Spark in more depth.\n2. [Hortonworks Community Connection (HCC)](https://community.hortonworks.com/spaces/85/data-science.html?type=question) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Hortonworks Apache Spark Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html) - official Spark documentation.\n4. [Hortonworks Apache Zeppelin Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html) - official Zeppelin documentation.","user":"admin","dateUpdated":"2019-11-28T12:43:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125778_-655120937","id":"20181116-135131_93712280","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T12:43:25+0000","dateFinished":"2019-11-28T12:43:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46747"},{"text":"%angular\n</br>\n<center>\n<a href=\"https://learn.hortonworks.com/\">\n  <img src=\"https://everpath-course-content.s3-accelerate.amazonaws.com/instructor%2Ftbroas_hortonworks_c_bsns5k%2Fpublic%2Flogo-training-1.1494860458677.png\" alt=\"Hortonworks University\" style=\"width:125px;height:125px;border:0;\" align=\"middle\">\n</a>\n</center>","user":"admin","dateUpdated":"2019-11-28T12:43:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869125779_-655505686","id":"20181115-083751_61749794","dateCreated":"2019-11-27T15:38:45+0000","dateStarted":"2019-11-28T12:43:27+0000","dateFinished":"2019-11-28T12:43:27+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46748"},{"text":"%angular\n","user":"admin","dateUpdated":"2019-11-28T12:43:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":true},"editorMode":"ace/mode/undefined"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574945006962_-1581442433","id":"20191128-124326_1986311983","dateCreated":"2019-11-28T12:43:26+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:46749"}],"name":"Labs/SplittingTextData","id":"2ESZV2BP3","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
