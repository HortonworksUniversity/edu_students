{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:** Use the Spark SQL query to analyze data\n**File locations:**\n**Successful outcome:**\n**Before you begin:**\n**Related lessons:** Querying Tables and Views with SQL\n\n---","user":"anonymous","dateUpdated":"2020-01-13T00:00:39-0800","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578888531863_1031611377","id":"20171105-200834_1116095891","dateCreated":"2020-01-12T20:08:51-0800","dateStarted":"2020-01-12T23:35:26-0800","dateFinished":"2020-01-12T23:35:26-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3517"},{"text":"%md\n# Setup\n---","user":"anonymous","dateUpdated":"2020-01-12T23:30:43-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578888531865_1880768400","id":"20181114-164229_902436001","dateCreated":"2020-01-12T20:08:51-0800","dateStarted":"2020-01-12T23:35:26-0800","dateFinished":"2020-01-12T23:35:26-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3518"},{"text":"%sql\n-- This ensures that the notebook runs without an error\nDROP TABLE IF EXISTS devsh.name_dev","user":"anonymous","dateUpdated":"2020-01-12T23:30:44-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578900253459_-2003291915","id":"20200112-232413_2145401888","dateCreated":"2020-01-12T23:24:13-0800","dateStarted":"2020-01-12T23:35:26-0800","dateFinished":"2020-01-12T23:35:26-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3519"},{"text":"%md\n# Lab\n---","user":"anonymous","dateUpdated":"2020-01-12T23:31:10-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578888531869_1881871457","id":"20181114-164844_1661453681","dateCreated":"2020-01-12T20:08:51-0800","dateStarted":"2020-01-12T23:35:26-0800","dateFinished":"2020-01-12T23:35:26-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3520"},{"text":"%md\n## Show Tables and Columns Using the Catalog API","user":"anonymous","dateUpdated":"2020-01-12T23:31:11-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578888531870_21629986","id":"20171105-200519_752831754","dateCreated":"2020-01-12T20:08:51-0800","dateStarted":"2020-01-12T23:35:27-0800","dateFinished":"2020-01-12T23:35:27-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3521"},{"title":"1 - View the list of current Hive tables and temporary views in the devsh database","text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:11-0800","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578890236982_-469086712","id":"20200112-203716_1732237260","dateCreated":"2020-01-12T20:37:16-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3522"},{"title":"2 - List the schema (column definitions) of the devsh.accounts table","text":"%pyspark\n\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:11-0800","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578888531881_1576178923","id":"20181115-084422_413255504","dateCreated":"2020-01-12T20:08:51-0800","dateStarted":"2020-01-12T20:28:11-0800","dateFinished":"2020-01-12T20:28:17-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3523"},{"text":"%md\n\n### Show Tables and Columns Using the Zeppelin Spark SQL interpreter\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:11-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578889941783_798564280","id":"20200112-203221_2008747188","dateCreated":"2020-01-12T20:32:21-0800","dateStarted":"2020-01-12T23:35:27-0800","dateFinished":"2020-01-12T23:35:27-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3524"},{"title":"3 - View the list of current Hive tables and temporary views in the devsh database","text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:11-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578888531872_-1299402781","id":"20171105-200623_656362182","dateCreated":"2020-01-12T20:08:51-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3525"},{"title":"4 - List the schema (column definitions) of the devsh.accounts table","text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:11-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578890663638_1446599107","id":"20200112-204423_1360432692","dateCreated":"2020-01-12T20:44:23-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3526"},{"title":"5 - Create a new DataFrame based on the devsh.accounts table, and confirm that its schema matches that of the column list above","text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:11-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578890838218_-804395179","id":"20200112-204718_1061081933","dateCreated":"2020-01-12T20:47:18-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3527"},{"text":"%md\n### Perform a SQL Query on a Table\n\nCreate a new DataFrame by performing a simple SQL query on the devsh.accounts table.\nConfirm that the schema and data is correct.","user":"anonymous","dateUpdated":"2020-01-12T23:31:11-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578891279055_-435622832","id":"20200112-205439_947084297","dateCreated":"2020-01-12T20:54:39-0800","dateStarted":"2020-01-12T23:35:27-0800","dateFinished":"2020-01-12T23:35:27-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3528"},{"title":"6 - Create a new DataFrame by performing a simple SQL query on the devsh.accounts table","text":"%sql\n\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:12-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578891275116_-1664036651","id":"20200112-205435_358095485","dateCreated":"2020-01-12T20:54:35-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3529"},{"text":"%md\n### Optional: \nPerform the equivalent query using the DataFrame API, and compare the schema and data in the results to those of the query above.","user":"anonymous","dateUpdated":"2020-01-12T23:31:12-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578891708876_-2134652753","id":"20200112-210148_1790844192","dateCreated":"2020-01-12T21:01:48-0800","dateStarted":"2020-01-12T23:35:27-0800","dateFinished":"2020-01-12T23:35:27-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3530"},{"title":"7 - Perform the equivalent query using the Dataframe API","text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:12-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578891857336_764896802","id":"20200112-210417_2141354770","dateCreated":"2020-01-12T21:04:17-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3531"},{"text":"%md\nCreate a DataFrame called accountDeviceDF based on the CSV files in /devsh_loudacre/accountdevice.\n(Be sure to use the headers and inferred schema to determine the column names and types.)","user":"anonymous","dateUpdated":"2020-01-12T23:31:12-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578892187958_-477296393","id":"20200112-210947_312291539","dateCreated":"2020-01-12T21:09:47-0800","dateStarted":"2020-01-12T23:35:27-0800","dateFinished":"2020-01-12T23:35:27-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3532"},{"title":"8 - Create a DataFrame called accountDeviceDF based on the CSV files in /devsh_loudacre/accountdevice","text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:12-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578892233531_-1777448840","id":"20200112-211033_340468246","dateCreated":"2020-01-12T21:10:33-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3533"},{"title":"9 - Create a temporary view on the accountDeviceDF DataFrame called account_dev","text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:12-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578892614822_1692814874","id":"20200112-211654_1282596860","dateCreated":"2020-01-12T21:16:54-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3534"},{"text":"%md\nConfirm the view was created correctly by listing the tables and views in the devsh database as you did earlier. \nNotice that the account_dev table type is TEMPORARY.","user":"anonymous","dateUpdated":"2020-01-12T23:31:12-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578892796546_-2122103589","id":"20200112-211956_435929874","dateCreated":"2020-01-12T21:19:56-0800","dateStarted":"2020-01-12T23:35:27-0800","dateFinished":"2020-01-12T23:35:27-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3535"},{"title":"10 - View the list of current Hive tables and temporary views in the devsh database","text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:12-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578892991662_853186061","id":"20200112-212311_1378685958","dateCreated":"2020-01-12T21:23:11-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3536"},{"text":"%md\nUsing a SQL query, create a new DataFrame based on the first five rows of the account_dev view, and display the results.","user":"anonymous","dateUpdated":"2020-01-12T23:31:12-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578893512665_-1345576774","id":"20200112-213152_498665976","dateCreated":"2020-01-12T21:31:52-0800","dateStarted":"2020-01-12T23:35:27-0800","dateFinished":"2020-01-12T23:35:27-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3537"},{"title":"11 - Select the 5 first rows of the account_dev view","text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:13-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578893556445_-1316859165","id":"20200112-213236_1791189546","dateCreated":"2020-01-12T21:32:36-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3538"},{"text":"%md\n### Use SQL to Join Two Tables","user":"anonymous","dateUpdated":"2020-01-12T23:31:13-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578893853523_1961103668","id":"20200112-213733_818399323","dateCreated":"2020-01-12T21:37:33-0800","dateStarted":"2020-01-12T23:35:27-0800","dateFinished":"2020-01-12T23:35:27-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3539"},{"title":"12 - Join the devsh.accounts table and account_dev view using the account ID, and display the results","text":"%sql\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:13-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578893950411_-384126699","id":"20200112-213910_204476410","dateCreated":"2020-01-12T21:39:10-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3540"},{"title":"13 - Save nameDevDF as a Hive table in the devsh called name_dev (with the file path as /devsh_loudacre/name_dev)","text":"%sql","user":"anonymous","dateUpdated":"2020-01-12T23:31:13-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578894359293_-1229714570","id":"20200112-214559_594008368","dateCreated":"2020-01-12T21:45:59-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3541"},{"title":"14 - Confirm that the table has been created","text":"%sql","user":"anonymous","dateUpdated":"2020-01-12T23:31:13-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578898723862_-829758014","id":"20200112-225843_1065373961","dateCreated":"2020-01-12T22:58:43-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3542"},{"text":"%md\n# Result\n**You have now:** used the Spark SQL API to analyze data\n\n---","user":"anonymous","dateUpdated":"2020-01-13T00:02:03-0800","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578888531878_-1001295135","id":"20181119-142716_792318228","dateCreated":"2020-01-12T20:08:51-0800","dateStarted":"2020-01-13T00:00:44-0800","dateFinished":"2020-01-13T00:00:44-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3543"},{"text":"%md\n# Solution\n---","user":"anonymous","dateUpdated":"2020-01-12T23:31:13-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578888531880_-547160256","id":"20171113-155535_1769142099","dateCreated":"2020-01-12T20:08:51-0800","dateStarted":"2020-01-12T23:35:27-0800","dateFinished":"2020-01-12T23:35:28-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3544"},{"title":"1 - View the list of current Hive tables and temporary views in the devsh database","text":"%pyspark\n\nfor table in spark.catalog.listTables(\"devsh\"): print table","user":"anonymous","dateUpdated":"2020-01-12T23:31:13-0800","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578888756107_-1352206024","id":"20200112-201236_1601512555","dateCreated":"2020-01-12T20:12:36-0800","dateStarted":"2020-01-12T23:35:28-0800","dateFinished":"2020-01-12T23:35:34-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3545"},{"title":"2 - List the schema (column definitions) of the devsh.accounts table","text":"%pyspark\n\nfor column in spark.catalog.listColumns(\"accounts\",\"devsh\"): print column","user":"anonymous","dateUpdated":"2020-01-12T23:31:23-0800","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578889839002_500228343","id":"20200112-203039_1578979357","dateCreated":"2020-01-12T20:30:39-0800","dateStarted":"2020-01-12T23:35:34-0800","dateFinished":"2020-01-12T23:35:34-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3546"},{"title":"3 - View the list of current Hive tables and temporary views in the devsh database","text":"%sql\nSHOW TABLES IN devsh\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:24-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"database":"string","tableName":"string","isTemporary":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578890346707_1999986920","id":"20200112-203906_584822368","dateCreated":"2020-01-12T20:39:06-0800","dateStarted":"2020-01-12T23:35:34-0800","dateFinished":"2020-01-12T23:35:34-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3547"},{"title":"4 - List the schema (column definitions) of the devsh.accounts table","text":"%sql\n\nDESCRIBE devsh.accounts","user":"anonymous","dateUpdated":"2020-01-12T23:31:24-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578890710955_365137152","id":"20200112-204510_1251015105","dateCreated":"2020-01-12T20:45:10-0800","dateStarted":"2020-01-12T23:35:34-0800","dateFinished":"2020-01-12T23:35:34-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3548"},{"title":"5 - Create a new DataFrame based on the devsh.accounts table, and confirm that its schema matches that of the column list above","text":"%pyspark\n\nspark.read.table(\"devsh.accounts\").printSchema()","user":"anonymous","dateUpdated":"2020-01-12T23:31:24-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578891107373_976330342","id":"20200112-205147_2086671957","dateCreated":"2020-01-12T20:51:47-0800","dateStarted":"2020-01-12T23:35:34-0800","dateFinished":"2020-01-12T23:35:34-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3549"},{"title":"6 - Create a new DataFrame by performing a simple SQL query on the devsh.accounts table","text":"%sql\n\nSELECT first_name,last_name FROM devsh.accounts","user":"anonymous","dateUpdated":"2020-01-12T23:31:25-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"first_name":"string","last_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578891481971_-1452578032","id":"20200112-205801_643314295","dateCreated":"2020-01-12T20:58:01-0800","dateStarted":"2020-01-12T23:35:34-0800","dateFinished":"2020-01-12T23:35:37-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3550"},{"title":"7 - Perform the equivalent query using the Dataframe API","text":"%pyspark\n\nz.show(spark.read.table(\"devsh.accounts\").select(\"first_name\",\"last_name\"))","user":"anonymous","dateUpdated":"2020-01-12T23:31:28-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"first_name":"string","last_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578891894954_-1628595902","id":"20200112-210454_1665482649","dateCreated":"2020-01-12T21:04:54-0800","dateStarted":"2020-01-12T23:35:37-0800","dateFinished":"2020-01-12T23:35:37-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3551"},{"title":"8 - Create a DataFrame called accountDeviceDF based on the CSV files in /devsh_loudacre/accountdevice","text":"%pyspark\n\naccountDeviceDF = spark.read.option(\"header\",\"true\").option(\"inferSchema\",\"true\").csv(\"/devsh_loudacre/accountdevice\")\nz.show(accountDeviceDF)\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:28-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","account_id":"string","device_id":"string","activation_date":"string","account_device_id":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578892377289_1176942001","id":"20200112-211257_1439730338","dateCreated":"2020-01-12T21:12:57-0800","dateStarted":"2020-01-12T23:35:37-0800","dateFinished":"2020-01-12T23:35:40-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3552"},{"title":"9 - Create a temporary view on the accountDeviceDF DataFrame called account_dev","text":"%pyspark\n\naccountDeviceDF.createOrReplaceTempView(\"account_dev\")","user":"anonymous","dateUpdated":"2020-01-12T23:31:32-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578892680367_1330526254","id":"20200112-211800_376074023","dateCreated":"2020-01-12T21:18:00-0800","dateStarted":"2020-01-12T23:35:40-0800","dateFinished":"2020-01-12T23:35:40-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3553"},{"title":"10 - View the list of current Hive tables and temporary views in the devsh database","text":"%sql\n\nSHOW TABLES IN devsh","user":"anonymous","dateUpdated":"2020-01-12T23:31:32-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"database":"string","tableName":"string","isTemporary":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578893170965_285577395","id":"20200112-212610_73972141","dateCreated":"2020-01-12T21:26:10-0800","dateStarted":"2020-01-12T23:35:41-0800","dateFinished":"2020-01-12T23:35:41-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3554"},{"title":"11 - Select the 5 first rows of the account_dev view","text":"%sql\n\nSELECT * FROM account_dev LIMIT 5","user":"anonymous","dateUpdated":"2020-01-12T23:31:33-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","account_id":"string","device_id":"string","activation_date":"string","account_device_id":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578893634683_871306309","id":"20200112-213354_2128079920","dateCreated":"2020-01-12T21:33:54-0800","dateStarted":"2020-01-12T23:35:41-0800","dateFinished":"2020-01-12T23:35:41-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3555"},{"title":"12 - Join the devsh.accounts table and account_dev view using the account ID, and display the results","text":"%sql\n\nSELECT acct_num, first_name, last_name, account_device_id FROM devsh.accounts JOIN account_dev ON acct_num = account_id LIMIT 20","user":"anonymous","dateUpdated":"2020-01-12T23:31:33-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"acct_num":"string","first_name":"string","last_name":"string","account_device_id":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578894002153_-1277703957","id":"20200112-214002_1164911142","dateCreated":"2020-01-12T21:40:02-0800","dateStarted":"2020-01-12T23:35:41-0800","dateFinished":"2020-01-12T23:35:42-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3556"},{"title":"13 - Save nameDevDF as a Hive table in the devsh called name_dev (with the file path as /devsh_loudacre/name_dev)","text":"%md\nThe query below should work but triggers a thrift error probably due to a configuration issue\n\n\n```sql\nCREATE TABLE IF NOT EXISTS devsh.name_dev LOCATION \"/devsh_loudacre/name_dev\" AS SELECT acct_num, first_name, last_name, account_device_id FROM devsh.accounts JOIN account_dev ON acct_num = account_id\n```\nThe following code will work in the pyspark shell though:\n\n```spark\nnameDevDF = spark.sql(\"SELECT acct_num, first_name, last_name, account_device_id FROM devsh.accounts JOIN account_dev ON acct_num = account_id\")\nnameDevDF.write.option(\"path\",\"/devsh_loudacre/name_dev\").saveAsTable(\"devsh.name_dev\")\n```\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:35-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","title":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578894672850_-1873357880","id":"20200112-215112_425692993","dateCreated":"2020-01-12T21:51:12-0800","dateStarted":"2020-01-12T23:35:42-0800","dateFinished":"2020-01-12T23:35:42-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3557"},{"title":"14 - Confirm that the table has been created","text":"%sql\n\nSHOW TABLES IN devsh","user":"anonymous","dateUpdated":"2020-01-12T23:31:35-0800","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"database":"string","tableName":"string","isTemporary":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578898876982_235430193","id":"20200112-230116_2083335178","dateCreated":"2020-01-12T23:01:16-0800","dateStarted":"2020-01-12T23:35:42-0800","dateFinished":"2020-01-12T23:35:42-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3558"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"anonymous","dateUpdated":"2020-01-12T23:31:35-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578888531885_867012276","id":"20181116-135131_93712280","dateCreated":"2020-01-12T20:08:51-0800","dateStarted":"2020-01-12T23:35:42-0800","dateFinished":"2020-01-12T23:35:42-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3559"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera University\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"anonymous","dateUpdated":"2020-01-12T23:31:35-0800","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578888531886_-179749990","id":"20200110-154537_1406191376","dateCreated":"2020-01-12T20:08:51-0800","dateStarted":"2020-01-12T23:35:43-0800","dateFinished":"2020-01-12T23:35:43-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3560"},{"text":"%angular\n","user":"anonymous","dateUpdated":"2020-01-12T23:31:37-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578888531887_-1011847236","id":"20200110-162013_302547143","dateCreated":"2020-01-12T20:08:51-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3561"}],"name":"Labs/Pyspark/QueryingTablesAndViewsWithSQL","id":"2EY16KG8N","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}