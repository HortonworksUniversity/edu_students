{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:** In this lab, we will work with the Dataset typed API which provides compile-time type safety.\n**File locations:**\n**Successful outcome:**\n**Before you begin:**\n**Related lessons:** Spark SQL, Dataframes and Datasets\n\n---","user":"admin","dateUpdated":"2019-11-28T12:52:13+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525350_900220249","id":"20171105-200834_1116095891","dateCreated":"2019-11-27T14:05:25+0000","dateStarted":"2019-11-28T12:52:43+0000","dateFinished":"2019-11-28T12:52:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23717"},{"text":"%md\n# Setup\n---","user":"admin","dateUpdated":"2019-11-28T12:50:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525350_900220249","id":"20181114-164229_902436001","dateCreated":"2019-11-27T14:05:25+0000","dateStarted":"2019-11-28T12:52:43+0000","dateFinished":"2019-11-28T12:52:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23718"},{"title":"Read the data from S3 and store it in HDFS","text":"%sh\nrm -f DEV-343_labs.tgz\nwget -nv https://hwu-training-public-repo.s3-us-west-2.amazonaws.com/TOPS/ILT/NG-1.0/DEV/DEV-343/DEV-343_labs.tgz\ntar -xvf DEV-343_labs.tgz\nhdfs dfs -rm -r -f data\nhdfs dfs -put data/ .","user":"admin","dateUpdated":"2019-11-28T12:44:52+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525351_899835500","id":"20181114-163151_254151007","dateCreated":"2019-11-27T14:05:25+0000","dateStarted":"2019-11-28T12:52:43+0000","dateFinished":"2019-11-28T12:53:22+0000","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23719"},{"text":"%md\n# Lab\n---","user":"admin","dateUpdated":"2019-11-28T12:50:38+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525351_899835500","id":"20181114-164844_1661453681","dateCreated":"2019-11-27T14:05:25+0000","dateStarted":"2019-11-28T12:52:44+0000","dateFinished":"2019-11-28T12:52:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23720"},{"text":"%md\nWe've provided a small and simple JSON data file (spark-labs/data/music.json) containing data about music items. \nWe'll use it to do our Dataset work in this lab. It has four pieces of data in it:\n* title : Title of the item.\n* artist : Artist who released the item.\n* price : Price of the item\n* category : The music category (e.g. Pop)","user":"admin","dateUpdated":"2019-11-28T12:47:05+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525352_897911755","id":"20181115-084123_1911813743","dateCreated":"2019-11-27T14:05:25+0000","dateStarted":"2019-11-28T12:52:44+0000","dateFinished":"2019-11-28T12:52:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23721"},{"title":"1 - Create a DataFrame by reading in the music data in data/music.json","text":"","user":"admin","dateUpdated":"2019-11-28T12:47:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525352_897911755","id":"20171105-200623_656362182","dateCreated":"2019-11-27T14:05:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23722"},{"title":"2 - View the schema of this DataFrame","text":"","user":"admin","dateUpdated":"2019-11-28T12:47:11+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525352_897911755","id":"20171105-201709_849284875","dateCreated":"2019-11-27T14:05:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23723"},{"title":"3 - Explore the DataFrame","text":"","user":"admin","dateUpdated":"2019-11-28T12:47:14+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525353_897527007","id":"20171105-201449_1118165660","dateCreated":"2019-11-27T14:05:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23724"},{"title":"4 - Define a MusicItem case class suitable for our music.json data","text":"","user":"admin","dateUpdated":"2019-11-28T12:47:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574864184933_-1276759071","id":"20191127-141624_303297063","dateCreated":"2019-11-27T14:16:24+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23725"},{"title":"5 - Create a typed Dataset from the musicDF dataframe using this class","text":"","user":"admin","dateUpdated":"2019-11-28T12:47:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574864406928_2059553528","id":"20191127-142006_48110326","dateCreated":"2019-11-27T14:20:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23726"},{"text":"%md\n## Compare: DataFrame vs. Dataset\nWe'll perform some operations on our DataFrame and Dataset representations, to get a feel of the difference.","user":"admin","dateUpdated":"2019-11-28T12:47:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574864575062_1467438651","id":"20191127-142255_1827160889","dateCreated":"2019-11-27T14:22:55+0000","dateStarted":"2019-11-28T12:52:44+0000","dateFinished":"2019-11-28T12:52:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23727"},{"title":"6 - Using musicDF get all the items in the \"Pop\" category","text":"\n","user":"admin","dateUpdated":"2019-11-28T12:47:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574864613848_-1852513636","id":"20191127-142333_1584572432","dateCreated":"2019-11-27T14:23:33+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23728"},{"title":"7 - Using musicDS get all the items in the \"Pop\" category","text":"","user":"admin","dateUpdated":"2019-11-28T12:47:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574864612388_1120456439","id":"20191127-142332_1048048158","dateCreated":"2019-11-27T14:23:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23729"},{"title":"8 - Using musicDF get the lowest priced item in each category","text":"","user":"admin","dateUpdated":"2019-11-28T12:47:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574866533737_1891403458","id":"20191127-145533_1200667039","dateCreated":"2019-11-27T14:55:33+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23730"},{"title":"9 - Using musicDF get the lowest priced item in each category","text":"","user":"admin","dateUpdated":"2019-11-28T12:47:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574866570397_1728331221","id":"20191127-145610_78256454","dateCreated":"2019-11-27T14:56:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23731"},{"title":"10 - Using musicDF create a discountedPrice column equal to 0.9 * price","text":"","user":"admin","dateUpdated":"2019-11-28T12:47:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574867004408_-308680529","id":"20191127-150324_1127013446","dateCreated":"2019-11-27T15:03:24+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23732"},{"title":"11 - Using musicDS create a discountedPrice column equal to 0.9 * price","text":"","user":"admin","dateUpdated":"2019-11-28T12:47:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574867080725_708084931","id":"20191127-150440_323293806","dateCreated":"2019-11-27T15:04:40+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23733"},{"text":"%md\nMake a mistake - watch how errors are caught.","user":"admin","dateUpdated":"2019-11-28T12:47:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574868335438_1145767192","id":"20191127-152535_2073012023","dateCreated":"2019-11-27T15:25:35+0000","dateStarted":"2019-11-28T12:52:45+0000","dateFinished":"2019-11-28T12:52:45+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23734"},{"title":"12 - Using musicDF try multiplying the price by a literal string","text":"","user":"admin","dateUpdated":"2019-11-28T12:47:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574868399907_-430305510","id":"20191127-152639_818152579","dateCreated":"2019-11-27T15:26:39+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23735"},{"text":"","user":"admin","dateUpdated":"2019-11-28T12:47:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574945273058_-2136282640","id":"20191128-124753_856043254","dateCreated":"2019-11-28T12:47:53+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23736"},{"title":"13 - Using musicDS try multiplying the price by a literal string","text":"","user":"admin","dateUpdated":"2019-11-28T12:47:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574868978439_-1790361700","id":"20191127-153618_1706535088","dateCreated":"2019-11-27T15:36:18+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23737"},{"text":"%md\n# Result\n**You have now:** practiced some fairly simple transformations with Datasets. We've also done the same thing with DataFrames to get a feel of the difference.\nDataFrames are a little easier to program to. However, as we saw, Datasets can catch errors earlier than DataFrames. This can be important when debugging and maintaining a large system.\n\n---","user":"admin","dateUpdated":"2019-11-28T12:48:01+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525353_897527007","id":"20181119-142716_792318228","dateCreated":"2019-11-27T14:05:25+0000","dateStarted":"2019-11-28T12:52:45+0000","dateFinished":"2019-11-28T12:52:45+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23738"},{"text":"%md\n# Solution\n---","user":"admin","dateUpdated":"2019-11-28T12:48:05+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525353_897527007","id":"20171113-155535_1769142099","dateCreated":"2019-11-27T14:05:25+0000","dateStarted":"2019-11-28T12:52:45+0000","dateFinished":"2019-11-28T12:52:45+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23739"},{"title":"1 - Create a DataFrame by reading in the music data in data/music.json","text":"val musicDF = spark.read.json(\"data/music.json\")","user":"admin","dateUpdated":"2019-11-28T12:51:49+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525353_897527007","id":"20181115-084422_413255504","dateCreated":"2019-11-27T14:05:25+0000","dateStarted":"2019-11-28T12:52:43+0000","dateFinished":"2019-11-28T12:52:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23740"},{"title":"2 - View the schema of this DataFrame","text":"musicDF.printSchema","user":"admin","dateUpdated":"2019-11-28T12:51:53+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525354_898681253","id":"20181115-092436_561920580","dateCreated":"2019-11-27T14:05:25+0000","dateStarted":"2019-11-28T12:52:43+0000","dateFinished":"2019-11-28T12:52:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23741"},{"title":"3 - Explore the DataFrame","text":"z.show(musicDF)","user":"admin","dateUpdated":"2019-11-28T12:51:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574864080080_-122248570","id":"20191127-141440_547735419","dateCreated":"2019-11-27T14:14:40+0000","dateStarted":"2019-11-28T12:52:44+0000","dateFinished":"2019-11-28T12:52:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23742"},{"title":"4 - Define a MusicItem case class suitable for our music.json data","text":"case class MusicItem (artist: String, category: String, price: Double, title: String)","user":"admin","dateUpdated":"2019-11-28T12:51:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574864212384_198783609","id":"20191127-141652_1799475151","dateCreated":"2019-11-27T14:16:52+0000","dateStarted":"2019-11-28T12:52:44+0000","dateFinished":"2019-11-28T12:52:45+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23743"},{"title":"5 - Create a typed Dataset from the musicDF dataframe using this class","text":"val musicDS = musicDF.as[MusicItem] ","user":"admin","dateUpdated":"2019-11-28T12:52:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574864455588_-2036270368","id":"20191127-142055_121032729","dateCreated":"2019-11-27T14:20:55+0000","dateStarted":"2019-11-28T12:52:45+0000","dateFinished":"2019-11-28T12:52:46+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23744"},{"title":"6 - Using musicDF get all the items in the \"Pop\" category","text":"z.show(musicDF.filter('category === \"Pop\"))","user":"admin","dateUpdated":"2019-11-28T12:48:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574864634974_-1651427879","id":"20191127-142354_1861609054","dateCreated":"2019-11-27T14:23:54+0000","dateStarted":"2019-11-28T12:52:45+0000","dateFinished":"2019-11-28T12:52:46+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23745"},{"title":"7 - Using musicDS get all the items in the \"Pop\" category","text":"z.show(musicDS.filter('category === \"Pop\"))","user":"admin","dateUpdated":"2019-11-28T12:48:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574864744152_576376046","id":"20191127-142544_1135186291","dateCreated":"2019-11-27T14:25:44+0000","dateStarted":"2019-11-28T12:52:46+0000","dateFinished":"2019-11-28T12:52:47+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23746"},{"title":"8 - Using musicDF get the lowest priced item in each category","text":"z.show(musicDF.groupBy('category).agg(min(\"price\")))","user":"admin","dateUpdated":"2019-11-28T12:48:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574866596452_648957315","id":"20191127-145636_158042902","dateCreated":"2019-11-27T14:56:36+0000","dateStarted":"2019-11-28T12:52:46+0000","dateFinished":"2019-11-28T12:52:49+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23747"},{"title":"9 - Using musicDS get the lowest priced item in each category","text":"z.show(musicDS.groupBy('category).agg(min(\"price\")))","user":"admin","dateUpdated":"2019-11-28T12:49:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574866607378_-1768035276","id":"20191127-145647_1173935006","dateCreated":"2019-11-27T14:56:47+0000","dateStarted":"2019-11-28T12:52:47+0000","dateFinished":"2019-11-28T12:52:50+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23748"},{"title":"10 - Using musicDF create a discountedPrice column equal to 0.9 * price","text":"val musicWithDiscountDF = musicDF.withColumn(\"discountedPrice\", 'price * lit(0.9))\nz.show(musicWithDiscountDF)","user":"admin","dateUpdated":"2019-11-28T12:50:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574867109785_-1553991770","id":"20191127-150509_1786332403","dateCreated":"2019-11-27T15:05:09+0000","dateStarted":"2019-11-28T12:52:49+0000","dateFinished":"2019-11-28T12:52:51+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23749"},{"title":"11 - Using musicDS create a discountedPrice column equal to 0.9 * price","text":"case class DiscountedMusicItem (artist: String, category: String, price: Double, title: String, discountedPrice: Double)\nval musicWithDiscountDS = musicDF.withColumn(\"discountedPrice\", 'price * lit(0.9)).as[DiscountedMusicItem]\nz.show(musicWithDiscountDS)","user":"admin","dateUpdated":"2019-11-27T15:24:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574867143086_83545521","id":"20191127-150543_1766860750","dateCreated":"2019-11-27T15:05:43+0000","dateStarted":"2019-11-28T12:52:51+0000","dateFinished":"2019-11-28T12:52:52+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23750"},{"title":"12 - Using musicDF try multiplying the price by a literal string","text":"val musicWithDiscountDF = musicDF.withColumn(\"discountedPrice\", 'price * lit(\"A\"))\nz.show(musicWithDiscountDF)","user":"admin","dateUpdated":"2019-11-27T15:28:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574868447482_1544118576","id":"20191127-152727_1309115787","dateCreated":"2019-11-27T15:27:27+0000","dateStarted":"2019-11-28T12:52:51+0000","dateFinished":"2019-11-28T12:52:53+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23751"},{"title":"13 - Using musicDS try multiplying the price by a literal string","text":"val musicWithDiscountDS = musicDF.withColumn(\"discountedPrice\", 'price * lit(\"A\")).as[DiscountedMusicItem]\nz.show(musicWithDiscountDS)","user":"admin","dateUpdated":"2019-11-27T15:37:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574869005710_-2018487149","id":"20191127-153645_1760345126","dateCreated":"2019-11-27T15:36:45+0000","dateStarted":"2019-11-28T12:52:52+0000","dateFinished":"2019-11-28T12:52:53+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23752"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Hortonworks Apache Spark Tutorials](http://hortonworks.com/tutorials/#tuts-developers) are your natural next step where you can explore Spark in more depth.\n2. [Hortonworks Community Connection (HCC)](https://community.hortonworks.com/spaces/85/data-science.html?type=question) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Hortonworks Apache Spark Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/spark-overview/content/analyzing_data_with_apache_spark.html) - official Spark documentation.\n4. [Hortonworks Apache Zeppelin Docs](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.1/zeppelin-overview/content/overview.html) - official Zeppelin documentation.","user":"admin","dateUpdated":"2019-11-27T14:05:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525354_898681253","id":"20181116-135131_93712280","dateCreated":"2019-11-27T14:05:25+0000","dateStarted":"2019-11-28T12:52:46+0000","dateFinished":"2019-11-28T12:52:46+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23753"},{"text":"%angular\n</br>\n<center>\n<a href=\"https://learn.hortonworks.com/\">\n  <img src=\"https://everpath-course-content.s3-accelerate.amazonaws.com/instructor%2Ftbroas_hortonworks_c_bsns5k%2Fpublic%2Flogo-training-1.1494860458677.png\" alt=\"Hortonworks University\" style=\"width:125px;height:125px;border:0;\" align=\"middle\">\n</a>\n</center>","user":"admin","dateUpdated":"2019-11-27T14:05:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574863525354_898681253","id":"20181115-083751_61749794","dateCreated":"2019-11-27T14:05:25+0000","dateStarted":"2019-11-28T12:52:43+0000","dateFinished":"2019-11-28T12:52:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:23754"}],"name":"Labs/TheDatasetTypedAPI","id":"2EVNDUG9E","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
