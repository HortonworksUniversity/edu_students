{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:** Explore data using Pair RDDs\n**File locations:** /devsh_loudacre/weblogs\n**Successful outcome:**\n**Before you begin:**\n**Related lessons:** Aggregating Data with Pair RDDs\n\n---","user":"anonymous","dateUpdated":"2020-01-17T02:13:46-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198918_361675696","id":"20171105-200834_1116095891","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:29-0800","dateFinished":"2020-01-17T02:15:29-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18292"},{"text":"%md\n# Setup\n---\n\nThe following cells ensure that this notebook can run from top to bottom without errors any number of times.","user":"anonymous","dateUpdated":"2020-01-17T02:13:46-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198920_1194470950","id":"20181114-164229_902436001","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:29-0800","dateFinished":"2020-01-17T02:15:29-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18293"},{"text":"%sh\n\nhdfs dfs -rm -r -f /devsh_loudacre/weblogs\nhdfs dfs -put /home/training/training_materials/devsh/data/weblogs /devsh_loudacre","user":"anonymous","dateUpdated":"2020-01-17T02:13:46-0800","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198921_1319142584","id":"20200117-005924_766635286","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:29-0800","dateFinished":"2020-01-17T02:15:44-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18294"},{"text":"%md\n# Lab\n---","user":"anonymous","dateUpdated":"2020-01-17T02:14:00-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198923_645485850","id":"20181114-164844_1661453681","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:44-0800","dateFinished":"2020-01-17T02:15:44-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18295"},{"text":"%md\n### Explore Web Log Files\n\nIn this section, you will create a pair RDD based on data in the weblogs data files, and use that RDD to explore the data.\n\n**Tip:** In this exercise, you will be reducing and joining large datasets, which can take a lot of time and may result in memory errors resulting from the limited resources available in the course exercise environment.\nTo avoid this problem, perform these exercises with a subset of the web log files by using a wildcard: textFile(\"/ devsh_loudacre/weblogs/*2.log\") includes only filenames ending with 2.log.\n\nUsing map-reduce logic, count the number of requests from each user.\na. Use map to create a pair RDD with the user ID as the key and the integer 1 as the value. (The user ID is the third field in each line.) \nYour data will look something like this:\n\n```spark\n(userid,1)\n(userid,1)\n(userid,1)\n...\n```\n\nb. Use reduceByKey to sum the values for each user ID.\nYour RDD data will be similar to this:\n```spark\n(userid,5)\n(userid,7)\n(userid,2)\n...\n```","user":"anonymous","dateUpdated":"2020-01-17T02:14:00-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198924_1111603539","id":"20200117-003727_1887180227","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:44-0800","dateFinished":"2020-01-17T02:15:44-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18296"},{"title":"1 - Count the number of requests from each user","text":"%spark\n\n","user":"anonymous","dateUpdated":"2020-01-17T02:14:00-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198925_-459541566","id":"20200117-005302_91523840","dateCreated":"2020-01-17T01:59:58-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18297"},{"text":"%md\nUse countByKey to determine how many users visited the site for each frequency.\nThat is, how many users visited once, twice, three times, and so on.\na. Use map to reverse the key and value, like this:\n\n```spark\n(5,userid)\n(7,userid)\n(2,userid)\n...\n```\n\nb. Use the countByKey action to return a map of frequency: user-count pairs.","user":"anonymous","dateUpdated":"2020-01-17T02:14:00-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198926_-2018357463","id":"20200117-010502_1114454940","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:44-0800","dateFinished":"2020-01-17T02:15:45-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18298"},{"title":"2 - Determine how many users visited the site for each frequency","text":"%spark\n\n","user":"anonymous","dateUpdated":"2020-01-17T02:14:01-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198927_-1568125447","id":"20200117-010805_1450618394","dateCreated":"2020-01-17T01:59:58-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18299"},{"text":"%md\nCreate an RDD where the user ID is the key, and the value is the list of all the IP addresses that user has connected from. (IP address is the first field in each request line.)\n**Hint:** Map to (userid,ipaddress) and then use groupByKey.\n```spark\n(userid,20.1.34.55)\n(userid,245.33.1.1)\n(userid,65.50.196.141)\n...\n```\n```spark\n(userid,[20.1.34.55, 74.125.239.98])\n(userid,[75.175.32.10, 245.33.1.1, 66.79.233.99])\n(userid,[65.50.196.141])\n...\n```","user":"anonymous","dateUpdated":"2020-01-17T02:14:01-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198929_-946284167","id":"20200117-011050_1975747792","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:45-0800","dateFinished":"2020-01-17T02:15:45-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18300"},{"title":"3 - Create an RDD where the user ID is the key, and the value is the list of all the IP addresses that user has connected from","text":"%spark\n\n","user":"anonymous","dateUpdated":"2020-01-17T02:14:01-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198930_-1261010137","id":"20200117-011347_475883542","dateCreated":"2020-01-17T01:59:58-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18301"},{"text":"%md\n### Join Web Log Data with Account Data\nReview the accounts data located in /user/hive/warehouse/devsh.db/ accounts, which contains the data in the Hive devsh.accounts table.\nThe first field in each line is the user ID, which corresponds to the user ID in the web server logs.\nThe other fields include account details such as creation date, first and last name, and so on.\n\nJoin the accounts data with the weblog data to produce a dataset keyed by user ID which contains the user account information and the number of website hits for that user.\n\na. Create an RDD, based on the accounts data, consisting of key/value-array pairs: (userid,[values...])\n```spark\n(9012,[9012,2008-11-24 10:04:08,\\N,Cheryl,West, 4905 Olive Street,...])\n(2312,[2312,2008-11-23 14:05:07,\\N,Elizabeth,Kerns, 4703 Eva Pearl Street,Richmond,CA,...])\n(1195,[1195,2008-11-02 17:12:12,2013-07-18 16:42:36,Melissa, Roman,3539 James Martin Circle,Oakland,CA,...])\n...\n```\nb. Join the pair RDD with the set of user-id/hit-count pairs calculated in the first step.\n```spark\n(9012,([9012,2008-11-24 10:04:08,\\N,Cheryl,West, 4905 Olive Street,San Francisco,CA,...],4))\n(2312,([2312,2008-11-23 14:05:07,\\N,Elizabeth,Kerns, 4703 Eva Pearl Street,Richmond,CA,...],8))\n(1195,([1195,2008-11-02 17:12:12,2013-07-18 16:42:36,Melissa, Roman,3539 James Martin Circle,Oakland,CA,...],1))\n```\nDisplay the user ID, hit count, and first name (4th value) and last name (5th value) for the first five elements. \nThe output should look similar to this (but your example data may be different):\n```spark\n9012 4 Cheryl West\n1123 8 Elizabeth Kerns\n1093 2 Melissa Roman\n...\n```","user":"anonymous","dateUpdated":"2020-01-17T02:14:01-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198931_-1979075224","id":"20200117-011743_666063642","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:45-0800","dateFinished":"2020-01-17T02:15:45-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18302"},{"title":"4 - Join the accounts data with the weblog data to produce a dataset keyed by user ID","text":"%spark\n\n","user":"anonymous","dateUpdated":"2020-01-17T02:14:01-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198933_-1211063478","id":"20200117-011855_1432753489","dateCreated":"2020-01-17T01:59:58-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18303"},{"text":"%md\n### Bonus Exercises\n\nIf you have more time, attempt the following extra bonus exercises:","user":"anonymous","dateUpdated":"2020-01-17T02:14:01-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198934_-406807279","id":"20200117-013230_460158553","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:45-0800","dateFinished":"2020-01-17T02:15:45-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18304"},{"title":"5 - Use keyBy to create an RDD of account data with the postal code (9th field in the CSV file) as the key","text":"%spark\n","user":"anonymous","dateUpdated":"2020-01-17T02:14:01-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198935_-1492556780","id":"20200117-013314_98050276","dateCreated":"2020-01-17T01:59:58-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18305"},{"text":"%md\nCreate a pair RDD with postal code as the key and a list of names (Last Name,First Name) in that postal code as the value.\n\n* **Hint:** First name and last name are the 4th and 5th fields respectively.\n* Optional: Try using the mapValues operation.","user":"anonymous","dateUpdated":"2020-01-17T02:14:01-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198937_302858308","id":"20200117-014601_570000018","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:45-0800","dateFinished":"2020-01-17T02:15:45-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18306"},{"title":"6 - Create a pair RDD with postal code as the key and a list of names (Last Name,First Name) in that postal code as the value","text":"%spark\n\n","user":"anonymous","dateUpdated":"2020-01-17T02:14:01-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198938_-1375877719","id":"20200117-014557_1061955362","dateCreated":"2020-01-17T01:59:58-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18307"},{"text":"%md\nSort the data by postal code, then for the first five postal codes, display the code and list the names in that postal zone. \nFor example:\n```spark\n--- 85003 \nJenkins,Thad \nRick,Edward \nLindsay,Ivy \n...\n--- 85004 \nMorris,Eric \nReiser,Hazel \nGregg,Alicia \nPreston,Elizabeth \n...\n```\n","user":"anonymous","dateUpdated":"2020-01-17T02:14:01-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198939_-1702580258","id":"20200117-014913_2008282954","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:45-0800","dateFinished":"2020-01-17T02:15:45-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18308"},{"title":"7 - Sort the data by postal code, then for the first five postal codes, display the code and list the names in that postal zone","text":"%spark\n","user":"anonymous","dateUpdated":"2020-01-17T02:14:01-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198941_1062627730","id":"20200117-014911_64851727","dateCreated":"2020-01-17T01:59:58-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18309"},{"text":"%md\n# Result\n**You have now:** explored the Loudacre web server log files, as well as the Loudacre user account data, using key-value pair RDDs.\n\n---","user":"anonymous","dateUpdated":"2020-01-17T02:14:01-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198942_-1657803323","id":"20181119-142716_792318228","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:45-0800","dateFinished":"2020-01-17T02:15:45-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18310"},{"text":"%md\n# Solution\n---","user":"anonymous","dateUpdated":"2020-01-17T02:14:02-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198943_812311547","id":"20171113-155535_1769142099","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:45-0800","dateFinished":"2020-01-17T02:15:45-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18311"},{"title":"1 - Count the number of requests from each user","text":"%spark\n\n// Create an RDD based on a subset of weblogs (those ending in digit 2)\nval logsRDD=sc.textFile(\"/devsh_loudacre/weblogs/*2.log\")\n\n// map each request (line) to a pair (userid, 1) then sum the hits\nval userReqsRDD = logsRDD.map(line => line.split(' ')).map(words => (words(2),1)).reduceByKey((v1,v2) => v1 + v2)","user":"anonymous","dateUpdated":"2020-01-17T02:14:02-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198945_1880291801","id":"20200117-005516_1434443054","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:45-0800","dateFinished":"2020-01-17T02:15:46-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18312"},{"title":"2 - Determine how many users visited the site for each frequency","text":"%spark\n\n// return a user count for each hit frequency\nval freqCountMap = userReqsRDD.map(pair => (pair._2,pair._1)).countByKey()","user":"anonymous","dateUpdated":"2020-01-17T02:14:02-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198946_1299699788","id":"20200117-010932_956520230","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:46-0800","dateFinished":"2020-01-17T02:15:55-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18313"},{"title":"3 - Create an RDD where the user ID is the key, and the value is the list of all the IP addresses that user has connected from","text":"%spark\n\n// Group IPs by user ID\nval userIPs = logsRDD.map(line => line.split(' ')).map(words => (words(2),words(0))).groupByKey()\n\n// print out the first 10 user ids, and their IP list\nfor (pair <- userIPs.take(10)) {\n   println(pair._1 + \":\")\n   for (ip <- pair._2) println(\"\\t\"+ip)\n}","user":"anonymous","dateUpdated":"2020-01-17T02:14:04-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198948_-1813145763","id":"20200117-011549_208751082","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:55-0800","dateFinished":"2020-01-17T02:15:56-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18314"},{"title":"4 - Join the accounts data with the weblog data to produce a dataset keyed by user ID","text":"%spark\n\n// map account data to (userid,[values....])\nval accountsData=\"/user/hive/warehouse/devsh.db/accounts\"\nval accountsRDD = sc.textFile(accountsData).map(line => line.split(',')).map(account => (account(0),account))\n   \n// Join account data with userReqsRDD then merge hit count into valuelist   \nval accountHitsRDD = accountsRDD.join(userReqsRDD)\n\n// Display userid, hit count, first name, last name for the first few elements\nfor (pair <- accountHitsRDD.take(5)) {\n   printf(\"%s %s %s %s\\n\",pair._1,pair._2._2, pair._2._1(3),pair._2._1(4))\n}","user":"anonymous","dateUpdated":"2020-01-17T02:14:05-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198949_1676375143","id":"20200117-013059_733352759","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:57-0800","dateFinished":"2020-01-17T02:15:58-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18315"},{"title":"5 - Use keyBy to create an RDD of account data with the postal code (9th field in the CSV file) as the key","text":"%spark\n\nval accountsdata=\"/user/hive/warehouse/devsh.db/accounts\"\nval accountsByPCode = sc.textFile(accountsdata).map(_.split(',')).keyBy(_(8))","user":"anonymous","dateUpdated":"2020-01-17T02:14:06-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198951_1625494831","id":"20200117-013516_1552283233","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:58-0800","dateFinished":"2020-01-17T02:15:58-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18316"},{"title":"6 - Create a pair RDD with postal code as the key and a list of names (Last Name,First Name) in that postal code as the value","text":"%spark\n\nval namesByPCode = accountsByPCode.mapValues(values => values(4) + ',' + values(3)).groupByKey()","user":"anonymous","dateUpdated":"2020-01-17T02:14:07-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198952_-2123307535","id":"20200117-014659_1109568109","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:58-0800","dateFinished":"2020-01-17T02:15:58-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18317"},{"title":"7 - Sort the data by postal code, then for the first five postal codes, display the code and list the names in that postal zone","text":"%spark\n\nfor (pair <- namesByPCode.sortByKey().take(5)) {\n   println(\"---\" + pair._1)\n   pair._2.foreach(println)\n}","user":"anonymous","dateUpdated":"2020-01-17T02:14:07-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198954_952338321","id":"20200117-014943_557010225","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:15:58-0800","dateFinished":"2020-01-17T02:16:00-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18318"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"anonymous","dateUpdated":"2020-01-17T02:14:08-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198955_-927866972","id":"20181116-135131_93712280","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:16:00-0800","dateFinished":"2020-01-17T02:16:00-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18319"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera University\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"anonymous","dateUpdated":"2020-01-17T02:14:09-0800","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198957_372096634","id":"20200110-154537_1406191376","dateCreated":"2020-01-17T01:59:58-0800","dateStarted":"2020-01-17T02:16:00-0800","dateFinished":"2020-01-17T02:16:00-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18320"},{"text":"%angular\n","user":"anonymous","dateUpdated":"2020-01-17T02:14:09-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579255198959_926404504","id":"20200110-162013_302547143","dateCreated":"2020-01-17T01:59:58-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:18321"}],"name":"Labs/Scala/JoiningDataUsingPairRDDs","id":"2EYW5BZGS","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}